/*!
 * jQuery JavaScript Library v2.2.3
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2016-04-05T19:26Z
 */
!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,(function(e,t){var i=[],n=e.document,s=i.slice,o=i.concat,a=i.push,r=i.indexOf,l={},c=l.toString,d=l.hasOwnProperty,h={},u="2.2.3",p=function(e,t){return new p.fn.init(e,t)},g=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,f=/^-ms-/,m=/-([\da-z])/gi,v=function(e,t){return t.toUpperCase()};function b(e){var t=!!e&&"length"in e&&e.length,i=p.type(e);return"function"!==i&&!p.isWindow(e)&&("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}p.fn=p.prototype={jquery:u,constructor:p,selector:"",length:0,toArray:function(){return s.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:s.call(this)},pushStack:function(e){var t=p.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return p.each(this,e)},map:function(e){return this.pushStack(p.map(this,(function(t,i){return e.call(t,i,t)})))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:i.sort,splice:i.splice},p.extend=p.fn.extend=function(){var e,t,i,n,s,o,a=arguments[0]||{},r=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[r]||{},r++),"object"==typeof a||p.isFunction(a)||(a={}),r===l&&(a=this,r--);r<l;r++)if(null!=(e=arguments[r]))for(t in e)i=a[t],a!==(n=e[t])&&(c&&n&&(p.isPlainObject(n)||(s=p.isArray(n)))?(s?(s=!1,o=i&&p.isArray(i)?i:[]):o=i&&p.isPlainObject(i)?i:{},a[t]=p.extend(c,o,n)):void 0!==n&&(a[t]=n));return a},p.extend({expando:"jQuery"+(u+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===p.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=e&&e.toString();return!p.isArray(e)&&t-parseFloat(t)+1>=0},isPlainObject:function(e){var t;if("object"!==p.type(e)||e.nodeType||p.isWindow(e))return!1;if(e.constructor&&!d.call(e,"constructor")&&!d.call(e.constructor.prototype||{},"isPrototypeOf"))return!1;for(t in e);return void 0===t||d.call(e,t)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e},globalEval:function(e){var t,i=eval;(e=p.trim(e))&&(1===e.indexOf("use strict")?((t=n.createElement("script")).text=e,n.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(f,"ms-").replace(m,v)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var i,n=0;if(b(e))for(i=e.length;n<i&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:function(e){return null==e?"":(e+"").replace(g,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(b(Object(e))?p.merge(i,"string"==typeof e?[e]:e):a.call(i,e)),i},inArray:function(e,t,i){return null==t?-1:r.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,s=e.length;n<i;n++)e[s++]=t[n];return e.length=s,e},grep:function(e,t,i){for(var n=[],s=0,o=e.length,a=!i;s<o;s++)!t(e[s],s)!==a&&n.push(e[s]);return n},map:function(e,t,i){var n,s,a=0,r=[];if(b(e))for(n=e.length;a<n;a++)null!=(s=t(e[a],a,i))&&r.push(s);else for(a in e)null!=(s=t(e[a],a,i))&&r.push(s);return o.apply([],r)},guid:1,proxy:function(e,t){var i,n,o;if("string"==typeof t&&(i=e[t],t=e,e=i),p.isFunction(e))return n=s.call(arguments,2),o=function(){return e.apply(t||this,n.concat(s.call(arguments)))},o.guid=e.guid=e.guid||p.guid++,o},now:Date.now,support:h}),"function"==typeof Symbol&&(p.fn[Symbol.iterator]=i[Symbol.iterator]),p.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){l["[object "+t+"]"]=t.toLowerCase()}));var y=
/*!
         * Sizzle CSS Selector Engine v2.2.1
         * http://sizzlejs.com/
         *
         * Copyright jQuery Foundation and other contributors
         * Released under the MIT license
         * http://jquery.org/license
         *
         * Date: 2015-10-17
         */
function(e){var t,i,n,s,o,a,r,l,c,d,h,u,p,g,f,m,v,b,y,S="sizzle"+1*new Date,w=e.document,E=0,T=0,_=oe(),P=oe(),I=oe(),F=function(e,t){return e===t&&(h=!0),0},C=1<<31,M={}.hasOwnProperty,k=[],x=k.pop,L=k.push,A=k.push,O=k.slice,D=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},W="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",B="\\[[\\x20\\t\\r\\n\\f]*("+R+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+R+"))|)"+N+"*\\]",H=":("+R+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",U=new RegExp(N+"+","g"),V=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),$=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),j=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),z=new RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*?)[\\x20\\t\\r\\n\\f]*\\]","g"),G=new RegExp(H),q=new RegExp("^"+R+"$"),Y={ID:new RegExp("^#("+R+")"),CLASS:new RegExp("^\\.("+R+")"),TAG:new RegExp("^("+R+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+W+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},X=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Q=/[+~]/,ee=/'|\\/g,te=new RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),ie=function(e,t,i){var n="0x"+t-65536;return n!=n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},ne=function(){u()};try{A.apply(k=O.call(w.childNodes),w.childNodes),k[w.childNodes.length].nodeType}catch(e){A={apply:k.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}function se(e,t,n,s){var o,r,c,d,h,g,v,b,E=t&&t.ownerDocument,T=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==T&&9!==T&&11!==T)return n;if(!s&&((t?t.ownerDocument||t:w)!==p&&u(t),t=t||p,f)){if(11!==T&&(g=J.exec(e)))if(o=g[1]){if(9===T){if(!(c=t.getElementById(o)))return n;if(c.id===o)return n.push(c),n}else if(E&&(c=E.getElementById(o))&&y(t,c)&&c.id===o)return n.push(c),n}else{if(g[2])return A.apply(n,t.getElementsByTagName(e)),n;if((o=g[3])&&i.getElementsByClassName&&t.getElementsByClassName)return A.apply(n,t.getElementsByClassName(o)),n}if(i.qsa&&!I[e+" "]&&(!m||!m.test(e))){if(1!==T)E=t,b=e;else if("object"!==t.nodeName.toLowerCase()){for((d=t.getAttribute("id"))?d=d.replace(ee,"\\$&"):t.setAttribute("id",d=S),r=(v=a(e)).length,h=q.test(d)?"#"+d:"[id='"+d+"']";r--;)v[r]=h+" "+fe(v[r]);b=v.join(","),E=Q.test(e)&&pe(t.parentNode)||t}if(b)try{return A.apply(n,E.querySelectorAll(b)),n}catch(e){}finally{d===S&&t.removeAttribute("id")}}}return l(e.replace(V,"$1"),t,n,s)}function oe(){var e=[];return function t(i,s){return e.push(i+" ")>n.cacheLength&&delete t[e.shift()],t[i+" "]=s}}function ae(e){return e[S]=!0,e}function re(e){var t=p.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e,t){for(var i=e.split("|"),s=i.length;s--;)n.attrHandle[i[s]]=t}function ce(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||C)-(~e.sourceIndex||C);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function de(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function he(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function ue(e){return ae((function(t){return t=+t,ae((function(i,n){for(var s,o=e([],i.length,t),a=o.length;a--;)i[s=o[a]]&&(i[s]=!(n[s]=i[s]))}))}))}function pe(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in i=se.support={},o=se.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},u=se.setDocument=function(e){var t,s,a=e?e.ownerDocument||e:w;return a!==p&&9===a.nodeType&&a.documentElement?(g=(p=a).documentElement,f=!o(p),(s=p.defaultView)&&s.top!==s&&(s.addEventListener?s.addEventListener("unload",ne,!1):s.attachEvent&&s.attachEvent("onunload",ne)),i.attributes=re((function(e){return e.className="i",!e.getAttribute("className")})),i.getElementsByTagName=re((function(e){return e.appendChild(p.createComment("")),!e.getElementsByTagName("*").length})),i.getElementsByClassName=Z.test(p.getElementsByClassName),i.getById=re((function(e){return g.appendChild(e).id=S,!p.getElementsByName||!p.getElementsByName(S).length})),i.getById?(n.find.ID=function(e,t){if(void 0!==t.getElementById&&f){var i=t.getElementById(e);return i?[i]:[]}},n.filter.ID=function(e){var t=e.replace(te,ie);return function(e){return e.getAttribute("id")===t}}):(delete n.find.ID,n.filter.ID=function(e){var t=e.replace(te,ie);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),n.find.TAG=i.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],s=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[s++];)1===i.nodeType&&n.push(i);return n}return o},n.find.CLASS=i.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&f)return t.getElementsByClassName(e)},v=[],m=[],(i.qsa=Z.test(p.querySelectorAll))&&(re((function(e){g.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+W+")"),e.querySelectorAll("[id~="+S+"-]").length||m.push("~="),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||m.push(".#.+[+~]")})),re((function(e){var t=p.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),e.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")}))),(i.matchesSelector=Z.test(b=g.matches||g.webkitMatchesSelector||g.mozMatchesSelector||g.oMatchesSelector||g.msMatchesSelector))&&re((function(e){i.disconnectedMatch=b.call(e,"div"),b.call(e,"[s!='']:x"),v.push("!=",H)})),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),t=Z.test(g.compareDocumentPosition),y=t||Z.test(g.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},F=t?function(e,t){if(e===t)return h=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!i.sortDetached&&t.compareDocumentPosition(e)===n?e===p||e.ownerDocument===w&&y(w,e)?-1:t===p||t.ownerDocument===w&&y(w,t)?1:d?D(d,e)-D(d,t):0:4&n?-1:1)}:function(e,t){if(e===t)return h=!0,0;var i,n=0,s=e.parentNode,o=t.parentNode,a=[e],r=[t];if(!s||!o)return e===p?-1:t===p?1:s?-1:o?1:d?D(d,e)-D(d,t):0;if(s===o)return ce(e,t);for(i=e;i=i.parentNode;)a.unshift(i);for(i=t;i=i.parentNode;)r.unshift(i);for(;a[n]===r[n];)n++;return n?ce(a[n],r[n]):a[n]===w?-1:r[n]===w?1:0},p):p},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&u(e),t=t.replace(z,"='$1']"),i.matchesSelector&&f&&!I[t+" "]&&(!v||!v.test(t))&&(!m||!m.test(t)))try{var n=b.call(e,t);if(n||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return se(t,p,null,[e]).length>0},se.contains=function(e,t){return(e.ownerDocument||e)!==p&&u(e),y(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!==p&&u(e);var s=n.attrHandle[t.toLowerCase()],o=s&&M.call(n.attrHandle,t.toLowerCase())?s(e,t,!f):void 0;return void 0!==o?o:i.attributes||!f?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],s=0,o=0;if(h=!i.detectDuplicates,d=!i.sortStable&&e.slice(0),e.sort(F),h){for(;t=e[o++];)t===e[o]&&(s=n.push(o));for(;s--;)e.splice(n[s],1)}return d=null,e},s=se.getText=function(e){var t,i="",n=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=s(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[n++];)i+=s(t);return i},n=se.selectors={cacheLength:50,createPseudo:ae,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ie),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ie),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&G.test(i)&&(t=a(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ie).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=_[e+" "];return t||(t=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"("+N+"|$)"))&&_(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,i){return function(n){var s=se.attr(n,e);return null==s?"!="===t:!t||(s+="","="===t?s===i:"!="===t?s!==i:"^="===t?i&&0===s.indexOf(i):"*="===t?i&&s.indexOf(i)>-1:"$="===t?i&&s.slice(-i.length)===i:"~="===t?(" "+s.replace(U," ")+" ").indexOf(i)>-1:"|="===t&&(s===i||s.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,i,n,s){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),r="of-type"===t;return 1===n&&0===s?function(e){return!!e.parentNode}:function(t,i,l){var c,d,h,u,p,g,f=o!==a?"nextSibling":"previousSibling",m=t.parentNode,v=r&&t.nodeName.toLowerCase(),b=!l&&!r,y=!1;if(m){if(o){for(;f;){for(u=t;u=u[f];)if(r?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;g=f="only"===e&&!g&&"nextSibling"}return!0}if(g=[a?m.firstChild:m.lastChild],a&&b){for(y=(p=(c=(d=(h=(u=m)[S]||(u[S]={}))[u.uniqueID]||(h[u.uniqueID]={}))[e]||[])[0]===E&&c[1])&&c[2],u=p&&m.childNodes[p];u=++p&&u&&u[f]||(y=p=0)||g.pop();)if(1===u.nodeType&&++y&&u===t){d[e]=[E,p,y];break}}else if(b&&(y=p=(c=(d=(h=(u=t)[S]||(u[S]={}))[u.uniqueID]||(h[u.uniqueID]={}))[e]||[])[0]===E&&c[1]),!1===y)for(;(u=++p&&u&&u[f]||(y=p=0)||g.pop())&&((r?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++y||(b&&((d=(h=u[S]||(u[S]={}))[u.uniqueID]||(h[u.uniqueID]={}))[e]=[E,y]),u!==t)););return(y-=s)===n||y%n==0&&y/n>=0}}},PSEUDO:function(e,t){var i,s=n.pseudos[e]||n.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return s[S]?s(t):s.length>1?(i=[e,e,"",t],n.setFilters.hasOwnProperty(e.toLowerCase())?ae((function(e,i){for(var n,o=s(e,t),a=o.length;a--;)e[n=D(e,o[a])]=!(i[n]=o[a])})):function(e){return s(e,0,i)}):s}},pseudos:{not:ae((function(e){var t=[],i=[],n=r(e.replace(V,"$1"));return n[S]?ae((function(e,t,i,s){for(var o,a=n(e,null,s,[]),r=e.length;r--;)(o=a[r])&&(e[r]=!(t[r]=o))})):function(e,s,o){return t[0]=e,n(t,null,o,i),t[0]=null,!i.pop()}})),has:ae((function(e){return function(t){return se(e,t).length>0}})),contains:ae((function(e){return e=e.replace(te,ie),function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}})),lang:ae((function(e){return q.test(e||"")||se.error("unsupported lang: "+e),e=e.replace(te,ie).toLowerCase(),function(t){var i;do{if(i=f?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(i=i.toLowerCase())===e||0===i.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===g},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!n.pseudos.empty(e)},header:function(e){return K.test(e.nodeName)},input:function(e){return X.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ue((function(){return[0]})),last:ue((function(e,t){return[t-1]})),eq:ue((function(e,t,i){return[i<0?i+t:i]})),even:ue((function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e})),odd:ue((function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e})),lt:ue((function(e,t,i){for(var n=i<0?i+t:i;--n>=0;)e.push(n);return e})),gt:ue((function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e}))}},n.pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[t]=de(t);for(t in{submit:!0,reset:!0})n.pseudos[t]=he(t);function ge(){}function fe(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function me(e,t,i){var n=t.dir,s=i&&"parentNode"===n,o=T++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||s)return e(t,i,o)}:function(t,i,a){var r,l,c,d=[E,o];if(a){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,i,a))return!0}else for(;t=t[n];)if(1===t.nodeType||s){if((r=(l=(c=t[S]||(t[S]={}))[t.uniqueID]||(c[t.uniqueID]={}))[n])&&r[0]===E&&r[1]===o)return d[2]=r[2];if(l[n]=d,d[2]=e(t,i,a))return!0}}}function ve(e){return e.length>1?function(t,i,n){for(var s=e.length;s--;)if(!e[s](t,i,n))return!1;return!0}:e[0]}function be(e,t,i,n,s){for(var o,a=[],r=0,l=e.length,c=null!=t;r<l;r++)(o=e[r])&&(i&&!i(o,n,s)||(a.push(o),c&&t.push(r)));return a}function ye(e,t,i,n,s,o){return n&&!n[S]&&(n=ye(n)),s&&!s[S]&&(s=ye(s,o)),ae((function(o,a,r,l){var c,d,h,u=[],p=[],g=a.length,f=o||function(e,t,i){for(var n=0,s=t.length;n<s;n++)se(e,t[n],i);return i}(t||"*",r.nodeType?[r]:r,[]),m=!e||!o&&t?f:be(f,u,e,r,l),v=i?s||(o?e:g||n)?[]:a:m;if(i&&i(m,v,r,l),n)for(c=be(v,p),n(c,[],r,l),d=c.length;d--;)(h=c[d])&&(v[p[d]]=!(m[p[d]]=h));if(o){if(s||e){if(s){for(c=[],d=v.length;d--;)(h=v[d])&&c.push(m[d]=h);s(null,v=[],c,l)}for(d=v.length;d--;)(h=v[d])&&(c=s?D(o,h):u[d])>-1&&(o[c]=!(a[c]=h))}}else v=be(v===a?v.splice(g,v.length):v),s?s(null,a,v,l):A.apply(a,v)}))}function Se(e){for(var t,i,s,o=e.length,a=n.relative[e[0].type],r=a||n.relative[" "],l=a?1:0,d=me((function(e){return e===t}),r,!0),h=me((function(e){return D(t,e)>-1}),r,!0),u=[function(e,i,n){var s=!a&&(n||i!==c)||((t=i).nodeType?d(e,i,n):h(e,i,n));return t=null,s}];l<o;l++)if(i=n.relative[e[l].type])u=[me(ve(u),i)];else{if((i=n.filter[e[l].type].apply(null,e[l].matches))[S]){for(s=++l;s<o&&!n.relative[e[s].type];s++);return ye(l>1&&ve(u),l>1&&fe(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(V,"$1"),i,l<s&&Se(e.slice(l,s)),s<o&&Se(e=e.slice(s)),s<o&&fe(e))}u.push(i)}return ve(u)}return ge.prototype=n.filters=n.pseudos,n.setFilters=new ge,a=se.tokenize=function(e,t){var i,s,o,a,r,l,c,d=P[e+" "];if(d)return t?0:d.slice(0);for(r=e,l=[],c=n.preFilter;r;){for(a in i&&!(s=$.exec(r))||(s&&(r=r.slice(s[0].length)||r),l.push(o=[])),i=!1,(s=j.exec(r))&&(i=s.shift(),o.push({value:i,type:s[0].replace(V," ")}),r=r.slice(i.length)),n.filter)!(s=Y[a].exec(r))||c[a]&&!(s=c[a](s))||(i=s.shift(),o.push({value:i,type:a,matches:s}),r=r.slice(i.length));if(!i)break}return t?r.length:r?se.error(e):P(e,l).slice(0)},r=se.compile=function(e,t){var i,s=[],o=[],r=I[e+" "];if(!r){for(t||(t=a(e)),i=t.length;i--;)(r=Se(t[i]))[S]?s.push(r):o.push(r);r=I(e,function(e,t){var i=t.length>0,s=e.length>0,o=function(o,a,r,l,d){var h,g,m,v=0,b="0",y=o&&[],S=[],w=c,T=o||s&&n.find.TAG("*",d),_=E+=null==w?1:Math.random()||.1,P=T.length;for(d&&(c=a===p||a||d);b!==P&&null!=(h=T[b]);b++){if(s&&h){for(g=0,a||h.ownerDocument===p||(u(h),r=!f);m=e[g++];)if(m(h,a||p,r)){l.push(h);break}d&&(E=_)}i&&((h=!m&&h)&&v--,o&&y.push(h))}if(v+=b,i&&b!==v){for(g=0;m=t[g++];)m(y,S,a,r);if(o){if(v>0)for(;b--;)y[b]||S[b]||(S[b]=x.call(l));S=be(S)}A.apply(l,S),d&&!o&&S.length>0&&v+t.length>1&&se.uniqueSort(l)}return d&&(E=_,c=w),y};return i?ae(o):o}(o,s)),r.selector=e}return r},l=se.select=function(e,t,s,o){var l,c,d,h,u,p="function"==typeof e&&e,g=!o&&a(e=p.selector||e);if(s=s||[],1===g.length){if((c=g[0]=g[0].slice(0)).length>2&&"ID"===(d=c[0]).type&&i.getById&&9===t.nodeType&&f&&n.relative[c[1].type]){if(!(t=(n.find.ID(d.matches[0].replace(te,ie),t)||[])[0]))return s;p&&(t=t.parentNode),e=e.slice(c.shift().value.length)}for(l=Y.needsContext.test(e)?0:c.length;l--&&(d=c[l],!n.relative[h=d.type]);)if((u=n.find[h])&&(o=u(d.matches[0].replace(te,ie),Q.test(c[0].type)&&pe(t.parentNode)||t))){if(c.splice(l,1),!(e=o.length&&fe(c)))return A.apply(s,o),s;break}}return(p||r(e,g))(o,t,!f,s,!t||Q.test(e)&&pe(t.parentNode)||t),s},i.sortStable=S.split("").sort(F).join("")===S,i.detectDuplicates=!!h,u(),i.sortDetached=re((function(e){return 1&e.compareDocumentPosition(p.createElement("div"))})),re((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||le("type|href|height|width",(function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),i.attributes&&re((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||le("value",(function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),re((function(e){return null==e.getAttribute("disabled")}))||le(W,(function(e,t,i){var n;if(!i)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null})),se}(e);p.find=y,p.expr=y.selectors,p.expr[":"]=p.expr.pseudos,p.uniqueSort=p.unique=y.uniqueSort,p.text=y.getText,p.isXMLDoc=y.isXML,p.contains=y.contains;var S=function(e,t,i){for(var n=[],s=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(s&&p(e).is(i))break;n.push(e)}return n},w=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},E=p.expr.match.needsContext,T=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,_=/^.[^:#\[\.,]*$/;function P(e,t,i){if(p.isFunction(t))return p.grep(e,(function(e,n){return!!t.call(e,n,e)!==i}));if(t.nodeType)return p.grep(e,(function(e){return e===t!==i}));if("string"==typeof t){if(_.test(t))return p.filter(t,e,i);t=p.filter(t,e)}return p.grep(e,(function(e){return r.call(t,e)>-1!==i}))}p.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?p.find.matchesSelector(n,e)?[n]:[]:p.find.matches(e,p.grep(t,(function(e){return 1===e.nodeType})))},p.fn.extend({find:function(e){var t,i=this.length,n=[],s=this;if("string"!=typeof e)return this.pushStack(p(e).filter((function(){for(t=0;t<i;t++)if(p.contains(s[t],this))return!0})));for(t=0;t<i;t++)p.find(e,s[t],n);return(n=this.pushStack(i>1?p.unique(n):n)).selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(P(this,e||[],!1))},not:function(e){return this.pushStack(P(this,e||[],!0))},is:function(e){return!!P(this,"string"==typeof e&&E.test(e)?p(e):e||[],!1).length}});var I,F=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(p.fn.init=function(e,t,i){var s,o;if(!e)return this;if(i=i||I,"string"==typeof e){if(!(s="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:F.exec(e))||!s[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(s[1]){if(t=t instanceof p?t[0]:t,p.merge(this,p.parseHTML(s[1],t&&t.nodeType?t.ownerDocument||t:n,!0)),T.test(s[1])&&p.isPlainObject(t))for(s in t)p.isFunction(this[s])?this[s](t[s]):this.attr(s,t[s]);return this}return(o=n.getElementById(s[2]))&&o.parentNode&&(this.length=1,this[0]=o),this.context=n,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):p.isFunction(e)?void 0!==i.ready?i.ready(e):e(p):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),p.makeArray(e,this))}).prototype=p.fn,I=p(n);var C=/^(?:parents|prev(?:Until|All))/,M={children:!0,contents:!0,next:!0,prev:!0};function k(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}p.fn.extend({has:function(e){var t=p(e,this),i=t.length;return this.filter((function(){for(var e=0;e<i;e++)if(p.contains(this,t[e]))return!0}))},closest:function(e,t){for(var i,n=0,s=this.length,o=[],a=E.test(e)||"string"!=typeof e?p(e,t||this.context):0;n<s;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&p.find.matchesSelector(i,e))){o.push(i);break}return this.pushStack(o.length>1?p.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?r.call(p(e),this[0]):r.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(p.uniqueSort(p.merge(this.get(),p(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),p.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return S(e,"parentNode")},parentsUntil:function(e,t,i){return S(e,"parentNode",i)},next:function(e){return k(e,"nextSibling")},prev:function(e){return k(e,"previousSibling")},nextAll:function(e){return S(e,"nextSibling")},prevAll:function(e){return S(e,"previousSibling")},nextUntil:function(e,t,i){return S(e,"nextSibling",i)},prevUntil:function(e,t,i){return S(e,"previousSibling",i)},siblings:function(e){return w((e.parentNode||{}).firstChild,e)},children:function(e){return w(e.firstChild)},contents:function(e){return e.contentDocument||p.merge([],e.childNodes)}},(function(e,t){p.fn[e]=function(i,n){var s=p.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=p.filter(n,s)),this.length>1&&(M[e]||p.uniqueSort(s),C.test(e)&&s.reverse()),this.pushStack(s)}}));var x,L=/\S+/g;function A(){n.removeEventListener("DOMContentLoaded",A),e.removeEventListener("load",A),p.ready()}p.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return p.each(e.match(L)||[],(function(e,i){t[i]=!0})),t}(e):p.extend({},e);var t,i,n,s,o=[],a=[],r=-1,l=function(){for(s=e.once,n=t=!0;a.length;r=-1)for(i=a.shift();++r<o.length;)!1===o[r].apply(i[0],i[1])&&e.stopOnFalse&&(r=o.length,i=!1);e.memory||(i=!1),t=!1,s&&(o=i?[]:"")},c={add:function(){return o&&(i&&!t&&(r=o.length-1,a.push(i)),function t(i){p.each(i,(function(i,n){p.isFunction(n)?e.unique&&c.has(n)||o.push(n):n&&n.length&&"string"!==p.type(n)&&t(n)}))}(arguments),i&&!t&&l()),this},remove:function(){return p.each(arguments,(function(e,t){for(var i;(i=p.inArray(t,o,i))>-1;)o.splice(i,1),i<=r&&r--})),this},has:function(e){return e?p.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return s=a=[],o=i="",this},disabled:function(){return!o},lock:function(){return s=a=[],i||(o=i=""),this},locked:function(){return!!s},fireWith:function(e,i){return s||(i=[e,(i=i||[]).slice?i.slice():i],a.push(i),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},p.extend({Deferred:function(e){var t=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var e=arguments;return p.Deferred((function(i){p.each(t,(function(t,o){var a=p.isFunction(e[t])&&e[t];s[o[1]]((function(){var e=a&&a.apply(this,arguments);e&&p.isFunction(e.promise)?e.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[o[0]+"With"](this===n?i.promise():this,a?[e]:arguments)}))})),e=null})).promise()},promise:function(e){return null!=e?p.extend(e,n):n}},s={};return n.pipe=n.then,p.each(t,(function(e,o){var a=o[2],r=o[3];n[o[1]]=a.add,r&&a.add((function(){i=r}),t[1^e][2].disable,t[2][2].lock),s[o[0]]=function(){return s[o[0]+"With"](this===s?n:this,arguments),this},s[o[0]+"With"]=a.fireWith})),n.promise(s),e&&e.call(s,s),s},when:function(e){var t,i,n,o=0,a=s.call(arguments),r=a.length,l=1!==r||e&&p.isFunction(e.promise)?r:0,c=1===l?e:p.Deferred(),d=function(e,i,n){return function(o){i[e]=this,n[e]=arguments.length>1?s.call(arguments):o,n===t?c.notifyWith(i,n):--l||c.resolveWith(i,n)}};if(r>1)for(t=new Array(r),i=new Array(r),n=new Array(r);o<r;o++)a[o]&&p.isFunction(a[o].promise)?a[o].promise().progress(d(o,i,t)).done(d(o,n,a)).fail(c.reject):--l;return l||c.resolveWith(n,a),c.promise()}}),p.fn.ready=function(e){return p.ready.promise().done(e),this},p.extend({isReady:!1,readyWait:1,holdReady:function(e){e?p.readyWait++:p.ready(!0)},ready:function(e){(!0===e?--p.readyWait:p.isReady)||(p.isReady=!0,!0!==e&&--p.readyWait>0||(x.resolveWith(n,[p]),p.fn.triggerHandler&&(p(n).triggerHandler("ready"),p(n).off("ready"))))}}),p.ready.promise=function(t){return x||(x=p.Deferred(),"complete"===n.readyState||"loading"!==n.readyState&&!n.documentElement.doScroll?e.setTimeout(p.ready):(n.addEventListener("DOMContentLoaded",A),e.addEventListener("load",A))),x.promise(t)},p.ready.promise();var O=function(e,t,i,n,s,o,a){var r=0,l=e.length,c=null==i;if("object"===p.type(i))for(r in s=!0,i)O(e,t,r,i[r],!0,o,a);else if(void 0!==n&&(s=!0,p.isFunction(n)||(a=!0),c&&(a?(t.call(e,n),t=null):(c=t,t=function(e,t,i){return c.call(p(e),i)})),t))for(;r<l;r++)t(e[r],i,a?n:n.call(e[r],r,t(e[r],i)));return s?e:c?t.call(e):l?t(e[0],i):o},D=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function W(){this.expando=p.expando+W.uid++}W.uid=1,W.prototype={register:function(e,t){var i=t||{};return e.nodeType?e[this.expando]=i:Object.defineProperty(e,this.expando,{value:i,writable:!0,configurable:!0}),e[this.expando]},cache:function(e){if(!D(e))return{};var t=e[this.expando];return t||(t={},D(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,i){var n,s=this.cache(e);if("string"==typeof t)s[t]=i;else for(n in t)s[n]=t[n];return s},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][t]},access:function(e,t,i){var n;return void 0===t||t&&"string"==typeof t&&void 0===i?void 0!==(n=this.get(e,t))?n:this.get(e,p.camelCase(t)):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n,s,o=e[this.expando];if(void 0!==o){if(void 0===t)this.register(e);else{p.isArray(t)?n=t.concat(t.map(p.camelCase)):(s=p.camelCase(t),n=t in o?[t,s]:(n=s)in o?[n]:n.match(L)||[]),i=n.length;for(;i--;)delete o[n[i]]}(void 0===t||p.isEmptyObject(o))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!p.isEmptyObject(t)}};var N=new W,R=new W,B=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,H=/[A-Z]/g;function U(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(H,"-$&").toLowerCase(),"string"==typeof(i=e.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:B.test(i)?p.parseJSON(i):i)}catch(e){}R.set(e,t,i)}else i=void 0;return i}p.extend({hasData:function(e){return R.hasData(e)||N.hasData(e)},data:function(e,t,i){return R.access(e,t,i)},removeData:function(e,t){R.remove(e,t)},_data:function(e,t,i){return N.access(e,t,i)},_removeData:function(e,t){N.remove(e,t)}}),p.fn.extend({data:function(e,t){var i,n,s,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(s=R.get(o),1===o.nodeType&&!N.get(o,"hasDataAttrs"))){for(i=a.length;i--;)a[i]&&0===(n=a[i].name).indexOf("data-")&&(n=p.camelCase(n.slice(5)),U(o,n,s[n]));N.set(o,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each((function(){R.set(this,e)})):O(this,(function(t){var i,n;if(o&&void 0===t)return void 0!==(i=R.get(o,e)||R.get(o,e.replace(H,"-$&").toLowerCase()))?i:(n=p.camelCase(e),void 0!==(i=R.get(o,n))||void 0!==(i=U(o,n,void 0))?i:void 0);n=p.camelCase(e),this.each((function(){var i=R.get(this,n);R.set(this,n,t),e.indexOf("-")>-1&&void 0!==i&&R.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){R.remove(this,e)}))}}),p.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=N.get(e,t),i&&(!n||p.isArray(i)?n=N.access(e,t,p.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=p.queue(e,t),n=i.length,s=i.shift(),o=p._queueHooks(e,t);"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===t&&i.unshift("inprogress"),delete o.stop,s.call(e,(function(){p.dequeue(e,t)}),o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return N.get(e,i)||N.access(e,i,{empty:p.Callbacks("once memory").add((function(){N.remove(e,[t+"queue",i])}))})}}),p.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?p.queue(this[0],e):void 0===t?this:this.each((function(){var i=p.queue(this,e,t);p._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&p.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){p.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,s=p.Deferred(),o=this,a=this.length,r=function(){--n||s.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(i=N.get(o[a],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(r));return r(),s.promise(t)}});var V=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,$=new RegExp("^(?:([+-])=|)("+V+")([a-z%]*)$","i"),j=["Top","Right","Bottom","Left"],z=function(e,t){return e=t||e,"none"===p.css(e,"display")||!p.contains(e.ownerDocument,e)};function G(e,t,i,n){var s,o=1,a=20,r=n?function(){return n.cur()}:function(){return p.css(e,t,"")},l=r(),c=i&&i[3]||(p.cssNumber[t]?"":"px"),d=(p.cssNumber[t]||"px"!==c&&+l)&&$.exec(p.css(e,t));if(d&&d[3]!==c){c=c||d[3],i=i||[],d=+l||1;do{d/=o=o||".5",p.style(e,t,d+c)}while(o!==(o=r()/l)&&1!==o&&--a)}return i&&(d=+d||+l||0,s=i[1]?d+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=d,n.end=s)),s}var q=/^(?:checkbox|radio)$/i,Y=/<([\w:-]+)/,X=/^$|\/(?:java|ecma)script/i,K={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Z(e,t){var i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&p.nodeName(e,t)?p.merge([e],i):i}function J(e,t){for(var i=0,n=e.length;i<n;i++)N.set(e[i],"globalEval",!t||N.get(t[i],"globalEval"))}K.optgroup=K.option,K.tbody=K.tfoot=K.colgroup=K.caption=K.thead,K.th=K.td;var Q,ee,te=/<|&#?\w+;/;function ie(e,t,i,n,s){for(var o,a,r,l,c,d,h=t.createDocumentFragment(),u=[],g=0,f=e.length;g<f;g++)if((o=e[g])||0===o)if("object"===p.type(o))p.merge(u,o.nodeType?[o]:o);else if(te.test(o)){for(a=a||h.appendChild(t.createElement("div")),r=(Y.exec(o)||["",""])[1].toLowerCase(),l=K[r]||K._default,a.innerHTML=l[1]+p.htmlPrefilter(o)+l[2],d=l[0];d--;)a=a.lastChild;p.merge(u,a.childNodes),(a=h.firstChild).textContent=""}else u.push(t.createTextNode(o));for(h.textContent="",g=0;o=u[g++];)if(n&&p.inArray(o,n)>-1)s&&s.push(o);else if(c=p.contains(o.ownerDocument,o),a=Z(h.appendChild(o),"script"),c&&J(a),i)for(d=0;o=a[d++];)X.test(o.type||"")&&i.push(o);return h}Q=n.createDocumentFragment().appendChild(n.createElement("div")),(ee=n.createElement("input")).setAttribute("type","radio"),ee.setAttribute("checked","checked"),ee.setAttribute("name","t"),Q.appendChild(ee),h.checkClone=Q.cloneNode(!0).cloneNode(!0).lastChild.checked,Q.innerHTML="<textarea>x</textarea>",h.noCloneChecked=!!Q.cloneNode(!0).lastChild.defaultValue;var ne=/^key/,se=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,oe=/^([^.]*)(?:\.(.+)|)/;function ae(){return!0}function re(){return!1}function le(){try{return n.activeElement}catch(e){}}function ce(e,t,i,n,s,o){var a,r;if("object"==typeof t){for(r in"string"!=typeof i&&(n=n||i,i=void 0),t)ce(e,r,i,n,t[r],o);return e}if(null==n&&null==s?(s=i,n=i=void 0):null==s&&("string"==typeof i?(s=n,n=void 0):(s=n,n=i,i=void 0)),!1===s)s=re;else if(!s)return e;return 1===o&&(a=s,s=function(e){return p().off(e),a.apply(this,arguments)},s.guid=a.guid||(a.guid=p.guid++)),e.each((function(){p.event.add(this,t,s,n,i)}))}p.event={global:{},add:function(e,t,i,n,s){var o,a,r,l,c,d,h,u,g,f,m,v=N.get(e);if(v)for(i.handler&&(i=(o=i).handler,s=o.selector),i.guid||(i.guid=p.guid++),(l=v.events)||(l=v.events={}),(a=v.handle)||(a=v.handle=function(t){return void 0!==p&&p.event.triggered!==t.type?p.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(L)||[""]).length;c--;)g=m=(r=oe.exec(t[c])||[])[1],f=(r[2]||"").split(".").sort(),g&&(h=p.event.special[g]||{},g=(s?h.delegateType:h.bindType)||g,h=p.event.special[g]||{},d=p.extend({type:g,origType:m,data:n,handler:i,guid:i.guid,selector:s,needsContext:s&&p.expr.match.needsContext.test(s),namespace:f.join(".")},o),(u=l[g])||((u=l[g]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,n,f,a)||e.addEventListener&&e.addEventListener(g,a)),h.add&&(h.add.call(e,d),d.handler.guid||(d.handler.guid=i.guid)),s?u.splice(u.delegateCount++,0,d):u.push(d),p.event.global[g]=!0)},remove:function(e,t,i,n,s){var o,a,r,l,c,d,h,u,g,f,m,v=N.hasData(e)&&N.get(e);if(v&&(l=v.events)){for(c=(t=(t||"").match(L)||[""]).length;c--;)if(g=m=(r=oe.exec(t[c])||[])[1],f=(r[2]||"").split(".").sort(),g){for(h=p.event.special[g]||{},u=l[g=(n?h.delegateType:h.bindType)||g]||[],r=r[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=u.length;o--;)d=u[o],!s&&m!==d.origType||i&&i.guid!==d.guid||r&&!r.test(d.namespace)||n&&n!==d.selector&&("**"!==n||!d.selector)||(u.splice(o,1),d.selector&&u.delegateCount--,h.remove&&h.remove.call(e,d));a&&!u.length&&(h.teardown&&!1!==h.teardown.call(e,f,v.handle)||p.removeEvent(e,g,v.handle),delete l[g])}else for(g in l)p.event.remove(e,g+t[c],i,n,!0);p.isEmptyObject(l)&&N.remove(e,"handle events")}},dispatch:function(e){e=p.event.fix(e);var t,i,n,o,a,r=[],l=s.call(arguments),c=(N.get(this,"events")||{})[e.type]||[],d=p.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!d.preDispatch||!1!==d.preDispatch.call(this,e)){for(r=p.event.handlers.call(this,e,c),t=0;(o=r[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,i=0;(a=o.handlers[i++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(a.namespace)||(e.handleObj=a,e.data=a.data,void 0!==(n=((p.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,l))&&!1===(e.result=n)&&(e.preventDefault(),e.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,s,o,a=[],r=t.delegateCount,l=e.target;if(r&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(n=[],i=0;i<r;i++)void 0===n[s=(o=t[i]).selector+" "]&&(n[s]=o.needsContext?p(s,this).index(l)>-1:p.find(s,this,null,[l]).length),n[s]&&n.push(o);n.length&&a.push({elem:l,handlers:n})}return r<t.length&&a.push({elem:this,handlers:t.slice(r)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,s,o,a=t.button;return null==e.pageX&&null!=t.clientX&&(s=(i=e.target.ownerDocument||n).documentElement,o=i.body,e.pageX=t.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),e.which||void 0===a||(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(e){if(e[p.expando])return e;var t,i,s,o=e.type,a=e,r=this.fixHooks[o];for(r||(this.fixHooks[o]=r=se.test(o)?this.mouseHooks:ne.test(o)?this.keyHooks:{}),s=r.props?this.props.concat(r.props):this.props,e=new p.Event(a),t=s.length;t--;)e[i=s[t]]=a[i];return e.target||(e.target=n),3===e.target.nodeType&&(e.target=e.target.parentNode),r.filter?r.filter(e,a):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==le()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===le()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&p.nodeName(this,"input"))return this.click(),!1},_default:function(e){return p.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},p.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},p.Event=function(e,t){if(!(this instanceof p.Event))return new p.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?ae:re):this.type=e,t&&p.extend(this,t),this.timeStamp=e&&e.timeStamp||p.now(),this[p.expando]=!0},p.Event.prototype={constructor:p.Event,isDefaultPrevented:re,isPropagationStopped:re,isImmediatePropagationStopped:re,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=ae,e&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=ae,e&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=ae,e&&e.stopImmediatePropagation(),this.stopPropagation()}},p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){p.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,s=e.relatedTarget,o=e.handleObj;return s&&(s===n||p.contains(n,s))||(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}})),p.fn.extend({on:function(e,t,i,n){return ce(this,e,t,i,n)},one:function(e,t,i,n){return ce(this,e,t,i,n,1)},off:function(e,t,i){var n,s;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,p(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(s in e)this.off(s,t,e[s]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=re),this.each((function(){p.event.remove(this,e,i,t)}))}});var de=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,he=/<script|<style|<link/i,ue=/checked\s*(?:[^=]|=\s*.checked.)/i,pe=/^true\/(.*)/,ge=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function fe(e,t){return p.nodeName(e,"table")&&p.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function me(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ve(e){var t=pe.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function be(e,t){var i,n,s,o,a,r,l,c;if(1===t.nodeType){if(N.hasData(e)&&(o=N.access(e),a=N.set(t,o),c=o.events))for(s in delete a.handle,a.events={},c)for(i=0,n=c[s].length;i<n;i++)p.event.add(t,s,c[s][i]);R.hasData(e)&&(r=R.access(e),l=p.extend({},r),R.set(t,l))}}function ye(e,t,i,n){t=o.apply([],t);var s,a,r,l,c,d,u=0,g=e.length,f=g-1,m=t[0],v=p.isFunction(m);if(v||g>1&&"string"==typeof m&&!h.checkClone&&ue.test(m))return e.each((function(s){var o=e.eq(s);v&&(t[0]=m.call(this,s,o.html())),ye(o,t,i,n)}));if(g&&(a=(s=ie(t,e[0].ownerDocument,!1,e,n)).firstChild,1===s.childNodes.length&&(s=a),a||n)){for(l=(r=p.map(Z(s,"script"),me)).length;u<g;u++)c=s,u!==f&&(c=p.clone(c,!0,!0),l&&p.merge(r,Z(c,"script"))),i.call(e[u],c,u);if(l)for(d=r[r.length-1].ownerDocument,p.map(r,ve),u=0;u<l;u++)c=r[u],X.test(c.type||"")&&!N.access(c,"globalEval")&&p.contains(d,c)&&(c.src?p._evalUrl&&p._evalUrl(c.src):p.globalEval(c.textContent.replace(ge,"")))}return e}function Se(e,t,i){for(var n,s=t?p.filter(t,e):e,o=0;null!=(n=s[o]);o++)i||1!==n.nodeType||p.cleanData(Z(n)),n.parentNode&&(i&&p.contains(n.ownerDocument,n)&&J(Z(n,"script")),n.parentNode.removeChild(n));return e}p.extend({htmlPrefilter:function(e){return e.replace(de,"<$1></$2>")},clone:function(e,t,i){var n,s,o,a,r,l,c,d=e.cloneNode(!0),u=p.contains(e.ownerDocument,e);if(!(h.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||p.isXMLDoc(e)))for(a=Z(d),n=0,s=(o=Z(e)).length;n<s;n++)r=o[n],l=a[n],c=void 0,"input"===(c=l.nodeName.toLowerCase())&&q.test(r.type)?l.checked=r.checked:"input"!==c&&"textarea"!==c||(l.defaultValue=r.defaultValue);if(t)if(i)for(o=o||Z(e),a=a||Z(d),n=0,s=o.length;n<s;n++)be(o[n],a[n]);else be(e,d);return(a=Z(d,"script")).length>0&&J(a,!u&&Z(e,"script")),d},cleanData:function(e){for(var t,i,n,s=p.event.special,o=0;void 0!==(i=e[o]);o++)if(D(i)){if(t=i[N.expando]){if(t.events)for(n in t.events)s[n]?p.event.remove(i,n):p.removeEvent(i,n,t.handle);i[N.expando]=void 0}i[R.expando]&&(i[R.expando]=void 0)}}}),p.fn.extend({domManip:ye,detach:function(e){return Se(this,e,!0)},remove:function(e){return Se(this,e)},text:function(e){return O(this,(function(e){return void 0===e?p.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return ye(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||fe(this,e).appendChild(e)}))},prepend:function(){return ye(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=fe(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return ye(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return ye(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(p.cleanData(Z(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return p.clone(this,e,t)}))},html:function(e){return O(this,(function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!he.test(e)&&!K[(Y.exec(e)||["",""])[1].toLowerCase()]){e=p.htmlPrefilter(e);try{for(;i<n;i++)1===(t=this[i]||{}).nodeType&&(p.cleanData(Z(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return ye(this,arguments,(function(t){var i=this.parentNode;p.inArray(this,e)<0&&(p.cleanData(Z(this)),i&&i.replaceChild(t,this))}),e)}}),p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){p.fn[e]=function(e){for(var i,n=[],s=p(e),o=s.length-1,r=0;r<=o;r++)i=r===o?this:this.clone(!0),p(s[r])[t](i),a.apply(n,i.get());return this.pushStack(n)}}));var we,Ee={HTML:"block",BODY:"block"};function Te(e,t){var i=p(t.createElement(e)).appendTo(t.body),n=p.css(i[0],"display");return i.detach(),n}function _e(e){var t=n,i=Ee[e];return i||("none"!==(i=Te(e,t))&&i||((t=(we=(we||p("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),i=Te(e,t),we.detach()),Ee[e]=i),i}var Pe=/^margin/,Ie=new RegExp("^("+V+")(?!px)[a-z%]+$","i"),Fe=function(t){var i=t.ownerDocument.defaultView;return i&&i.opener||(i=e),i.getComputedStyle(t)},Ce=function(e,t,i,n){var s,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];for(o in s=i.apply(e,n||[]),t)e.style[o]=a[o];return s},Me=n.documentElement;function ke(e,t,i){var n,s,o,a,r=e.style;return""!==(a=(i=i||Fe(e))?i.getPropertyValue(t)||i[t]:void 0)&&void 0!==a||p.contains(e.ownerDocument,e)||(a=p.style(e,t)),i&&!h.pixelMarginRight()&&Ie.test(a)&&Pe.test(t)&&(n=r.width,s=r.minWidth,o=r.maxWidth,r.minWidth=r.maxWidth=r.width=a,a=i.width,r.width=n,r.minWidth=s,r.maxWidth=o),void 0!==a?a+"":a}function xe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){var t,i,s,o,a=n.createElement("div"),r=n.createElement("div");function l(){r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",r.innerHTML="",Me.appendChild(a);var n=e.getComputedStyle(r);t="1%"!==n.top,o="2px"===n.marginLeft,i="4px"===n.width,r.style.marginRight="50%",s="4px"===n.marginRight,Me.removeChild(a)}r.style&&(r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",h.clearCloneStyle="content-box"===r.style.backgroundClip,a.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",a.appendChild(r),p.extend(h,{pixelPosition:function(){return l(),t},boxSizingReliable:function(){return null==i&&l(),i},pixelMarginRight:function(){return null==i&&l(),s},reliableMarginLeft:function(){return null==i&&l(),o},reliableMarginRight:function(){var t,i=r.appendChild(n.createElement("div"));return i.style.cssText=r.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",r.style.width="1px",Me.appendChild(a),t=!parseFloat(e.getComputedStyle(i).marginRight),Me.removeChild(a),r.removeChild(i),t}}))}();var Le=/^(none|table(?!-c[ea]).+)/,Ae={position:"absolute",visibility:"hidden",display:"block"},Oe={letterSpacing:"0",fontWeight:"400"},De=["Webkit","O","Moz","ms"],We=n.createElement("div").style;function Ne(e){if(e in We)return e;for(var t=e[0].toUpperCase()+e.slice(1),i=De.length;i--;)if((e=De[i]+t)in We)return e}function Re(e,t,i){var n=$.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t}function Be(e,t,i,n,s){for(var o=i===(n?"border":"content")?4:"width"===t?1:0,a=0;o<4;o+=2)"margin"===i&&(a+=p.css(e,i+j[o],!0,s)),n?("content"===i&&(a-=p.css(e,"padding"+j[o],!0,s)),"margin"!==i&&(a-=p.css(e,"border"+j[o]+"Width",!0,s))):(a+=p.css(e,"padding"+j[o],!0,s),"padding"!==i&&(a+=p.css(e,"border"+j[o]+"Width",!0,s)));return a}function He(t,i,s){var o=!0,a="width"===i?t.offsetWidth:t.offsetHeight,r=Fe(t),l="border-box"===p.css(t,"boxSizing",!1,r);if(n.msFullscreenElement&&e.top!==e&&t.getClientRects().length&&(a=Math.round(t.getBoundingClientRect()[i])),a<=0||null==a){if(((a=ke(t,i,r))<0||null==a)&&(a=t.style[i]),Ie.test(a))return a;o=l&&(h.boxSizingReliable()||a===t.style[i]),a=parseFloat(a)||0}return a+Be(t,i,s||(l?"border":"content"),o,r)+"px"}function Ue(e,t){for(var i,n,s,o=[],a=0,r=e.length;a<r;a++)(n=e[a]).style&&(o[a]=N.get(n,"olddisplay"),i=n.style.display,t?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&z(n)&&(o[a]=N.access(n,"olddisplay",_e(n.nodeName)))):(s=z(n),"none"===i&&s||N.set(n,"olddisplay",s?i:p.css(n,"display"))));for(a=0;a<r;a++)(n=e[a]).style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[a]||"":"none"));return e}function Ve(e,t,i,n,s){return new Ve.prototype.init(e,t,i,n,s)}p.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=ke(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,a,r=p.camelCase(t),l=e.style;if(t=p.cssProps[r]||(p.cssProps[r]=Ne(r)||r),a=p.cssHooks[t]||p.cssHooks[r],void 0===i)return a&&"get"in a&&void 0!==(s=a.get(e,!1,n))?s:l[t];"string"===(o=typeof i)&&(s=$.exec(i))&&s[1]&&(i=G(e,t,s),o="number"),null!=i&&i==i&&("number"===o&&(i+=s&&s[3]||(p.cssNumber[r]?"":"px")),h.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(i=a.set(e,i,n))||(l[t]=i))}},css:function(e,t,i,n){var s,o,a,r=p.camelCase(t);return t=p.cssProps[r]||(p.cssProps[r]=Ne(r)||r),(a=p.cssHooks[t]||p.cssHooks[r])&&"get"in a&&(s=a.get(e,!0,i)),void 0===s&&(s=ke(e,t,n)),"normal"===s&&t in Oe&&(s=Oe[t]),""===i||i?(o=parseFloat(s),!0===i||isFinite(o)?o||0:s):s}}),p.each(["height","width"],(function(e,t){p.cssHooks[t]={get:function(e,i,n){if(i)return Le.test(p.css(e,"display"))&&0===e.offsetWidth?Ce(e,Ae,(function(){return He(e,t,n)})):He(e,t,n)},set:function(e,i,n){var s,o=n&&Fe(e),a=n&&Be(e,t,n,"border-box"===p.css(e,"boxSizing",!1,o),o);return a&&(s=$.exec(i))&&"px"!==(s[3]||"px")&&(e.style[t]=i,i=p.css(e,t)),Re(0,i,a)}}})),p.cssHooks.marginLeft=xe(h.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(ke(e,"marginLeft"))||e.getBoundingClientRect().left-Ce(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),p.cssHooks.marginRight=xe(h.reliableMarginRight,(function(e,t){if(t)return Ce(e,{display:"inline-block"},ke,[e,"marginRight"])})),p.each({margin:"",padding:"",border:"Width"},(function(e,t){p.cssHooks[e+t]={expand:function(i){for(var n=0,s={},o="string"==typeof i?i.split(" "):[i];n<4;n++)s[e+j[n]+t]=o[n]||o[n-2]||o[0];return s}},Pe.test(e)||(p.cssHooks[e+t].set=Re)})),p.fn.extend({css:function(e,t){return O(this,(function(e,t,i){var n,s,o={},a=0;if(p.isArray(t)){for(n=Fe(e),s=t.length;a<s;a++)o[t[a]]=p.css(e,t[a],!1,n);return o}return void 0!==i?p.style(e,t,i):p.css(e,t)}),e,t,arguments.length>1)},show:function(){return Ue(this,!0)},hide:function(){return Ue(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){z(this)?p(this).show():p(this).hide()}))}}),p.Tween=Ve,Ve.prototype={constructor:Ve,init:function(e,t,i,n,s,o){this.elem=e,this.prop=i,this.easing=s||p.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(p.cssNumber[i]?"":"px")},cur:function(){var e=Ve.propHooks[this.prop];return e&&e.get?e.get(this):Ve.propHooks._default.get(this)},run:function(e){var t,i=Ve.propHooks[this.prop];return this.options.duration?this.pos=t=p.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Ve.propHooks._default.set(this),this}},Ve.prototype.init.prototype=Ve.prototype,Ve.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=p.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){p.fx.step[e.prop]?p.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[p.cssProps[e.prop]]&&!p.cssHooks[e.prop]?e.elem[e.prop]=e.now:p.style(e.elem,e.prop,e.now+e.unit)}}},Ve.propHooks.scrollTop=Ve.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},p.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},p.fx=Ve.prototype.init,p.fx.step={};var $e,je,ze=/^(?:toggle|show|hide)$/,Ge=/queueHooks$/;function qe(){return e.setTimeout((function(){$e=void 0})),$e=p.now()}function Ye(e,t){var i,n=0,s={height:e};for(t=t?1:0;n<4;n+=2-t)s["margin"+(i=j[n])]=s["padding"+i]=e;return t&&(s.opacity=s.width=e),s}function Xe(e,t,i){for(var n,s=(Ke.tweeners[t]||[]).concat(Ke.tweeners["*"]),o=0,a=s.length;o<a;o++)if(n=s[o].call(i,t,e))return n}function Ke(e,t,i){var n,s,o=0,a=Ke.prefilters.length,r=p.Deferred().always((function(){delete l.elem})),l=function(){if(s)return!1;for(var t=$e||qe(),i=Math.max(0,c.startTime+c.duration-t),n=1-(i/c.duration||0),o=0,a=c.tweens.length;o<a;o++)c.tweens[o].run(n);return r.notifyWith(e,[c,n,i]),n<1&&a?i:(r.resolveWith(e,[c]),!1)},c=r.promise({elem:e,props:p.extend({},t),opts:p.extend(!0,{specialEasing:{},easing:p.easing._default},i),originalProperties:t,originalOptions:i,startTime:$e||qe(),duration:i.duration,tweens:[],createTween:function(t,i){var n=p.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(s)return this;for(s=!0;i<n;i++)c.tweens[i].run(1);return t?(r.notifyWith(e,[c,1,0]),r.resolveWith(e,[c,t])):r.rejectWith(e,[c,t]),this}}),d=c.props;for(!function(e,t){var i,n,s,o,a;for(i in e)if(s=t[n=p.camelCase(i)],o=e[i],p.isArray(o)&&(s=o[1],o=e[i]=o[0]),i!==n&&(e[n]=o,delete e[i]),(a=p.cssHooks[n])&&"expand"in a)for(i in o=a.expand(o),delete e[n],o)i in e||(e[i]=o[i],t[i]=s);else t[n]=s}(d,c.opts.specialEasing);o<a;o++)if(n=Ke.prefilters[o].call(c,e,d,c.opts))return p.isFunction(n.stop)&&(p._queueHooks(c.elem,c.opts.queue).stop=p.proxy(n.stop,n)),n;return p.map(d,Xe,c),p.isFunction(c.opts.start)&&c.opts.start.call(e,c),p.fx.timer(p.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}p.Animation=p.extend(Ke,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return G(i.elem,e,$.exec(t),i),i}]},tweener:function(e,t){p.isFunction(e)?(t=e,e=["*"]):e=e.match(L);for(var i,n=0,s=e.length;n<s;n++)i=e[n],Ke.tweeners[i]=Ke.tweeners[i]||[],Ke.tweeners[i].unshift(t)},prefilters:[function(e,t,i){var n,s,o,a,r,l,c,d=this,h={},u=e.style,g=e.nodeType&&z(e),f=N.get(e,"fxshow");for(n in i.queue||(null==(r=p._queueHooks(e,"fx")).unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,d.always((function(){d.always((function(){r.unqueued--,p.queue(e,"fx").length||r.empty.fire()}))}))),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[u.overflow,u.overflowX,u.overflowY],"inline"===("none"===(c=p.css(e,"display"))?N.get(e,"olddisplay")||_e(e.nodeName):c)&&"none"===p.css(e,"float")&&(u.display="inline-block")),i.overflow&&(u.overflow="hidden",d.always((function(){u.overflow=i.overflow[0],u.overflowX=i.overflow[1],u.overflowY=i.overflow[2]}))),t)if(s=t[n],ze.exec(s)){if(delete t[n],o=o||"toggle"===s,s===(g?"hide":"show")){if("show"!==s||!f||void 0===f[n])continue;g=!0}h[n]=f&&f[n]||p.style(e,n)}else c=void 0;if(p.isEmptyObject(h))"inline"===("none"===c?_e(e.nodeName):c)&&(u.display=c);else for(n in f?"hidden"in f&&(g=f.hidden):f=N.access(e,"fxshow",{}),o&&(f.hidden=!g),g?p(e).show():d.done((function(){p(e).hide()})),d.done((function(){var t;for(t in N.remove(e,"fxshow"),h)p.style(e,t,h[t])})),h)a=Xe(g?f[n]:0,n,d),n in f||(f[n]=a.start,g&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}],prefilter:function(e,t){t?Ke.prefilters.unshift(e):Ke.prefilters.push(e)}}),p.speed=function(e,t,i){var n=e&&"object"==typeof e?p.extend({},e):{complete:i||!i&&t||p.isFunction(e)&&e,duration:e,easing:i&&t||t&&!p.isFunction(t)&&t};return n.duration=p.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in p.fx.speeds?p.fx.speeds[n.duration]:p.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){p.isFunction(n.old)&&n.old.call(this),n.queue&&p.dequeue(this,n.queue)},n},p.fn.extend({fadeTo:function(e,t,i,n){return this.filter(z).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var s=p.isEmptyObject(e),o=p.speed(t,i,n),a=function(){var t=Ke(this,p.extend({},e),o);(s||N.get(this,"finish"))&&t.stop(!0)};return a.finish=a,s||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each((function(){var t=!0,s=null!=e&&e+"queueHooks",o=p.timers,a=N.get(this);if(s)a[s]&&a[s].stop&&n(a[s]);else for(s in a)a[s]&&a[s].stop&&Ge.test(s)&&n(a[s]);for(s=o.length;s--;)o[s].elem!==this||null!=e&&o[s].queue!==e||(o[s].anim.stop(i),t=!1,o.splice(s,1));!t&&i||p.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,i=N.get(this),n=i[e+"queue"],s=i[e+"queueHooks"],o=p.timers,a=n?n.length:0;for(i.finish=!0,p.queue(this,e,[]),s&&s.stop&&s.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish}))}}),p.each(["toggle","show","hide"],(function(e,t){var i=p.fn[t];p.fn[t]=function(e,n,s){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(Ye(t,!0),e,n,s)}})),p.each({slideDown:Ye("show"),slideUp:Ye("hide"),slideToggle:Ye("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){p.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}})),p.timers=[],p.fx.tick=function(){var e,t=0,i=p.timers;for($e=p.now();t<i.length;t++)(e=i[t])()||i[t]!==e||i.splice(t--,1);i.length||p.fx.stop(),$e=void 0},p.fx.timer=function(e){p.timers.push(e),e()?p.fx.start():p.timers.pop()},p.fx.interval=13,p.fx.start=function(){je||(je=e.setInterval(p.fx.tick,p.fx.interval))},p.fx.stop=function(){e.clearInterval(je),je=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fn.delay=function(t,i){return t=p.fx&&p.fx.speeds[t]||t,i=i||"fx",this.queue(i,(function(i,n){var s=e.setTimeout(i,t);n.stop=function(){e.clearTimeout(s)}}))},function(){var e=n.createElement("input"),t=n.createElement("select"),i=t.appendChild(n.createElement("option"));e.type="checkbox",h.checkOn=""!==e.value,h.optSelected=i.selected,t.disabled=!0,h.optDisabled=!i.disabled,(e=n.createElement("input")).value="t",e.type="radio",h.radioValue="t"===e.value}();var Ze,Je=p.expr.attrHandle;p.fn.extend({attr:function(e,t){return O(this,p.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){p.removeAttr(this,e)}))}}),p.extend({attr:function(e,t,i){var n,s,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?p.prop(e,t,i):(1===o&&p.isXMLDoc(e)||(t=t.toLowerCase(),s=p.attrHooks[t]||(p.expr.match.bool.test(t)?Ze:void 0)),void 0!==i?null===i?void p.removeAttr(e,t):s&&"set"in s&&void 0!==(n=s.set(e,i,t))?n:(e.setAttribute(t,i+""),i):s&&"get"in s&&null!==(n=s.get(e,t))?n:null==(n=p.find.attr(e,t))?void 0:n)},attrHooks:{type:{set:function(e,t){if(!h.radioValue&&"radio"===t&&p.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,n,s=0,o=t&&t.match(L);if(o&&1===e.nodeType)for(;i=o[s++];)n=p.propFix[i]||i,p.expr.match.bool.test(i)&&(e[n]=!1),e.removeAttribute(i)}}),Ze={set:function(e,t,i){return!1===t?p.removeAttr(e,i):e.setAttribute(i,i),i}},p.each(p.expr.match.bool.source.match(/\w+/g),(function(e,t){var i=Je[t]||p.find.attr;Je[t]=function(e,t,n){var s,o;return n||(o=Je[t],Je[t]=s,s=null!=i(e,t,n)?t.toLowerCase():null,Je[t]=o),s}}));var Qe=/^(?:input|select|textarea|button)$/i,et=/^(?:a|area)$/i;p.fn.extend({prop:function(e,t){return O(this,p.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[p.propFix[e]||e]}))}}),p.extend({prop:function(e,t,i){var n,s,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&p.isXMLDoc(e)||(t=p.propFix[t]||t,s=p.propHooks[t]),void 0!==i?s&&"set"in s&&void 0!==(n=s.set(e,i,t))?n:e[t]=i:s&&"get"in s&&null!==(n=s.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=p.find.attr(e,"tabindex");return t?parseInt(t,10):Qe.test(e.nodeName)||et.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),h.optSelected||(p.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),p.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){p.propFix[this.toLowerCase()]=this}));var tt=/[\t\r\n\f]/g;function it(e){return e.getAttribute&&e.getAttribute("class")||""}p.fn.extend({addClass:function(e){var t,i,n,s,o,a,r,l=0;if(p.isFunction(e))return this.each((function(t){p(this).addClass(e.call(this,t,it(this)))}));if("string"==typeof e&&e)for(t=e.match(L)||[];i=this[l++];)if(s=it(i),n=1===i.nodeType&&(" "+s+" ").replace(tt," ")){for(a=0;o=t[a++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");s!==(r=p.trim(n))&&i.setAttribute("class",r)}return this},removeClass:function(e){var t,i,n,s,o,a,r,l=0;if(p.isFunction(e))return this.each((function(t){p(this).removeClass(e.call(this,t,it(this)))}));if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(L)||[];i=this[l++];)if(s=it(i),n=1===i.nodeType&&(" "+s+" ").replace(tt," ")){for(a=0;o=t[a++];)for(;n.indexOf(" "+o+" ")>-1;)n=n.replace(" "+o+" "," ");s!==(r=p.trim(n))&&i.setAttribute("class",r)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):p.isFunction(e)?this.each((function(i){p(this).toggleClass(e.call(this,i,it(this),t),t)})):this.each((function(){var t,n,s,o;if("string"===i)for(n=0,s=p(this),o=e.match(L)||[];t=o[n++];)s.hasClass(t)?s.removeClass(t):s.addClass(t);else void 0!==e&&"boolean"!==i||((t=it(this))&&N.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":N.get(this,"__className__")||""))}))},hasClass:function(e){var t,i,n=0;for(t=" "+e+" ";i=this[n++];)if(1===i.nodeType&&(" "+it(i)+" ").replace(tt," ").indexOf(t)>-1)return!0;return!1}});var nt=/\r/g,st=/[\x20\t\r\n\f]+/g;p.fn.extend({val:function(e){var t,i,n,s=this[0];return arguments.length?(n=p.isFunction(e),this.each((function(i){var s;1===this.nodeType&&(null==(s=n?e.call(this,i,p(this).val()):e)?s="":"number"==typeof s?s+="":p.isArray(s)&&(s=p.map(s,(function(e){return null==e?"":e+""}))),(t=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,s,"value")||(this.value=s))}))):s?(t=p.valHooks[s.type]||p.valHooks[s.nodeName.toLowerCase()])&&"get"in t&&void 0!==(i=t.get(s,"value"))?i:"string"==typeof(i=s.value)?i.replace(nt,""):null==i?"":i:void 0}}),p.extend({valHooks:{option:{get:function(e){var t=p.find.attr(e,"value");return null!=t?t:p.trim(p.text(e)).replace(st," ")}},select:{get:function(e){for(var t,i,n=e.options,s=e.selectedIndex,o="select-one"===e.type||s<0,a=o?null:[],r=o?s+1:n.length,l=s<0?r:o?s:0;l<r;l++)if(((i=n[l]).selected||l===s)&&(h.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!p.nodeName(i.parentNode,"optgroup"))){if(t=p(i).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var i,n,s=e.options,o=p.makeArray(t),a=s.length;a--;)((n=s[a]).selected=p.inArray(p.valHooks.option.get(n),o)>-1)&&(i=!0);return i||(e.selectedIndex=-1),o}}}}),p.each(["radio","checkbox"],(function(){p.valHooks[this]={set:function(e,t){if(p.isArray(t))return e.checked=p.inArray(p(e).val(),t)>-1}},h.checkOn||(p.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var ot=/^(?:focusinfocus|focusoutblur)$/;p.extend(p.event,{trigger:function(t,i,s,o){var a,r,l,c,h,u,g,f=[s||n],m=d.call(t,"type")?t.type:t,v=d.call(t,"namespace")?t.namespace.split("."):[];if(r=l=s=s||n,3!==s.nodeType&&8!==s.nodeType&&!ot.test(m+p.event.triggered)&&(m.indexOf(".")>-1&&(v=m.split("."),m=v.shift(),v.sort()),h=m.indexOf(":")<0&&"on"+m,(t=t[p.expando]?t:new p.Event(m,"object"==typeof t&&t)).isTrigger=o?2:3,t.namespace=v.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=s),i=null==i?[t]:p.makeArray(i,[t]),g=p.event.special[m]||{},o||!g.trigger||!1!==g.trigger.apply(s,i))){if(!o&&!g.noBubble&&!p.isWindow(s)){for(c=g.delegateType||m,ot.test(c+m)||(r=r.parentNode);r;r=r.parentNode)f.push(r),l=r;l===(s.ownerDocument||n)&&f.push(l.defaultView||l.parentWindow||e)}for(a=0;(r=f[a++])&&!t.isPropagationStopped();)t.type=a>1?c:g.bindType||m,(u=(N.get(r,"events")||{})[t.type]&&N.get(r,"handle"))&&u.apply(r,i),(u=h&&r[h])&&u.apply&&D(r)&&(t.result=u.apply(r,i),!1===t.result&&t.preventDefault());return t.type=m,o||t.isDefaultPrevented()||g._default&&!1!==g._default.apply(f.pop(),i)||!D(s)||h&&p.isFunction(s[m])&&!p.isWindow(s)&&((l=s[h])&&(s[h]=null),p.event.triggered=m,s[m](),p.event.triggered=void 0,l&&(s[h]=l)),t.result}},simulate:function(e,t,i){var n=p.extend(new p.Event,i,{type:e,isSimulated:!0});p.event.trigger(n,null,t),n.isDefaultPrevented()&&i.preventDefault()}}),p.fn.extend({trigger:function(e,t){return this.each((function(){p.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var i=this[0];if(i)return p.event.trigger(e,t,i,!0)}}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),(function(e,t){p.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}})),p.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),h.focusin="onfocusin"in e,h.focusin||p.each({focus:"focusin",blur:"focusout"},(function(e,t){var i=function(e){p.event.simulate(t,e.target,p.event.fix(e))};p.event.special[t]={setup:function(){var n=this.ownerDocument||this,s=N.access(n,t);s||n.addEventListener(e,i,!0),N.access(n,t,(s||0)+1)},teardown:function(){var n=this.ownerDocument||this,s=N.access(n,t)-1;s?N.access(n,t,s):(n.removeEventListener(e,i,!0),N.remove(n,t))}}}));var at=e.location,rt=p.now(),lt=/\?/;p.parseJSON=function(e){return JSON.parse(e+"")},p.parseXML=function(t){var i;if(!t||"string"!=typeof t)return null;try{i=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){i=void 0}return i&&!i.getElementsByTagName("parsererror").length||p.error("Invalid XML: "+t),i};var ct=/#.*$/,dt=/([?&])_=[^&]*/,ht=/^(.*?):[ \t]*([^\r\n]*)$/gm,ut=/^(?:GET|HEAD)$/,pt=/^\/\//,gt={},ft={},mt="*/".concat("*"),vt=n.createElement("a");function bt(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,s=0,o=t.toLowerCase().match(L)||[];if(p.isFunction(i))for(;n=o[s++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function yt(e,t,i,n){var s={},o=e===ft;function a(r){var l;return s[r]=!0,p.each(e[r]||[],(function(e,r){var c=r(t,i,n);return"string"!=typeof c||o||s[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),a(c),!1)})),l}return a(t.dataTypes[0])||!s["*"]&&a("*")}function St(e,t){var i,n,s=p.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((s[i]?e:n||(n={}))[i]=t[i]);return n&&p.extend(!0,e,n),e}vt.href=at.href,p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:at.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(at.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":mt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?St(St(e,p.ajaxSettings),t):St(p.ajaxSettings,e)},ajaxPrefilter:bt(gt),ajaxTransport:bt(ft),ajax:function(t,i){"object"==typeof t&&(i=t,t=void 0),i=i||{};var s,o,a,r,l,c,d,h,u=p.ajaxSetup({},i),g=u.context||u,f=u.context&&(g.nodeType||g.jquery)?p(g):p.event,m=p.Deferred(),v=p.Callbacks("once memory"),b=u.statusCode||{},y={},S={},w=0,E="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!r)for(r={};t=ht.exec(a);)r[t[1].toLowerCase()]=t[2];t=r[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?a:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return w||(e=S[i]=S[i]||e,y[e]=t),this},overrideMimeType:function(e){return w||(u.mimeType=e),this},statusCode:function(e){var t;if(e)if(w<2)for(t in e)b[t]=[b[t],e[t]];else T.always(e[T.status]);return this},abort:function(e){var t=e||E;return s&&s.abort(t),_(0,t),this}};if(m.promise(T).complete=v.add,T.success=T.done,T.error=T.fail,u.url=((t||u.url||at.href)+"").replace(ct,"").replace(pt,at.protocol+"//"),u.type=i.method||i.type||u.method||u.type,u.dataTypes=p.trim(u.dataType||"*").toLowerCase().match(L)||[""],null==u.crossDomain){c=n.createElement("a");try{c.href=u.url,c.href=c.href,u.crossDomain=vt.protocol+"//"+vt.host!=c.protocol+"//"+c.host}catch(e){u.crossDomain=!0}}if(u.data&&u.processData&&"string"!=typeof u.data&&(u.data=p.param(u.data,u.traditional)),yt(gt,u,i,T),2===w)return T;for(h in(d=p.event&&u.global)&&0==p.active++&&p.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!ut.test(u.type),o=u.url,u.hasContent||(u.data&&(o=u.url+=(lt.test(o)?"&":"?")+u.data,delete u.data),!1===u.cache&&(u.url=dt.test(o)?o.replace(dt,"$1_="+rt++):o+(lt.test(o)?"&":"?")+"_="+rt++)),u.ifModified&&(p.lastModified[o]&&T.setRequestHeader("If-Modified-Since",p.lastModified[o]),p.etag[o]&&T.setRequestHeader("If-None-Match",p.etag[o])),(u.data&&u.hasContent&&!1!==u.contentType||i.contentType)&&T.setRequestHeader("Content-Type",u.contentType),T.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+mt+"; q=0.01":""):u.accepts["*"]),u.headers)T.setRequestHeader(h,u.headers[h]);if(u.beforeSend&&(!1===u.beforeSend.call(g,T,u)||2===w))return T.abort();for(h in E="abort",{success:1,error:1,complete:1})T[h](u[h]);if(s=yt(ft,u,i,T)){if(T.readyState=1,d&&f.trigger("ajaxSend",[T,u]),2===w)return T;u.async&&u.timeout>0&&(l=e.setTimeout((function(){T.abort("timeout")}),u.timeout));try{w=1,s.send(y,_)}catch(e){if(!(w<2))throw e;_(-1,e)}}else _(-1,"No Transport");function _(t,i,n,r){var c,h,y,S,E,_=i;2!==w&&(w=2,l&&e.clearTimeout(l),s=void 0,a=r||"",T.readyState=t>0?4:0,c=t>=200&&t<300||304===t,n&&(S=function(e,t,i){for(var n,s,o,a,r=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(s in r)if(r[s]&&r[s].test(n)){l.unshift(s);break}if(l[0]in i)o=l[0];else{for(s in i){if(!l[0]||e.converters[s+" "+l[0]]){o=s;break}a||(a=s)}o=o||a}if(o)return o!==l[0]&&l.unshift(o),i[o]}(u,T,n)),S=function(e,t,i,n){var s,o,a,r,l,c={},d=e.dataTypes.slice();if(d[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(o=d.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=d.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(a=c[l+" "+o]||c["* "+o]))for(s in c)if((r=s.split(" "))[1]===o&&(a=c[l+" "+r[0]]||c["* "+r[0]])){!0===a?a=c[s]:!0!==c[s]&&(o=r[0],d.unshift(r[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}(u,S,T,c),c?(u.ifModified&&((E=T.getResponseHeader("Last-Modified"))&&(p.lastModified[o]=E),(E=T.getResponseHeader("etag"))&&(p.etag[o]=E)),204===t||"HEAD"===u.type?_="nocontent":304===t?_="notmodified":(_=S.state,h=S.data,c=!(y=S.error))):(y=_,!t&&_||(_="error",t<0&&(t=0))),T.status=t,T.statusText=(i||_)+"",c?m.resolveWith(g,[h,_,T]):m.rejectWith(g,[T,_,y]),T.statusCode(b),b=void 0,d&&f.trigger(c?"ajaxSuccess":"ajaxError",[T,u,c?h:y]),v.fireWith(g,[T,_]),d&&(f.trigger("ajaxComplete",[T,u]),--p.active||p.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,i){return p.get(e,t,i,"json")},getScript:function(e,t){return p.get(e,void 0,t,"script")}}),p.each(["get","post"],(function(e,t){p[t]=function(e,i,n,s){return p.isFunction(i)&&(s=s||n,n=i,i=void 0),p.ajax(p.extend({url:e,type:t,dataType:s,data:i,success:n},p.isPlainObject(e)&&e))}})),p._evalUrl=function(e){return p.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},p.fn.extend({wrapAll:function(e){var t;return p.isFunction(e)?this.each((function(t){p(this).wrapAll(e.call(this,t))})):(this[0]&&(t=p(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this)},wrapInner:function(e){return p.isFunction(e)?this.each((function(t){p(this).wrapInner(e.call(this,t))})):this.each((function(){var t=p(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)}))},wrap:function(e){var t=p.isFunction(e);return this.each((function(i){p(this).wrapAll(t?e.call(this,i):e)}))},unwrap:function(){return this.parent().each((function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)})).end()}}),p.expr.filters.hidden=function(e){return!p.expr.filters.visible(e)},p.expr.filters.visible=function(e){return e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0};var wt=/%20/g,Et=/\[\]$/,Tt=/\r?\n/g,_t=/^(?:submit|button|image|reset|file)$/i,Pt=/^(?:input|select|textarea|keygen)/i;function It(e,t,i,n){var s;if(p.isArray(t))p.each(t,(function(t,s){i||Et.test(e)?n(e,s):It(e+"["+("object"==typeof s&&null!=s?t:"")+"]",s,i,n)}));else if(i||"object"!==p.type(t))n(e,t);else for(s in t)It(e+"["+s+"]",t[s],i,n)}p.param=function(e,t){var i,n=[],s=function(e,t){t=p.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=p.ajaxSettings&&p.ajaxSettings.traditional),p.isArray(e)||e.jquery&&!p.isPlainObject(e))p.each(e,(function(){s(this.name,this.value)}));else for(i in e)It(i,e[i],t,s);return n.join("&").replace(wt,"+")},p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=p.prop(this,"elements");return e?p.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!p(this).is(":disabled")&&Pt.test(this.nodeName)&&!_t.test(e)&&(this.checked||!q.test(e))})).map((function(e,t){var i=p(this).val();return null==i?null:p.isArray(i)?p.map(i,(function(e){return{name:t.name,value:e.replace(Tt,"\r\n")}})):{name:t.name,value:i.replace(Tt,"\r\n")}})).get()}}),p.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Ft={0:200,1223:204},Ct=p.ajaxSettings.xhr();h.cors=!!Ct&&"withCredentials"in Ct,h.ajax=Ct=!!Ct,p.ajaxTransport((function(t){var i,n;if(h.cors||Ct&&!t.crossDomain)return{send:function(s,o){var a,r=t.xhr();if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)r[a]=t.xhrFields[a];for(a in t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest"),s)r.setRequestHeader(a,s[a]);i=function(e){return function(){i&&(i=n=r.onload=r.onerror=r.onabort=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?o(0,"error"):o(r.status,r.statusText):o(Ft[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=i(),n=r.onerror=i("error"),void 0!==r.onabort?r.onabort=n:r.onreadystatechange=function(){4===r.readyState&&e.setTimeout((function(){i&&n()}))},i=i("abort");try{r.send(t.hasContent&&t.data||null)}catch(e){if(i)throw e}},abort:function(){i&&i()}}})),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return p.globalEval(e),e}}}),p.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),p.ajaxTransport("script",(function(e){var t,i;if(e.crossDomain)return{send:function(s,o){t=p("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&o("error"===e.type?404:200,e.type)}),n.head.appendChild(t[0])},abort:function(){i&&i()}}}));var Mt=[],kt=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mt.pop()||p.expando+"_"+rt++;return this[e]=!0,e}}),p.ajaxPrefilter("json jsonp",(function(t,i,n){var s,o,a,r=!1!==t.jsonp&&(kt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&kt.test(t.data)&&"data");if(r||"jsonp"===t.dataTypes[0])return s=t.jsonpCallback=p.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,r?t[r]=t[r].replace(kt,"$1"+s):!1!==t.jsonp&&(t.url+=(lt.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return a||p.error(s+" was not called"),a[0]},t.dataTypes[0]="json",o=e[s],e[s]=function(){a=arguments},n.always((function(){void 0===o?p(e).removeProp(s):e[s]=o,t[s]&&(t.jsonpCallback=i.jsonpCallback,Mt.push(s)),a&&p.isFunction(o)&&o(a[0]),a=o=void 0})),"script"})),p.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||n;var s=T.exec(e),o=!i&&[];return s?[t.createElement(s[1])]:(s=ie([e],t,o),o&&o.length&&p(o).remove(),p.merge([],s.childNodes))};var xt=p.fn.load;function Lt(e){return p.isWindow(e)?e:9===e.nodeType&&e.defaultView}p.fn.load=function(e,t,i){if("string"!=typeof e&&xt)return xt.apply(this,arguments);var n,s,o,a=this,r=e.indexOf(" ");return r>-1&&(n=p.trim(e.slice(r)),e=e.slice(0,r)),p.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(s="POST"),a.length>0&&p.ajax({url:e,type:s||"GET",dataType:"html",data:t}).done((function(e){o=arguments,a.html(n?p("<div>").append(p.parseHTML(e)).find(n):e)})).always(i&&function(e,t){a.each((function(){i.apply(this,o||[e.responseText,t,e])}))}),this},p.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){p.fn[t]=function(e){return this.on(t,e)}})),p.expr.filters.animated=function(e){return p.grep(p.timers,(function(t){return e===t.elem})).length},p.offset={setOffset:function(e,t,i){var n,s,o,a,r,l,c=p.css(e,"position"),d=p(e),h={};"static"===c&&(e.style.position="relative"),r=d.offset(),o=p.css(e,"top"),l=p.css(e,"left"),("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1?(a=(n=d.position()).top,s=n.left):(a=parseFloat(o)||0,s=parseFloat(l)||0),p.isFunction(t)&&(t=t.call(e,i,p.extend({},r))),null!=t.top&&(h.top=t.top-r.top+a),null!=t.left&&(h.left=t.left-r.left+s),"using"in t?t.using.call(e,h):d.css(h)}},p.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){p.offset.setOffset(this,e,t)}));var t,i,n=this[0],s={top:0,left:0},o=n&&n.ownerDocument;return o?(t=o.documentElement,p.contains(t,n)?(s=n.getBoundingClientRect(),i=Lt(o),{top:s.top+i.pageYOffset-t.clientTop,left:s.left+i.pageXOffset-t.clientLeft}):s):void 0},position:function(){if(this[0]){var e,t,i=this[0],n={top:0,left:0};return"fixed"===p.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),p.nodeName(e[0],"html")||(n=e.offset()),n.top+=p.css(e[0],"borderTopWidth",!0),n.left+=p.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-p.css(i,"marginTop",!0),left:t.left-n.left-p.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===p.css(e,"position");)e=e.offsetParent;return e||Me}))}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var i="pageYOffset"===t;p.fn[e]=function(n){return O(this,(function(e,n,s){var o=Lt(e);if(void 0===s)return o?o[t]:e[n];o?o.scrollTo(i?o.pageXOffset:s,i?s:o.pageYOffset):e[n]=s}),e,n,arguments.length)}})),p.each(["top","left"],(function(e,t){p.cssHooks[t]=xe(h.pixelPosition,(function(e,i){if(i)return i=ke(e,t),Ie.test(i)?p(e).position()[t]+"px":i}))})),p.each({Height:"height",Width:"width"},(function(e,t){p.each({padding:"inner"+e,content:t,"":"outer"+e},(function(i,n){p.fn[n]=function(n,s){var o=arguments.length&&(i||"boolean"!=typeof n),a=i||(!0===n||!0===s?"margin":"border");return O(this,(function(t,i,n){var s;return p.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===n?p.css(t,i,a):p.style(t,i,n,a)}),t,o?n:void 0,o,null)}}))})),p.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},size:function(){return this.length}}),p.fn.andSelf=p.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],(function(){return p}));var At=e.jQuery,Ot=e.$;return p.noConflict=function(t){return e.$===p&&(e.$=Ot),t&&e.jQuery===p&&(e.jQuery=At),p},t||(e.jQuery=e.$=p),p})),
/*!
 * jQuery Mousewheel 3.1.12
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}((function(e){var t,i,n=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],o=Array.prototype.slice;if(e.event.fixHooks)for(var a=n.length;a;)e.event.fixHooks[n[--a]]=e.event.mouseHooks;var r=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=s.length;t;)this.addEventListener(s[--t],l,!1);else this.onmousewheel=l;e.data(this,"mousewheel-line-height",r.getLineHeight(this)),e.data(this,"mousewheel-page-height",r.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=s.length;t;)this.removeEventListener(s[--t],l,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),n=i["offsetParent"in e.fn?"offsetParent":"parent"]();return n.length||(n=e("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function l(n){var s=n||window.event,a=o.call(arguments,1),l=0,h=0,u=0,p=0,g=0,f=0;if((n=e.event.fix(s)).type="mousewheel","detail"in s&&(u=-1*s.detail),"wheelDelta"in s&&(u=s.wheelDelta),"wheelDeltaY"in s&&(u=s.wheelDeltaY),"wheelDeltaX"in s&&(h=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(h=-1*u,u=0),l=0===u?h:u,"deltaY"in s&&(l=u=-1*s.deltaY),"deltaX"in s&&(h=s.deltaX,0===u&&(l=-1*h)),0!==u||0!==h){if(1===s.deltaMode){var m=e.data(this,"mousewheel-line-height");l*=m,u*=m,h*=m}else if(2===s.deltaMode){var v=e.data(this,"mousewheel-page-height");l*=v,u*=v,h*=v}if(p=Math.max(Math.abs(u),Math.abs(h)),(!i||p<i)&&(i=p,d(s,p)&&(i/=40)),d(s,p)&&(l/=40,h/=40,u/=40),l=Math[l>=1?"floor":"ceil"](l/i),h=Math[h>=1?"floor":"ceil"](h/i),u=Math[u>=1?"floor":"ceil"](u/i),r.settings.normalizeOffset&&this.getBoundingClientRect){var b=this.getBoundingClientRect();g=n.clientX-b.left,f=n.clientY-b.top}return n.deltaX=h,n.deltaY=u,n.deltaFactor=i,n.offsetX=g,n.offsetY=f,n.deltaMode=0,a.unshift(n,l,h,u),t&&clearTimeout(t),t=setTimeout(c,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function c(){i=null}function d(e,t){return r.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})),function(){var e=this,t=e._,i=Array.prototype,n=Object.prototype,s=Function.prototype,o=i.push,a=i.slice,r=n.toString,l=n.hasOwnProperty,c=Array.isArray,d=Object.keys,h=s.bind,u=Object.create,p=function(){},g=function(e){return e instanceof g?e:this instanceof g?void(this._wrapped=e):new g(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=g),exports._=g):e._=g,g.VERSION="1.8.3";var f=function(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,s){return e.call(t,i,n,s)};case 4:return function(i,n,s,o){return e.call(t,i,n,s,o)}}return function(){return e.apply(t,arguments)}},m=function(e,t,i){return null==e?g.identity:g.isFunction(e)?f(e,t,i):g.isObject(e)?g.matcher(e):g.property(e)};g.iteratee=function(e,t){return m(e,t,1/0)};var v=function(e,t){return function(i){var n=arguments.length;if(n<2||null==i)return i;for(var s=1;s<n;s++)for(var o=arguments[s],a=e(o),r=a.length,l=0;l<r;l++){var c=a[l];t&&void 0!==i[c]||(i[c]=o[c])}return i}},b=function(e){if(!g.isObject(e))return{};if(u)return u(e);p.prototype=e;var t=new p;return p.prototype=null,t},y=function(e){return function(t){return null==t?void 0:t[e]}},S=Math.pow(2,53)-1,w=y("length"),E=function(e){var t=w(e);return"number"==typeof t&&t>=0&&t<=S};function T(e){function t(t,i,n,s,o,a){for(;o>=0&&o<a;o+=e){var r=s?s[o]:o;n=i(n,t[r],r,t)}return n}return function(i,n,s,o){n=f(n,o,4);var a=!E(i)&&g.keys(i),r=(a||i).length,l=e>0?0:r-1;return arguments.length<3&&(s=i[a?a[l]:l],l+=e),t(i,n,s,a,l,r)}}g.each=g.forEach=function(e,t,i){var n,s;if(t=f(t,i),E(e))for(n=0,s=e.length;n<s;n++)t(e[n],n,e);else{var o=g.keys(e);for(n=0,s=o.length;n<s;n++)t(e[o[n]],o[n],e)}return e},g.map=g.collect=function(e,t,i){t=m(t,i);for(var n=!E(e)&&g.keys(e),s=(n||e).length,o=Array(s),a=0;a<s;a++){var r=n?n[a]:a;o[a]=t(e[r],r,e)}return o},g.reduce=g.foldl=g.inject=T(1),g.reduceRight=g.foldr=T(-1),g.find=g.detect=function(e,t,i){var n;if(void 0!==(n=E(e)?g.findIndex(e,t,i):g.findKey(e,t,i))&&-1!==n)return e[n]},g.filter=g.select=function(e,t,i){var n=[];return t=m(t,i),g.each(e,(function(e,i,s){t(e,i,s)&&n.push(e)})),n},g.reject=function(e,t,i){return g.filter(e,g.negate(m(t)),i)},g.every=g.all=function(e,t,i){t=m(t,i);for(var n=!E(e)&&g.keys(e),s=(n||e).length,o=0;o<s;o++){var a=n?n[o]:o;if(!t(e[a],a,e))return!1}return!0},g.some=g.any=function(e,t,i){t=m(t,i);for(var n=!E(e)&&g.keys(e),s=(n||e).length,o=0;o<s;o++){var a=n?n[o]:o;if(t(e[a],a,e))return!0}return!1},g.contains=g.includes=g.include=function(e,t,i,n){return E(e)||(e=g.values(e)),("number"!=typeof i||n)&&(i=0),g.indexOf(e,t,i)>=0},g.invoke=function(e,t){var i=a.call(arguments,2),n=g.isFunction(t);return g.map(e,(function(e){var s=n?t:e[t];return null==s?s:s.apply(e,i)}))},g.pluck=function(e,t){return g.map(e,g.property(t))},g.where=function(e,t){return g.filter(e,g.matcher(t))},g.findWhere=function(e,t){return g.find(e,g.matcher(t))},g.max=function(e,t,i){var n,s,o=-1/0,a=-1/0;if(null==t&&null!=e)for(var r=0,l=(e=E(e)?e:g.values(e)).length;r<l;r++)(n=e[r])>o&&(o=n);else t=m(t,i),g.each(e,(function(e,i,n){((s=t(e,i,n))>a||s===-1/0&&o===-1/0)&&(o=e,a=s)}));return o},g.min=function(e,t,i){var n,s,o=1/0,a=1/0;if(null==t&&null!=e)for(var r=0,l=(e=E(e)?e:g.values(e)).length;r<l;r++)(n=e[r])<o&&(o=n);else t=m(t,i),g.each(e,(function(e,i,n){((s=t(e,i,n))<a||s===1/0&&o===1/0)&&(o=e,a=s)}));return o},g.shuffle=function(e){for(var t,i=E(e)?e:g.values(e),n=i.length,s=Array(n),o=0;o<n;o++)(t=g.random(0,o))!==o&&(s[o]=s[t]),s[t]=i[o];return s},g.sample=function(e,t,i){return null==t||i?(E(e)||(e=g.values(e)),e[g.random(e.length-1)]):g.shuffle(e).slice(0,Math.max(0,t))},g.sortBy=function(e,t,i){return t=m(t,i),g.pluck(g.map(e,(function(e,i,n){return{value:e,index:i,criteria:t(e,i,n)}})).sort((function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return e.index-t.index})),"value")};var _=function(e){return function(t,i,n){var s={};return i=m(i,n),g.each(t,(function(n,o){var a=i(n,o,t);e(s,n,a)})),s}};g.groupBy=_((function(e,t,i){g.has(e,i)?e[i].push(t):e[i]=[t]})),g.indexBy=_((function(e,t,i){e[i]=t})),g.countBy=_((function(e,t,i){g.has(e,i)?e[i]++:e[i]=1})),g.toArray=function(e){return e?g.isArray(e)?a.call(e):E(e)?g.map(e,g.identity):g.values(e):[]},g.size=function(e){return null==e?0:E(e)?e.length:g.keys(e).length},g.partition=function(e,t,i){t=m(t,i);var n=[],s=[];return g.each(e,(function(e,i,o){(t(e,i,o)?n:s).push(e)})),[n,s]},g.first=g.head=g.take=function(e,t,i){if(null!=e)return null==t||i?e[0]:g.initial(e,e.length-t)},g.initial=function(e,t,i){return a.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))},g.last=function(e,t,i){if(null!=e)return null==t||i?e[e.length-1]:g.rest(e,Math.max(0,e.length-t))},g.rest=g.tail=g.drop=function(e,t,i){return a.call(e,null==t||i?1:t)},g.compact=function(e){return g.filter(e,g.identity)};var P=function(e,t,i,n){for(var s=[],o=0,a=n||0,r=w(e);a<r;a++){var l=e[a];if(E(l)&&(g.isArray(l)||g.isArguments(l))){t||(l=P(l,t,i));var c=0,d=l.length;for(s.length+=d;c<d;)s[o++]=l[c++]}else i||(s[o++]=l)}return s};function I(e){return function(t,i,n){i=m(i,n);for(var s=w(t),o=e>0?0:s-1;o>=0&&o<s;o+=e)if(i(t[o],o,t))return o;return-1}}function F(e,t,i){return function(n,s,o){var r=0,l=w(n);if("number"==typeof o)e>0?r=o>=0?o:Math.max(o+l,r):l=o>=0?Math.min(o+1,l):o+l+1;else if(i&&o&&l)return n[o=i(n,s)]===s?o:-1;if(s!=s)return(o=t(a.call(n,r,l),g.isNaN))>=0?o+r:-1;for(o=e>0?r:l-1;o>=0&&o<l;o+=e)if(n[o]===s)return o;return-1}}g.flatten=function(e,t){return P(e,t,!1)},g.without=function(e){return g.difference(e,a.call(arguments,1))},g.uniq=g.unique=function(e,t,i,n){g.isBoolean(t)||(n=i,i=t,t=!1),null!=i&&(i=m(i,n));for(var s=[],o=[],a=0,r=w(e);a<r;a++){var l=e[a],c=i?i(l,a,e):l;t?(a&&o===c||s.push(l),o=c):i?g.contains(o,c)||(o.push(c),s.push(l)):g.contains(s,l)||s.push(l)}return s},g.union=function(){return g.uniq(P(arguments,!0,!0))},g.intersection=function(e){for(var t=[],i=arguments.length,n=0,s=w(e);n<s;n++){var o=e[n];if(!g.contains(t,o)){for(var a=1;a<i&&g.contains(arguments[a],o);a++);a===i&&t.push(o)}}return t},g.difference=function(e){var t=P(arguments,!0,!0,1);return g.filter(e,(function(e){return!g.contains(t,e)}))},g.zip=function(){return g.unzip(arguments)},g.unzip=function(e){for(var t=e&&g.max(e,w).length||0,i=Array(t),n=0;n<t;n++)i[n]=g.pluck(e,n);return i},g.object=function(e,t){for(var i={},n=0,s=w(e);n<s;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},g.findIndex=I(1),g.findLastIndex=I(-1),g.sortedIndex=function(e,t,i,n){for(var s=(i=m(i,n,1))(t),o=0,a=w(e);o<a;){var r=Math.floor((o+a)/2);i(e[r])<s?o=r+1:a=r}return o},g.indexOf=F(1,g.findIndex,g.sortedIndex),g.lastIndexOf=F(-1,g.findLastIndex),g.range=function(e,t,i){null==t&&(t=e||0,e=0),i=i||1;for(var n=Math.max(Math.ceil((t-e)/i),0),s=Array(n),o=0;o<n;o++,e+=i)s[o]=e;return s};var C=function(e,t,i,n,s){if(!(n instanceof t))return e.apply(i,s);var o=b(e.prototype),a=e.apply(o,s);return g.isObject(a)?a:o};g.bind=function(e,t){if(h&&e.bind===h)return h.apply(e,a.call(arguments,1));if(!g.isFunction(e))throw new TypeError("Bind must be called on a function");var i=a.call(arguments,2),n=function(){return C(e,n,t,this,i.concat(a.call(arguments)))};return n},g.partial=function(e){var t=a.call(arguments,1),i=function(){for(var n=0,s=t.length,o=Array(s),a=0;a<s;a++)o[a]=t[a]===g?arguments[n++]:t[a];for(;n<arguments.length;)o.push(arguments[n++]);return C(e,i,this,this,o)};return i},g.bindAll=function(e){var t,i,n=arguments.length;if(n<=1)throw new Error("bindAll must be passed function names");for(t=1;t<n;t++)e[i=arguments[t]]=g.bind(e[i],e);return e},g.memoize=function(e,t){var i=function(n){var s=i.cache,o=""+(t?t.apply(this,arguments):n);return g.has(s,o)||(s[o]=e.apply(this,arguments)),s[o]};return i.cache={},i},g.delay=function(e,t){var i=a.call(arguments,2);return setTimeout((function(){return e.apply(null,i)}),t)},g.defer=g.partial(g.delay,g,1),g.throttle=function(e,t,i){var n,s,o,a=null,r=0;i||(i={});var l=function(){r=!1===i.leading?0:g.now(),a=null,o=e.apply(n,s),a||(n=s=null)};return function(){var c=g.now();r||!1!==i.leading||(r=c);var d=t-(c-r);return n=this,s=arguments,d<=0||d>t?(a&&(clearTimeout(a),a=null),r=c,o=e.apply(n,s),a||(n=s=null)):a||!1===i.trailing||(a=setTimeout(l,d)),o}},g.debounce=function(e,t,i){var n,s,o,a,r,l=function(){var c=g.now()-a;c<t&&c>=0?n=setTimeout(l,t-c):(n=null,i||(r=e.apply(o,s),n||(o=s=null)))};return function(){o=this,s=arguments,a=g.now();var c=i&&!n;return n||(n=setTimeout(l,t)),c&&(r=e.apply(o,s),o=s=null),r}},g.wrap=function(e,t){return g.partial(t,e)},g.negate=function(e){return function(){return!e.apply(this,arguments)}},g.compose=function(){var e=arguments,t=e.length-1;return function(){for(var i=t,n=e[t].apply(this,arguments);i--;)n=e[i].call(this,n);return n}},g.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},g.before=function(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=null),i}},g.once=g.partial(g.before,2);var M=!{toString:null}.propertyIsEnumerable("toString"),k=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function x(e,t){var i=k.length,s=e.constructor,o=g.isFunction(s)&&s.prototype||n,a="constructor";for(g.has(e,a)&&!g.contains(t,a)&&t.push(a);i--;)(a=k[i])in e&&e[a]!==o[a]&&!g.contains(t,a)&&t.push(a)}g.keys=function(e){if(!g.isObject(e))return[];if(d)return d(e);var t=[];for(var i in e)g.has(e,i)&&t.push(i);return M&&x(e,t),t},g.allKeys=function(e){if(!g.isObject(e))return[];var t=[];for(var i in e)t.push(i);return M&&x(e,t),t},g.values=function(e){for(var t=g.keys(e),i=t.length,n=Array(i),s=0;s<i;s++)n[s]=e[t[s]];return n},g.mapObject=function(e,t,i){t=m(t,i);for(var n,s=g.keys(e),o=s.length,a={},r=0;r<o;r++)a[n=s[r]]=t(e[n],n,e);return a},g.pairs=function(e){for(var t=g.keys(e),i=t.length,n=Array(i),s=0;s<i;s++)n[s]=[t[s],e[t[s]]];return n},g.invert=function(e){for(var t={},i=g.keys(e),n=0,s=i.length;n<s;n++)t[e[i[n]]]=i[n];return t},g.functions=g.methods=function(e){var t=[];for(var i in e)g.isFunction(e[i])&&t.push(i);return t.sort()},g.extend=v(g.allKeys),g.extendOwn=g.assign=v(g.keys),g.findKey=function(e,t,i){t=m(t,i);for(var n,s=g.keys(e),o=0,a=s.length;o<a;o++)if(t(e[n=s[o]],n,e))return n},g.pick=function(e,t,i){var n,s,o={},a=e;if(null==a)return o;g.isFunction(t)?(s=g.allKeys(a),n=f(t,i)):(s=P(arguments,!1,!1,1),n=function(e,t,i){return t in i},a=Object(a));for(var r=0,l=s.length;r<l;r++){var c=s[r],d=a[c];n(d,c,a)&&(o[c]=d)}return o},g.omit=function(e,t,i){if(g.isFunction(t))t=g.negate(t);else{var n=g.map(P(arguments,!1,!1,1),String);t=function(e,t){return!g.contains(n,t)}}return g.pick(e,t,i)},g.defaults=v(g.allKeys,!0),g.create=function(e,t){var i=b(e);return t&&g.extendOwn(i,t),i},g.clone=function(e){return g.isObject(e)?g.isArray(e)?e.slice():g.extend({},e):e},g.tap=function(e,t){return t(e),e},g.isMatch=function(e,t){var i=g.keys(t),n=i.length;if(null==e)return!n;for(var s=Object(e),o=0;o<n;o++){var a=i[o];if(t[a]!==s[a]||!(a in s))return!1}return!0};var L=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof g&&(e=e._wrapped),t instanceof g&&(t=t._wrapped);var s=r.call(e);if(s!==r.call(t))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}var o="[object Array]"===s;if(!o){if("object"!=typeof e||"object"!=typeof t)return!1;var a=e.constructor,l=t.constructor;if(a!==l&&!(g.isFunction(a)&&a instanceof a&&g.isFunction(l)&&l instanceof l)&&"constructor"in e&&"constructor"in t)return!1}n=n||[];for(var c=(i=i||[]).length;c--;)if(i[c]===e)return n[c]===t;if(i.push(e),n.push(t),o){if((c=e.length)!==t.length)return!1;for(;c--;)if(!L(e[c],t[c],i,n))return!1}else{var d,h=g.keys(e);if(c=h.length,g.keys(t).length!==c)return!1;for(;c--;)if(d=h[c],!g.has(t,d)||!L(e[d],t[d],i,n))return!1}return i.pop(),n.pop(),!0};g.isEqual=function(e,t){return L(e,t)},g.isEmpty=function(e){return null==e||(E(e)&&(g.isArray(e)||g.isString(e)||g.isArguments(e))?0===e.length:0===g.keys(e).length)},g.isElement=function(e){return!(!e||1!==e.nodeType)},g.isArray=c||function(e){return"[object Array]"===r.call(e)},g.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},g.each(["Arguments","Function","String","Number","Date","RegExp","Error"],(function(e){g["is"+e]=function(t){return r.call(t)==="[object "+e+"]"}})),g.isArguments(arguments)||(g.isArguments=function(e){return g.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(g.isFunction=function(e){return"function"==typeof e||!1}),g.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},g.isNaN=function(e){return g.isNumber(e)&&e!==+e},g.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===r.call(e)},g.isNull=function(e){return null===e},g.isUndefined=function(e){return void 0===e},g.has=function(e,t){return null!=e&&l.call(e,t)},g.noConflict=function(){return e._=t,this},g.identity=function(e){return e},g.constant=function(e){return function(){return e}},g.noop=function(){},g.property=y,g.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},g.matcher=g.matches=function(e){return e=g.extendOwn({},e),function(t){return g.isMatch(t,e)}},g.times=function(e,t,i){var n=Array(Math.max(0,e));t=f(t,i,1);for(var s=0;s<e;s++)n[s]=t(s);return n},g.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},g.now=Date.now||function(){return(new Date).getTime()};var A={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},O=g.invert(A),D=function(e){var t=function(t){return e[t]},i="(?:"+g.keys(e).join("|")+")",n=RegExp(i),s=RegExp(i,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(s,t):e}};g.escape=D(A),g.unescape=D(O),g.result=function(e,t,i){var n=null==e?void 0:e[t];return void 0===n&&(n=i),g.isFunction(n)?n.call(e):n};var W=0;g.uniqueId=function(e){var t=++W+"";return e?e+t:t},g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\u2028|\u2029/g,H=function(e){return"\\"+R[e]};g.template=function(e,t,i){!t&&i&&(t=i),t=g.defaults({},t,g.templateSettings);var n=RegExp([(t.escape||N).source,(t.interpolate||N).source,(t.evaluate||N).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(n,(function(t,i,n,a,r){return o+=e.slice(s,r).replace(B,H),s=r+t.length,i?o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),t})),o+="';\n",t.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=new Function(t.variable||"obj","_",o)}catch(e){throw e.source=o,e}var r=function(e){return a.call(this,e,g)},l=t.variable||"obj";return r.source="function("+l+"){\n"+o+"}",r},g.chain=function(e){var t=g(e);return t._chain=!0,t};var U=function(e,t){return e._chain?g(t).chain():t};g.mixin=function(e){g.each(g.functions(e),(function(t){var i=g[t]=e[t];g.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),U(this,i.apply(g,e))}}))},g.mixin(g),g.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=i[e];g.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0],U(this,i)}})),g.each(["concat","join","slice"],(function(e){var t=i[e];g.prototype[e]=function(){return U(this,t.apply(this._wrapped,arguments))}})),g.prototype.value=function(){return this._wrapped},g.prototype.valueOf=g.prototype.toJSON=g.prototype.value,g.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],(function(){return g}))}.call(this),function(e){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],(function(i,n,s){t.Backbone=e(t,s,i,n)}));else if("undefined"!=typeof exports){var i,n=require("underscore");try{i=require("jquery")}catch(e){}e(t,exports,n,i)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}((function(e,t,i,n){var s=e.Backbone,o=Array.prototype.slice;t.VERSION="1.3.3",t.$=n,t.noConflict=function(){return e.Backbone=s,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=function(e,t,n){i.each(t,(function(t,s){i[s]&&(e.prototype[s]=function(e,t,n){switch(e){case 1:return function(){return i[t](this[n])};case 2:return function(e){return i[t](this[n],e)};case 3:return function(e,s){return i[t](this[n],r(e,this),s)};case 4:return function(e,s,o){return i[t](this[n],r(e,this),s,o)};default:return function(){var e=o.call(arguments);return e.unshift(this[n]),i[t].apply(i,e)}}}(t,s,n))}))},r=function(e,t){return i.isFunction(e)?e:i.isObject(e)&&!t._isModel(e)?l(e):i.isString(e)?function(t){return t.get(e)}:e},l=function(e){var t=i.matches(e);return function(e){return t(e.attributes)}},c=t.Events={},d=/\s+/,h=function(e,t,n,s,o){var a,r=0;if(n&&"object"==typeof n){void 0!==s&&"context"in o&&void 0===o.context&&(o.context=s);for(a=i.keys(n);r<a.length;r++)t=h(e,t,a[r],n[a[r]],o)}else if(n&&d.test(n))for(a=n.split(d);r<a.length;r++)t=e(t,a[r],s,o);else t=e(t,n,s,o);return t};c.on=function(e,t,i){return u(this,e,t,i)};var u=function(e,t,i,n,s){(e._events=h(p,e._events||{},t,i,{context:n,ctx:e,listening:s}),s)&&((e._listeners||(e._listeners={}))[s.id]=s);return e};c.listenTo=function(e,t,n){if(!e)return this;var s=e._listenId||(e._listenId=i.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),a=o[s];if(!a){var r=this._listenId||(this._listenId=i.uniqueId("l"));a=o[s]={obj:e,objId:s,id:r,listeningTo:o,count:0}}return u(e,t,n,this,a),this};var p=function(e,t,i,n){if(i){var s=e[t]||(e[t]=[]),o=n.context,a=n.ctx,r=n.listening;r&&r.count++,s.push({callback:i,context:o,ctx:o||a,listening:r})}return e};c.off=function(e,t,i){return this._events?(this._events=h(g,this._events,e,t,{context:i,listeners:this._listeners}),this):this},c.stopListening=function(e,t,n){var s=this._listeningTo;if(!s)return this;for(var o=e?[e._listenId]:i.keys(s),a=0;a<o.length;a++){var r=s[o[a]];if(!r)break;r.obj.off(t,n,this)}return this};var g=function(e,t,n,s){if(e){var o,a=0,r=s.context,l=s.listeners;if(t||n||r){for(var c=t?[t]:i.keys(e);a<c.length;a++){var d=e[t=c[a]];if(!d)break;for(var h=[],u=0;u<d.length;u++){var p=d[u];n&&n!==p.callback&&n!==p.callback._callback||r&&r!==p.context?h.push(p):(o=p.listening)&&0==--o.count&&(delete l[o.id],delete o.listeningTo[o.objId])}h.length?e[t]=h:delete e[t]}return e}for(var g=i.keys(l);a<g.length;a++)delete l[(o=l[g[a]]).id],delete o.listeningTo[o.objId]}};c.once=function(e,t,n){var s=h(f,{},e,t,i.bind(this.off,this));return"string"==typeof e&&null==n&&(t=void 0),this.on(s,t,n)},c.listenToOnce=function(e,t,n){var s=h(f,{},t,n,i.bind(this.stopListening,this,e));return this.listenTo(e,s)};var f=function(e,t,n,s){if(n){var o=e[t]=i.once((function(){s(t,o),n.apply(this,arguments)}));o._callback=n}return e};c.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),i=Array(t),n=0;n<t;n++)i[n]=arguments[n+1];return h(m,this._events,e,void 0,i),this};var m=function(e,t,i,n){if(e){var s=e[t],o=e.all;s&&o&&(o=o.slice()),s&&v(s,n),o&&v(o,[t].concat(n))}return e},v=function(e,t){var i,n=-1,s=e.length,o=t[0],a=t[1],r=t[2];switch(t.length){case 0:for(;++n<s;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o);return;case 2:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o,a);return;case 3:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o,a,r);return;default:for(;++n<s;)(i=e[n]).callback.apply(i.ctx,t);return}};c.bind=c.on,c.unbind=c.off,i.extend(t,c);var b=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{});var s=i.result(this,"defaults");n=i.defaults(i.extend({},s,n),s),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(b.prototype,c,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!i.iteratee(e,this)(this.attributes)},set:function(e,t,n){if(null==e)return this;var s;if("object"==typeof e?(s=e,n=t):(s={})[e]=t,n||(n={}),!this._validate(s,n))return!1;var o=n.unset,a=n.silent,r=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var c=this.attributes,d=this.changed,h=this._previousAttributes;for(var u in s)t=s[u],i.isEqual(c[u],t)||r.push(u),i.isEqual(h[u],t)?delete d[u]:d[u]=t,o?delete c[u]:c[u]=t;if(this.idAttribute in s&&(this.id=this.get(this.idAttribute)),!a){r.length&&(this._pending=n);for(var p=0;p<r.length;p++)this.trigger("change:"+r[p],this,c[r[p]],n)}if(l)return this;if(!a)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&i.clone(this.changed);var t=this._changing?this._previousAttributes:this.attributes,n={};for(var s in e){var o=e[s];i.isEqual(t[s],o)||(n[s]=o)}return!!i.size(n)&&n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=i.extend({parse:!0},e);var t=this,n=e.success;return e.success=function(i){var s=e.parse?t.parse(i,e):i;if(!t.set(s,e))return!1;n&&n.call(e.context,t,i,e),t.trigger("sync",t,i,e)},N(this,e),this.sync("read",this,e)},save:function(e,t,n){var s;null==e||"object"==typeof e?(s=e,n=t):(s={})[e]=t;var o=(n=i.extend({validate:!0,parse:!0},n)).wait;if(s&&!o){if(!this.set(s,n))return!1}else if(!this._validate(s,n))return!1;var a=this,r=n.success,l=this.attributes;n.success=function(e){a.attributes=l;var t=n.parse?a.parse(e,n):e;if(o&&(t=i.extend({},s,t)),t&&!a.set(t,n))return!1;r&&r.call(n.context,a,e,n),a.trigger("sync",a,e,n)},N(this,n),s&&o&&(this.attributes=i.extend({},l,s));var c=this.isNew()?"create":n.patch?"patch":"update";"patch"!==c||n.attrs||(n.attrs=s);var d=this.sync(c,this,n);return this.attributes=l,d},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,s=e.wait,o=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(i){s&&o(),n&&n.call(e.context,t,i,e),t.isNew()||t.trigger("sync",t,i,e)};var a=!1;return this.isNew()?i.defer(e.success):(N(this,e),a=this.sync("delete",this,e)),s||o(),a},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||W();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1)}});a(b,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var y=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},S={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1},E=function(e,t,i){i=Math.min(Math.max(i,0),e.length);var n,s=Array(e.length-i),o=t.length;for(n=0;n<s.length;n++)s[n]=e[n+i];for(n=0;n<o;n++)e[n+i]=t[n];for(n=0;n<s.length;n++)e[n+o+i]=s[n]};i.extend(y.prototype,c,{model:b,initialize:function(){},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,w))},remove:function(e,t){t=i.extend({},t);var n=!i.isArray(e);e=n?[e]:e.slice();var s=this._removeModels(e,t);return!t.silent&&s.length&&(t.changes={added:[],merged:[],removed:s},this.trigger("update",this,t)),n?s[0]:s},set:function(e,t){if(null!=e){(t=i.extend({},S,t)).parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var n=!i.isArray(e);e=n?[e]:e.slice();var s=t.at;null!=s&&(s=+s),s>this.length&&(s=this.length),s<0&&(s+=this.length+1);var o,a,r=[],l=[],c=[],d=[],h={},u=t.add,p=t.merge,g=t.remove,f=!1,m=this.comparator&&null==s&&!1!==t.sort,v=i.isString(this.comparator)?this.comparator:null;for(a=0;a<e.length;a++){o=e[a];var b=this.get(o);if(b){if(p&&o!==b){var y=this._isModel(o)?o.attributes:o;t.parse&&(y=b.parse(y,t)),b.set(y,t),c.push(b),m&&!f&&(f=b.hasChanged(v))}h[b.cid]||(h[b.cid]=!0,r.push(b)),e[a]=b}else u&&(o=e[a]=this._prepareModel(o,t))&&(l.push(o),this._addReference(o,t),h[o.cid]=!0,r.push(o))}if(g){for(a=0;a<this.length;a++)h[(o=this.models[a]).cid]||d.push(o);d.length&&this._removeModels(d,t)}var w=!1,T=!m&&u&&g;if(r.length&&T?(w=this.length!==r.length||i.some(this.models,(function(e,t){return e!==r[t]})),this.models.length=0,E(this.models,r,0),this.length=this.models.length):l.length&&(m&&(f=!0),E(this.models,l,null==s?this.length:s),this.length=this.models.length),f&&this.sort({silent:!0}),!t.silent){for(a=0;a<l.length;a++)null!=s&&(t.index=s+a),(o=l[a]).trigger("add",o,this,t);(f||w)&&this.trigger("sort",this,t),(l.length||d.length||c.length)&&(t.changes={added:l,removed:d,merged:c},this.trigger("update",this,t))}return n?e[0]:e}},reset:function(e,t){t=t?i.clone(t):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return o.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.modelId(e.attributes||e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var n=t.length;return i.isFunction(t)&&(t=i.bind(t,this)),1===n||i.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){var t=(e=i.extend({parse:!0},e)).success,n=this;return e.success=function(i){var s=e.reset?"reset":"set";n[s](i,e),t&&t.call(e.context,n,i,e),n.trigger("sync",n,i,e)},N(this,e),this.sync("read",this,e)},create:function(e,t){var n=(t=t?i.clone(t):{}).wait;if(!(e=this._prepareModel(e,t)))return!1;n||this.add(e,t);var s=this,o=t.success;return t.success=function(e,t,i){n&&s.add(e,i),o&&o.call(i.context,e,t,i)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;(t=t?i.clone(t):{}).collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_removeModels:function(e,t){for(var i=[],n=0;n<e.length;n++){var s=this.get(e[n]);if(s){var o=this.indexOf(s);this.models.splice(o,1),this.length--,delete this._byId[s.cid];var a=this.modelId(s.attributes);null!=a&&delete this._byId[a],t.silent||(t.index=o,s.trigger("remove",s,this,t)),i.push(s),this._removeReference(s,t)}}return i},_isModel:function(e){return e instanceof b},_addReference:function(e,t){this._byId[e.cid]=e;var i=this.modelId(e.attributes);null!=i&&(this._byId[i]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var i=this.modelId(e.attributes);null!=i&&delete this._byId[i],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){if(t){if(("add"===e||"remove"===e)&&i!==this)return;if("destroy"===e&&this.remove(t,n),"change"===e){var s=this.modelId(t.previousAttributes()),o=this.modelId(t.attributes);s!==o&&(null!=s&&delete this._byId[s],null!=o&&(this._byId[o]=t))}}this.trigger.apply(this,arguments)}});a(y,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models");var T=t.View=function(e){this.cid=i.uniqueId("view"),i.extend(this,i.pick(e,P)),this._ensureElement(),this.initialize.apply(this,arguments)},_=/^(\S+)\s*(.*)$/,P=["model","collection","el","id","attributes","className","tagName","events"];i.extend(T.prototype,c,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=i.result(this,"events")),!e)return this;for(var t in this.undelegateEvents(),e){var n=e[t];if(i.isFunction(n)||(n=this[n]),n){var s=t.match(_);this.delegate(s[1],s[2],i.bind(n,this))}}return this},delegate:function(e,t,i){return this.$el.on(e+".delegateEvents"+this.cid,t,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,i){return this.$el.off(e+".delegateEvents"+this.cid,t,i),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,n,s){var o=I[e];i.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:o,dataType:"json"};if(s.url||(a.url=i.result(n,"url")||W()),null!=s.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",a.data=JSON.stringify(s.attrs||n.toJSON(s))),s.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),s.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",s.emulateJSON&&(a.data._method=o);var r=s.beforeSend;s.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",o),r)return r.apply(this,arguments)}}"GET"===a.type||s.emulateJSON||(a.processData=!1);var l=s.error;s.error=function(e,t,i){s.textStatus=t,s.errorThrown=i,l&&l.call(s.context,e,t,i)};var c=s.xhr=t.ajax(i.extend(a,s));return n.trigger("request",n,c,s),c};var I={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var F=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,M=/(\(\?)?:\w+/g,k=/\*\w+/g,x=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(F.prototype,c,{initialize:function(){},route:function(e,n,s){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(s=n,n=""),s||(s=this[n]);var o=this;return t.history.route(e,(function(i){var a=o._extractParameters(e,i);!1!==o.execute(s,a,n)&&(o.trigger.apply(o,["route:"+n].concat(a)),o.trigger("route",n,a),t.history.trigger("route",o,n,a))})),this},execute:function(e,t,i){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(x,"\\$&").replace(C,"(?:$1)?").replace(M,(function(e,t){return t?e:"([^/?]+)"})).replace(k,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,(function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null}))}});var L=t.History=function(){this.handlers=[],this.checkUrl=i.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},A=/^[#\/]|\s+$/g,O=/^\/+|\/+$/g,D=/#.*$/;L.started=!1,i.extend(L.prototype,c,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(A,"")},start:function(e){if(L.started)throw new Error("Backbone.history has already been started");if(L.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(O,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,s=n.insertBefore(this.iframe,n.firstChild).contentWindow;s.document.open(),s.document.close(),s.location.hash="#"+this.fragment}var o=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),L.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),i.some(this.handlers,(function(t){if(t.route.test(e))return t.callback(e),!0})))},navigate:function(e,t){if(!L.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");var i=this.root;""!==e&&"?"!==e.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+e;if(e=this.decodeFragment(e.replace(D,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var s=this.iframe.contentWindow;t.replace||(s.document.open(),s.document.close()),this._updateHash(s.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new L;b.extend=y.extend=F.extend=T.extend=L.extend=function(e,t){var n,s=this;return n=e&&i.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},i.extend(n,s,t),n.prototype=i.create(s.prototype,e),n.prototype.constructor=n,n.__super__=s.prototype,n};var W=function(){throw new Error('A "url" property or function must be specified')},N=function(e,t){var i=t.error;t.error=function(n){i&&i.call(t.context,e,n,t),e.trigger("error",e,n,t)}};return t})),function(e){"use strict";"function"==typeof define&&define.amd?define(["underscore","backbone"],e):e(_,Backbone)}((function(e,t){"use strict";var i,n={},s=t.View.prototype.delegateEvents,o=t.View.prototype.undelegateEvents;return t.Mediator={subscribe:function(e,t,i,s){n[e]||(n[e]=[]),n[e].push({fn:t,context:i||this,once:s})},publish:function(e){if(n[e])for(var i,s=[].slice.call(arguments,1),o=0;o<n[e].length;o++)(i=n[e][o]).fn.apply(i.context,s),i.once&&(t.Mediator.unsubscribe(e,i.fn,i.context),o--)},unsubscribe:function(e,t,i){if(n[e])for(var s,o=0;o<n[e].length;o++)(s=n[e][o]).fn===t&&s.context===i&&(n[e].splice(o,1),o--)},subscribeOnce:function(e,i,n){t.Mediator.subscribe(e,i,n,!0)}},i={delegateEvents:function(){s.apply(this,arguments),this.setSubscriptions()},undelegateEvents:function(){o.apply(this,arguments),this.unsetSubscriptions()},subscriptions:{},setSubscriptions:function(i){i&&e.extend(this.subscriptions||{},i),(i=i||this.subscriptions)&&!e.isEmpty(i)&&(this.unsetSubscriptions(i),e.each(i,(function(i,n){var s;i.$once&&(i=i.$once,s=!0),e.isString(i)&&(i=this[i]),t.Mediator.subscribe(n,i,this,s)}),this))},unsetSubscriptions:function(i){(i=i||this.subscriptions)&&!e.isEmpty(i)&&e.each(i,(function(i,n){e.isString(i)&&(i=this[i]),t.Mediator.unsubscribe(n,i.$once||i,this)}),this)}},e.extend(t.View.prototype,i),e.extend(t.Mediator,{pub:t.Mediator.publish,sub:t.Mediator.subscribe}),t})),function(e){var t,i,n={pos:[-260,-260]},s=3,o=document,a=o.documentElement,r=o.body;function l(){this===n.elem&&(n.pos=[-260,-260],n.elem=!1,s=3)}e.event.special.mwheelIntent={setup:function(){var t=e(this).bind("mousewheel",e.event.special.mwheelIntent.handler);return this!==o&&this!==a&&this!==r&&t.bind("mouseleave",l),t=null,!0},teardown:function(){return e(this).unbind("mousewheel",e.event.special.mwheelIntent.handler).unbind("mouseleave",l),!0},handler:function(o,a){var r=[o.clientX,o.clientY];if(this===n.elem||Math.abs(n.pos[0]-r[0])>s||Math.abs(n.pos[1]-r[1])>s)return n.elem=this,n.pos=r,s=250,clearTimeout(i),i=setTimeout((function(){s=10}),200),clearTimeout(t),t=setTimeout((function(){s=3}),1500),o=e.extend({},o,{type:"mwheelIntent"}),(e.event.dispatch||e.event.handle).apply(this,arguments)}},e.fn.extend({mwheelIntent:function(e){return e?this.bind("mwheelIntent",e):this.trigger("mwheelIntent")},unmwheelIntent:function(e){return this.unbind("mwheelIntent",e)}}),e((function(){r=o.body,e(o).bind("mwheelIntent.mwheelIntentDefault",e.noop)}))}(jQuery),
/*!
 * jScrollPane - v2.0.22 - 2015-04-25
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2014 Kelvin Luck
 * Dual licensed under the MIT or GPL licenses.
 */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}((function(e){e.fn.jScrollPane=function(t){function i(t,i){var n,s,o,a,r,l,c,d,h,u,p,g,f,m,v,b,y,S,w,E,T,_,P,I,F,C,M,k,x,L,A,O,D,W,N=this,R=!0,B=!0,H=!1,U=!1,V=t.clone(!1,!1).empty(),$=e.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";function j(i){var E,R,B,H,U,V,re,le,ce,de,he,ue,pe,ge,fe=!1,me=!1;if(n=i,void 0===s)U=t.scrollTop(),V=t.scrollLeft(),t.css({overflow:"hidden",padding:0}),o=t.innerWidth()+D,a=t.innerHeight(),t.width(o),s=e('<div class="jspPane" />').css("padding",O).append(t.children()),r=e('<div class="jspContainer" />').css({width:o+"px",height:a+"px"}).append(s).appendTo(t);else{if(t.css("width",""),fe=n.stickToBottom&&((le=c-a)>20&&le-oe()<10),me=n.stickToRight&&((re=l-o)>20&&re-se()<10),(H=t.innerWidth()+D!=o||t.outerHeight()!=a)&&(o=t.innerWidth()+D,a=t.innerHeight(),r.css({width:o+"px",height:a+"px"})),!H&&W==l&&s.outerHeight()==c)return void t.width(o);W=l,s.css("width",""),t.width(o),r.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}s.css("overflow","auto"),l=i.contentWidth?i.contentWidth:s[0].scrollWidth,c=s[0].scrollHeight,s.css("overflow",""),u=(h=c/a)>1,(p=(d=l/o)>1)||u?(t.addClass("jspScrollable"),(E=n.maintainPosition&&(m||y))&&(R=se(),B=oe()),u&&(r.append(e('<div class="jspVerticalBar" />').append(e('<div class="jspCap jspCapTop" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragTop" />'),e('<div class="jspDragBottom" />'))),e('<div class="jspCap jspCapBottom" />'))),S=r.find(">.jspVerticalBar"),w=S.find(">.jspTrack"),g=w.find(">.jspDrag"),n.showArrows&&(P=e('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",Y(0,-1)).bind("click.jsp",ae),I=e('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",Y(0,1)).bind("click.jsp",ae),n.arrowScrollOnHover&&(P.bind("mouseover.jsp",Y(0,-1,P)),I.bind("mouseover.jsp",Y(0,1,I))),q(w,n.verticalArrowPositions,P,I)),T=a,r.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each((function(){T-=e(this).outerHeight()})),g.hover((function(){g.addClass("jspHover")}),(function(){g.removeClass("jspHover")})).bind("mousedown.jsp",(function(t){e("html").bind("dragstart.jsp selectstart.jsp",ae),g.addClass("jspActive");var i=t.pageY-g.position().top;return e("html").bind("mousemove.jsp",(function(e){Z(e.pageY-i,!1)})).bind("mouseup.jsp mouseleave.jsp",K),!1})),z()),p&&(r.append(e('<div class="jspHorizontalBar" />').append(e('<div class="jspCap jspCapLeft" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragLeft" />'),e('<div class="jspDragRight" />'))),e('<div class="jspCap jspCapRight" />'))),F=r.find(">.jspHorizontalBar"),C=F.find(">.jspTrack"),v=C.find(">.jspDrag"),n.showArrows&&(x=e('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",Y(-1,0)).bind("click.jsp",ae),L=e('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",Y(1,0)).bind("click.jsp",ae),n.arrowScrollOnHover&&(x.bind("mouseover.jsp",Y(-1,0,x)),L.bind("mouseover.jsp",Y(1,0,L))),q(C,n.horizontalArrowPositions,x,L)),v.hover((function(){v.addClass("jspHover")}),(function(){v.removeClass("jspHover")})).bind("mousedown.jsp",(function(t){e("html").bind("dragstart.jsp selectstart.jsp",ae),v.addClass("jspActive");var i=t.pageX-v.position().left;return e("html").bind("mousemove.jsp",(function(e){Q(e.pageX-i,!1)})).bind("mouseup.jsp mouseleave.jsp",K),!1})),M=r.innerWidth(),G()),function(){if(p&&u){var t=C.outerHeight(),i=w.outerWidth();T-=t,e(F).find(">.jspCap:visible,>.jspArrow").each((function(){M+=e(this).outerWidth()})),M-=i,a-=i,o-=t,C.parent().append(e('<div class="jspCorner" />').css("width",t+"px")),z(),G()}p&&s.width(r.outerWidth()-D+"px");c=s.outerHeight(),h=c/a,p&&((k=Math.ceil(1/d*M))>n.horizontalDragMaxWidth?k=n.horizontalDragMaxWidth:k<n.horizontalDragMinWidth&&(k=n.horizontalDragMinWidth),v.width(k+"px"),b=M-k,ee(y));u&&((_=Math.ceil(1/h*T))>n.verticalDragMaxHeight?_=n.verticalDragMaxHeight:_<n.verticalDragMinHeight&&(_=n.verticalDragMinHeight),g.height(_+"px"),f=T-_,J(m))}(),E&&(ie(me?l-o:R,!1),te(fe?c-a:B,!1)),s.find(":input,a").unbind("focus.jsp").bind("focus.jsp",(function(e){ne(e.target,!1)})),r.unbind($).bind($,(function(e,t,i,s){y||(y=0),m||(m=0);var o=y,a=m,r=e.deltaFactor||n.mouseWheelSpeed;return N.scrollBy(i*r,-s*r,!1),o==y&&a==m})),ge=!1,r.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",(function(e){var t=e.originalEvent.touches[0];ce=se(),de=oe(),he=t.pageX,ue=t.pageY,pe=!1,ge=!0})).bind("touchmove.jsp",(function(e){if(ge){var t=e.originalEvent.touches[0],i=y,n=m;return N.scrollTo(ce+he-t.pageX,de+ue-t.pageY),pe=pe||Math.abs(he-t.pageX)>5||Math.abs(ue-t.pageY)>5,i==y&&n==m}})).bind("touchend.jsp",(function(e){ge=!1})).bind("click.jsp-touchclick",(function(e){if(pe)return pe=!1,!1})),n.enableKeyboardNavigation&&function(){var i,o,l=[];p&&l.push(F[0]),u&&l.push(S[0]),s.bind("focus.jsp",(function(){t.focus()})),t.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",(function(t){if(t.target===this||l.length&&e(t.target).closest(l).length){var n=y,s=m;switch(t.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:i=t.keyCode,d();break;case 35:te(c-a),i=null;break;case 36:te(0),i=null}return!(o=t.keyCode==i&&n!=y||s!=m)}})).bind("keypress.jsp",(function(t){if(t.keyCode==i&&d(),t.target===this||l.length&&e(t.target).closest(l).length)return!o})),n.hideFocus?(t.css("outline","none"),"hideFocus"in r[0]&&t.attr("hideFocus",!0)):(t.css("outline",""),"hideFocus"in r[0]&&t.attr("hideFocus",!1));function d(){var e=y,t=m;switch(i){case 40:N.scrollByY(n.keyboardSpeed,!1);break;case 38:N.scrollByY(-n.keyboardSpeed,!1);break;case 34:case 32:N.scrollByY(a*n.scrollPagePercent,!1);break;case 33:N.scrollByY(-a*n.scrollPagePercent,!1);break;case 39:N.scrollByX(n.keyboardSpeed,!1);break;case 37:N.scrollByX(-n.keyboardSpeed,!1)}return o=e!=y||t!=m}}(),n.clickOnTrack&&function(){X(),u&&w.bind("mousedown.jsp",(function(t){if(void 0===t.originalTarget||t.originalTarget==t.currentTarget){var i,s=e(this),o=s.offset(),r=t.pageY-o.top-m,l=!0,d=function(){var e=s.offset(),o=t.pageY-e.top-_/2,u=a*n.scrollPagePercent,p=f*u/(c-a);if(r<0)m-p>o?N.scrollByY(-u):Z(o);else{if(!(r>0))return void h();m+p<o?N.scrollByY(u):Z(o)}i=setTimeout(d,l?n.initialDelay:n.trackClickRepeatFreq),l=!1},h=function(){i&&clearTimeout(i),i=null,e(document).unbind("mouseup.jsp",h)};return d(),e(document).bind("mouseup.jsp",h),!1}}));p&&C.bind("mousedown.jsp",(function(t){if(void 0===t.originalTarget||t.originalTarget==t.currentTarget){var i,s=e(this),a=s.offset(),r=t.pageX-a.left-y,c=!0,d=function(){var e=s.offset(),a=t.pageX-e.left-k/2,u=o*n.scrollPagePercent,p=b*u/(l-o);if(r<0)y-p>a?N.scrollByX(-u):Q(a);else{if(!(r>0))return void h();y+p<a?N.scrollByX(u):Q(a)}i=setTimeout(d,c?n.initialDelay:n.trackClickRepeatFreq),c=!1},h=function(){i&&clearTimeout(i),i=null,e(document).unbind("mouseup.jsp",h)};return d(),e(document).bind("mouseup.jsp",h),!1}}))}(),function(){if(location.hash&&location.hash.length>1){var t,i,n=escape(location.hash.substr(1));try{t=e("#"+n+', a[name="'+n+'"]')}catch(e){return}t.length&&s.find(n)&&(0===r.scrollTop()?i=setInterval((function(){r.scrollTop()>0&&(ne(t,!0),e(document).scrollTop(r.position().top),clearInterval(i))}),50):(ne(t,!0),e(document).scrollTop(r.position().top)))}}(),n.hijackInternalLinks&&function(){if(e(document.body).data("jspHijack"))return;e(document.body).data("jspHijack",!0),e(document.body).delegate("a[href*=#]","click",(function(t){var i,n,s,o,a,r=this.href.substr(0,this.href.indexOf("#")),l=location.href;if(-1!==location.href.indexOf("#")&&(l=location.href.substr(0,location.href.indexOf("#"))),r===l){i=escape(this.href.substr(this.href.indexOf("#")+1));try{n=e("#"+i+', a[name="'+i+'"]')}catch(e){return}n.length&&((s=n.closest(".jspScrollable")).data("jsp").scrollToElement(n,!0),s[0].scrollIntoView&&(o=e(window).scrollTop(),((a=n.offset().top)<o||a>o+e(window).height())&&s[0].scrollIntoView()),t.preventDefault())}}))}()):(t.removeClass("jspScrollable"),s.css({top:0,left:0,width:r.width()-D}),r.unbind($),s.find(":input,a").unbind("focus.jsp"),t.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp"),s.unbind(".jsp"),X()),n.autoReinitialise&&!A?A=setInterval((function(){j(n)}),n.autoReinitialiseDelay):!n.autoReinitialise&&A&&clearInterval(A),U&&t.scrollTop(0)&&te(U,!1),V&&t.scrollLeft(0)&&ie(V,!1),t.trigger("jsp-initialised",[p||u])}function z(){w.height(T+"px"),m=0,E=n.verticalGutter+w.outerWidth(),s.width(o-E-D);try{0===S.position().left&&s.css("margin-left",E+"px")}catch(e){}}function G(){r.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each((function(){M-=e(this).outerWidth()})),C.width(M+"px"),y=0}function q(e,t,i,n){var s,o="before",a="after";"os"==t&&(t=/Mac/.test(navigator.platform)?"after":"split"),t==o?a=t:t==a&&(o=t,s=i,i=n,n=s),e[o](i)[a](n)}function Y(t,i,s){return function(){return function(t,i,s,o){s=e(s).addClass("jspActive");var a,r,l=!0,c=function(){0!==t&&N.scrollByX(t*n.arrowButtonSpeed),0!==i&&N.scrollByY(i*n.arrowButtonSpeed),r=setTimeout(c,l?n.initialDelay:n.arrowRepeatFreq),l=!1};c(),a=o?"mouseout.jsp":"mouseup.jsp",(o=o||e("html")).bind(a,(function(){s.removeClass("jspActive"),r&&clearTimeout(r),r=null,o.unbind(a)}))}(t,i,this,s),this.blur(),!1}}function X(){C&&C.unbind("mousedown.jsp"),w&&w.unbind("mousedown.jsp")}function K(){e("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),g&&g.removeClass("jspActive"),v&&v.removeClass("jspActive")}function Z(e,t){u&&(e<0?e=0:e>f&&(e=f),void 0===t&&(t=n.animateScroll),t?N.animate(g,"top",e,J):(g.css("top",e),J(e)))}function J(e){void 0===e&&(e=g.position().top),r.scrollTop(0);var i=0===(m=e||0),o=m==f,l=-(e/f)*(c-a);R==i&&H==o||(R=i,H=o,t.trigger("jsp-arrow-change",[R,H,B,U])),function(e,t){n.showArrows&&(P[e?"addClass":"removeClass"]("jspDisabled"),I[t?"addClass":"removeClass"]("jspDisabled"))}(i,o),s.css("top",l),t.trigger("jsp-scroll-y",[-l,i,o]).trigger("scroll")}function Q(e,t){p&&(e<0?e=0:e>b&&(e=b),void 0===t&&(t=n.animateScroll),t?N.animate(v,"left",e,ee):(v.css("left",e),ee(e)))}function ee(e){void 0===e&&(e=v.position().left),r.scrollTop(0);var i=0===(y=e||0),a=y==b,c=-(e/b)*(l-o);B==i&&U==a||(B=i,U=a,t.trigger("jsp-arrow-change",[R,H,B,U])),function(e,t){n.showArrows&&(x[e?"addClass":"removeClass"]("jspDisabled"),L[t?"addClass":"removeClass"]("jspDisabled"))}(i,a),s.css("left",c),t.trigger("jsp-scroll-x",[-c,i,a]).trigger("scroll")}function te(e,t){Z(e/(c-a)*f,t)}function ie(e,t){Q(e/(l-o)*b,t)}function ne(t,i,s){var l,c,d,h,u,p,g,f,m,v=0,b=0;try{l=e(t)}catch(e){return}for(c=l.outerHeight(),d=l.outerWidth(),r.scrollTop(0),r.scrollLeft(0);!l.is(".jspPane");)if(v+=l.position().top,b+=l.position().left,l=l.offsetParent(),/^body|html$/i.test(l[0].nodeName))return;p=(h=oe())+a,v<h||i?f=v-n.horizontalGutter:v+c>p&&(f=v-a+c+n.horizontalGutter),isNaN(f)||te(f,s),g=(u=se())+o,b<u||i?m=b-n.horizontalGutter:b+d>g&&(m=b-o+d+n.horizontalGutter),isNaN(m)||ie(m,s)}function se(){return-s.position().left}function oe(){return-s.position().top}function ae(){return!1}"border-box"===t.css("box-sizing")?(O=0,D=0):(O=t.css("paddingTop")+" "+t.css("paddingRight")+" "+t.css("paddingBottom")+" "+t.css("paddingLeft"),D=(parseInt(t.css("paddingLeft"),10)||0)+(parseInt(t.css("paddingRight"),10)||0)),e.extend(N,{reinitialise:function(t){j(t=e.extend({},n,t))},scrollToElement:function(e,t,i){ne(e,t,i)},scrollTo:function(e,t,i){ie(e,i),te(t,i)},scrollToX:function(e,t){ie(e,t)},scrollToY:function(e,t){te(e,t)},scrollToPercentX:function(e,t){ie(e*(l-o),t)},scrollToPercentY:function(e,t){te(e*(c-a),t)},scrollBy:function(e,t,i){N.scrollByX(e,i),N.scrollByY(t,i)},scrollByX:function(e,t){Q((se()+Math[e<0?"floor":"ceil"](e))/(l-o)*b,t)},scrollByY:function(e,t){Z((oe()+Math[e<0?"floor":"ceil"](e))/(c-a)*f,t)},positionDragX:function(e,t){Q(e,t)},positionDragY:function(e,t){Z(e,t)},animate:function(e,t,i,s){var o={};o[t]=i,e.animate(o,{duration:n.animateDuration,easing:n.animateEase,queue:!1,step:s})},getContentPositionX:function(){return se()},getContentPositionY:function(){return oe()},getContentWidth:function(){return l},getContentHeight:function(){return c},getPercentScrolledX:function(){return se()/(l-o)},getPercentScrolledY:function(){return oe()/(c-a)},getIsScrollableH:function(){return p},getIsScrollableV:function(){return u},getContentPane:function(){return s},scrollToBottom:function(e){Z(f,e)},hijackInternalLinks:e.noop,destroy:function(){var e,i;e=oe(),i=se(),t.removeClass("jspScrollable").unbind(".jsp"),s.unbind(".jsp"),t.replaceWith(V.append(s.children())),V.scrollTop(e),V.scrollLeft(i),A&&clearInterval(A)}}),j(i)}return t=e.extend({},e.fn.jScrollPane.defaults,t),e.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],(function(){t[this]=t[this]||t.speed})),this.each((function(){var n=e(this),s=n.data("jsp");s?s.reinitialise(t):(e("script",n).filter('[type="text/javascript"],:not([type])').remove(),s=new i(n,t),n.data("jsp",s))}))},e.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}})),function(e){"use strict";var t,i,n="",s=Math.PI,o=s/2,a="ontouchstart"in window,r=a?{down:"touchstart",move:"touchmove",up:"touchend",over:"touchstart",out:"touchend"}:{down:"mousedown",move:"mousemove",up:"mouseup",over:"mouseover",out:"mouseout"},l={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br","l","r"]},c=["single","double"],d=["ltr","rtl"],h={acceleration:!0,display:"double",duration:600,page:1,gradients:!0,turnCorners:"bl,br",when:null},u={cornerSize:100},p={init:function(s){var o;t="WebKitCSSMatrix"in window||"MozPerspective"in document.body.style,i=!(o=/AppleWebkit\/([0-9\.]+)/i.exec(navigator.userAgent))||parseFloat(o[1])>534.3,n=E();var l,c=0,d=this.data(),g=this.children();if(u.cornerSize="number"==typeof s.cornerSize?s.cornerSize:u.cornerSize,s=e.extend({width:this.width(),height:this.height(),direction:this.attr("dir")||this.css("direction")||"ltr"},h,s),d.opts=s,d.pageObjs={},d.pages={},d.pageWrap={},d.pageZoom={},d.pagePlace={},d.pageMv=[],d.zoom=1,d.totalPages=s.pages||0,d.eventHandlers={touchStart:e.proxy(p._touchStart,this),touchMove:e.proxy(p._touchMove,this),touchEnd:e.proxy(p._touchEnd,this),start:e.proxy(p._eventStart,this)},s.when)for(l in s.when)w(l,s.when)&&this.bind(l,s.when[l]);for(this.css({position:"relative",width:s.width,height:s.height}),this.turn("display",s.display),""!==s.direction&&this.turn("direction",s.direction),t&&!a&&s.acceleration&&this.transform(y(0,0,!0)),l=0;l<g.length;l++)"1"!=e(g[l]).attr("ignore")&&this.turn("addPage",g[l],++c);return e(this).bind(r.down,d.eventHandlers.touchStart).bind("end",p._eventEnd).bind("pressed",p._eventPressed).bind("released",p._eventReleased).bind("flip",p._flip),e(this).parent().bind("start",d.eventHandlers.start),e(document).bind(r.move,d.eventHandlers.touchMove).bind(r.up,d.eventHandlers.touchEnd),this.turn("page",s.page),d.done=!0,this.turn.initialLoading=!1,this},addPage:function(t,i){var n,s,o=!1,a=this.data(),r=a.totalPages+1;if(a.destroying)return!1;if((n=/\bp([0-9]+)\b/.exec(e(t).attr("class")))&&(i=parseInt(n[1],10)),i){if(i==r)o=!0;else if(i>r)throw P('Page "'+i+'" cannot be inserted')}else i=r,o=!0;return i>=1&&i<=r&&(s="double"==a.display?i%2?" odd":" even":"",a.opts.isDoublePageLayout||(s+=" shadow"),a.done&&this.turn("stop"),i in a.pageObjs&&p._movePages.call(this,i,1),o&&(a.totalPages=r),a.pageObjs[i]=e(t).css({float:"left"}).addClass("page p"+i+s),-1!=navigator.userAgent.indexOf("MSIE 9.0")&&a.pageObjs[i].hasClass("hard")&&a.pageObjs[i].removeClass("hard"),p._addPage.call(this,i),p._removeFromDOM.call(this)),this},_addPage:function(t){var i=this.data(),n=i.pageObjs[t],s=-1;if(n)if(p._necessPage.call(this,t)){if(!i.pageWrap[t]){i.pageWrap[t]=e("<div/>",{class:"page-wrapper",page:t,css:{position:"absolute",overflow:"hidden"}}),e.each(i.pageWrap,(function(e){var i=parseInt(e,10);-1===s&&i>t&&(s=i)})),s>-1&&i.pageWrap[s]?i.pageWrap[t].insertBefore(i.pageWrap[s]):this.append(i.pageWrap[t]),i.pagePlace[t]||(i.pagePlace[t]=t,i.pageObjs[t].appendTo(i.pageWrap[t]));var o=p._pageSize.call(this,t,!0);n.css({width:o.width,height:o.height}),i.pageWrap[t].css(o)}i.pagePlace[t]==t&&p._makeFlip.call(this,t)}else i.pagePlace[t]=0,i.pageObjs[t]&&i.pageObjs[t].remove()},hasPage:function(e){return w(e,this.data().pageObjs)},center:function(t){var i=this.data(),n=e(this).turn("size"),s=parseInt(e(this).css("margin-left")||0),o=0,a=e(this);if(!i.noCenter){if("double"===i.display){var r=this.turn("view",t||i.tpage||i.page);"ltr"===i.direction?r[0]?r[1]||(o+=n.width/4):o-=n.width/4:r[0]?r[1]||(o-=n.width/4):o+=n.width/4}o!==s&&(e("#mainView").hasClass("zoomed")?a.css({marginLeft:o}):this.turn.initialLoading?this.animatef({from:s,to:o,duration:400,frame:function(e){a.css({marginLeft:e})}}):a.css({marginLeft:o}))}return this},destroy:function(){var t=this,i=this.data();if("prevented"!=_("destroying",this)){for(i.destroying=!0,e.each(["end","first","flip","last","pressed","released","start","turning","turned","zooming","missing"],(function(e,i){t.unbind(i)})),this.parent().unbind("start",i.eventHandlers.start),e(document).unbind(r.move,i.eventHandlers.touchMove).unbind(r.up,i.eventHandlers.touchEnd);0!==i.totalPages;)this.turn("removePage",i.totalPages);return i.fparent&&i.fparent.remove(),i.shadow&&i.shadow.remove(),this.removeData(),i=null,this}},is:function(){return"object"==typeof this.data().pages},zoom:function(t){var i=this.data();if("number"==typeof t){if(t<.001||t>100)throw P(t+" is not a value for zoom");if("prevented"==_("zooming",this,[t,i.zoom]))return this;var n=this.turn("size"),s=this.turn("view"),o=1/i.zoom,a=Math.round(n.width*o*t),r=Math.round(n.height*o*t);i.zoom=t,e(this).turn("stop").turn("size",a,r),i.opts.autoCenter&&this.turn("center"),p._updateShadow.call(this);for(var l=0;l<s.length;l++)s[l]&&i.pageZoom[s[l]]!=i.zoom&&(this.trigger("zoomed",[s[l],s,i.pageZoom[s[l]],i.zoom]),i.pageZoom[s[l]]=i.zoom);return this}return i.zoom},_pageSize:function(e,t){var i=this.data(),n={};if("single"==i.display)n.width=this.width(),n.height=this.height(),t&&(n.top=0,n.left=0,n.right="auto");else{var s=this.width()/2,o=this.height();if(i.pageObjs[e].hasClass("own-size")?(n.width=i.pageObjs[e].width(),n.height=i.pageObjs[e].height()):(n.width=s,n.height=o),t){var a=e%2;n.top=(o-n.height)/2,"ltr"==i.direction?(n[a?"right":"left"]=s-n.width,n[a?"left":"right"]="auto"):(n[a?"left":"right"]=s-n.width,n[a?"right":"left"]="auto")}}return n},_makeFlip:function(e){var t=this.data();if(!t.pages[e]&&t.pagePlace[e]==e){var i="single"==t.display,n=e%2;t.pages[e]=t.pageObjs[e].css(p._pageSize.call(this,e)).flip({page:e,next:n||i?e+1:e-1,turn:this}).flip("disable",t.disabled),p._setPageLoc.call(this,e),t.pageZoom[e]=t.zoom}return t.pages[e]},_makeRange:function(){var e,t;if(!(this.data().totalPages<1))for(e=(t=this.turn("range"))[0];e<=t[1];e++)p._addPage.call(this,e)},range:function(e){var t,i,n,s,o=this.data();if(e=e||o.tpage||o.page||1,s=p._view.call(this,e),e<1||e>o.totalPages)throw P('"'+e+'" is not a valid page');return s[1]=s[1]||s[0],s[0]>=1&&s[1]<=o.totalPages?(t=Math.floor(2),o.totalPages-s[1]>s[0]?n=2*t-(i=Math.min(s[0]-1,t)):i=2*t-(n=Math.min(o.totalPages-s[1],t))):(i=5,n=5),[Math.max(1,s[0]-i),Math.min(o.totalPages,s[1]+n)]},_necessPage:function(e){if(0===e)return!0;var t=this.turn("range");return this.data().pageObjs[e].hasClass("fixed")||e>=t[0]&&e<=t[1]},_removeFromDOM:function(){var e,t=this.data();for(e in t.pageWrap)w(e,t.pageWrap)&&!p._necessPage.call(this,e)&&p._removePageFromDOM.call(this,e)},_removePageFromDOM:function(e){var t=this.data();if(t.pages[e]){var i=t.pages[e].data();g._moveFoldingPage.call(t.pages[e],!1),i.f&&i.f.fwrapper&&i.f.fwrapper.remove(),t.pages[e].removeData(),t.pages[e].remove(),delete t.pages[e]}t.pageObjs[e]&&t.pageObjs[e].remove(),t.pageWrap[e]&&(t.pageWrap[e].remove(),delete t.pageWrap[e]),p._removeMv.call(this,e),delete t.pagePlace[e],delete t.pageZoom[e]},removePage:function(e){var t=this.data();if("*"==e)for(;0!==t.totalPages;)this.turn("removePage",t.totalPages);else{if(e<1||e>t.totalPages)throw P("The page "+e+" doesn't exist");t.pageObjs[e]&&(this.turn("stop"),p._removePageFromDOM.call(this,e),delete t.pageObjs[e]),p._movePages.call(this,e,-1),t.totalPages=t.totalPages-1,t.page>t.totalPages?(t.page=null,p._fitPage.call(this,t.totalPages)):(p._makeRange.call(this),this.turn("update"))}return this},_movePages:function(e,t){var i,n=this,s=this.data(),o="single"==s.display,a=function(e){var i=e+t,a=i%2,r=a?" odd ":" even ";s.pageObjs[e]&&(s.pageObjs[i]=s.pageObjs[e].removeClass("p"+e+" odd even").addClass("p"+i+r)),s.pagePlace[e]&&s.pageWrap[e]&&(s.pagePlace[i]=i,s.pageObjs[i].hasClass("fixed")?s.pageWrap[i]=s.pageWrap[e].attr("page",i):s.pageWrap[i]=s.pageWrap[e].css(p._pageSize.call(n,i,!0)).attr("page",i),s.pages[e]&&(s.pages[i]=s.pages[e].flip("options",{page:i,next:o||a?i+1:i-1})),t&&(delete s.pages[e],delete s.pagePlace[e],delete s.pageZoom[e],delete s.pageObjs[e],delete s.pageWrap[e]))};if(t>0)for(i=s.totalPages;i>=e;i--)a(i);else for(i=e;i<=s.totalPages;i++)a(i)},display:function(t){var i=this.data(),n=i.display;if(void 0===t)return n;if(-1==e.inArray(t,c))throw P('"'+t+'" is not a value for display');switch(t){case"single":i.pageObjs[0]||(this.turn("stop").css({overflow:"hidden"}),i.pageObjs[0]=e("<div />",{class:"page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)),this.addClass("shadow");break;case"double":i.pageObjs[0]&&(this.turn("stop").css({overflow:""}),i.pageObjs[0].remove(),delete i.pageObjs[0]),this.removeClass("shadow")}if(i.display=t,n){var s=this.turn("size");p._movePages.call(this,1,0),this.turn("size",s.width,s.height).turn("update")}return this},direction:function(t){var i=this.data();if(void 0===t)return i.direction;if(t=t.toLowerCase(),-1==e.inArray(t,d))throw P('"'+t+'" is not a value for direction');return"rtl"==t&&e(this).attr("dir","ltr").css({direction:"ltr"}),i.direction=t,i.done&&this.turn("size",e(this).width(),e(this).height()),this},animating:function(){return this.data().pageMv.length>0},corner:function(){var e,t,i=this.data();for(t in i.pages)if(w(t,i.pages)&&(e=i.pages[t].flip("corner")))return e;return!1},data:function(){return this.data()},disable:function(t){var i,n=this.data(),s=this.turn("view");for(i in n.disabled=void 0===t||!0===t,n.pages)w(i,n.pages)&&n.pages[i].flip("disable",!!n.disabled||-1==e.inArray(parseInt(i,10),s));return this},disabled:function(e){return void 0===e?!0===this.data().disabled:this.turn("disable",e)},size:function(e,t){if(void 0===e||void 0===t)return{width:this.width(),height:this.height()};this.turn("stop");var i,n,s=this.data(),o="double"==s.display?e/2:e;for(i in this.css({width:e,height:t}),s.pageObjs[0]&&s.pageObjs[0].css({width:o,height:t}),s.pageWrap)w(i,s.pageWrap)&&(n=p._pageSize.call(this,i,!0),s.pageObjs[i].css({width:n.width,height:n.height}),s.pageWrap[i].css(n),s.pages[i]&&s.pages[i].css({width:n.width,height:n.height}));return this.turn("resize"),this},resize:function(){var e,t=this.data();for(t.pages[0]&&(t.pageWrap[0].css({left:-this.width()}),t.pages[0].flip("resize",!0)),e=1;e<=t.totalPages;e++)t.pages[e]&&t.pages[e].flip("resize",!0);p._updateShadow.call(this),t.opts.autoCenter&&this.turn("center")},_removeMv:function(e){var t,i=this.data();for(t=0;t<i.pageMv.length;t++)if(i.pageMv[t]==e)return i.pageMv.splice(t,1),!0;return!1},_addMv:function(e){var t=this.data();p._removeMv.call(this,e),t.pageMv.push(e)},_view:function(e){var t=this.data();return e=e||t.page,"double"==t.display?e%2?[e-1,e]:[e,e+1]:[e]},view:function(e){var t=this.data(),i=p._view.call(this,e);return"double"==t.display?[i[0]>0?i[0]:0,i[1]<=t.totalPages?i[1]:0]:[i[0]>0&&i[0]<=t.totalPages?i[0]:0]},stop:function(e,t){if(this.turn("animating")){var i,n,s,o=this.data();for(o.tpage&&(o.page=o.tpage,delete o.tpage),i=0;i<o.pageMv.length;i++)o.pageMv[i]&&o.pageMv[i]!==e&&(n=(s=o.pages[o.pageMv[i]]).data().f.opts,s.flip("hideFoldedPage",t),t||g._moveFoldingPage.call(s,!1),n.force&&(n.next=n.page%2==0?n.page-1:n.page+1,delete n.force))}return this.turn("update"),this},pages:function(e){var t=this.data();if(e){if(e<t.totalPages)for(var i=t.totalPages;i>e;i--)this.turn("removePage",i);return t.totalPages=e,p._fitPage.call(this,t.page),this}return t.totalPages},_missing:function(e){var t=this.data();if(!(t.totalPages<1)){var i,n=this.turn("range",e),s=[];for(i=n[0];i<=n[1];i++)t.pageObjs[i]||s.push(i);s.length>0&&this.trigger("missing",[s])}},_fitPage:function(e){var t=this.data(),i=this.turn("view",e);if(p._missing.call(this,e),t.pageObjs[e]){t.page=e,this.turn("stop");for(var n=0;n<i.length;n++)i[n]&&t.pageZoom[i[n]]!=t.zoom&&(this.trigger("zoomed",[i[n],i,t.pageZoom[i[n]],t.zoom]),t.pageZoom[i[n]]=t.zoom);if(p._removeFromDOM.call(this),p._makeRange.call(this),p._updateShadow.call(this),this.trigger("turned",[e,i]),this.turn("update"),t.opts.isDoublePageLayout&&t.page>1&&t.page<t.totalPages&&!t.previousFlip){var s=t.page+1,o=t.pageWrap[s];F(t.pages[s],o,!1,t)}t.opts.autoCenter&&this.turn("center")}},_turnPage:function(t){var i,n,s=this.data(),o=s.pagePlace[t],a=this.turn("view"),r=this.turn("view",t);if(s.page!=t){var l=s.page;if("prevented"==_("turning",this,[t,r]))return void(l==s.page&&-1!=e.inArray(o,s.pageMv)&&s.pages[o].flip("hideFoldedPage",!0));-1!=e.inArray(1,r)&&this.trigger("first"),-1!=e.inArray(s.totalPages,r)&&this.trigger("last")}"single"==s.display?(i=a[0],n=r[0]):a[1]&&t>a[1]?(i=a[1],n=r[0]):a[0]&&t<a[0]&&(i=a[0],n=r[1]);var c=s.opts.turnCorners.split(",");if((l=s.pages[i])&&"function"==typeof l.data){var d=s.pages[i].data().f,h=d.opts,u=d.point;p._missing.call(this,t),s.pageObjs[t]&&(this.turn("stop"),s.page=t,p._makeRange.call(this),s.tpage=n,h.next!=n&&(h.next=n,h.force=!0),this.turn("update"),d.point=u,"hard"==d.effect?"ltr"==s.direction?s.pages[i].flip("turnPage",t>i?"r":"l"):s.pages[i].flip("turnPage",t>i?"l":"r"):"ltr"==s.direction?s.pages[i].flip("turnPage",c[t>i?1:0]):s.pages[i].flip("turnPage",c[t>i?0:1]))}},page:function(t){var i=this.data();if(void 0===t)return i.page;if(!i.disabled&&!i.destroying){if((t=parseInt(t,10))>0&&t<=i.totalPages)return t!=i.page&&(i.done&&-1==e.inArray(t,this.turn("view"))?p._turnPage.call(this,t):p._fitPage.call(this,t)),this;throw P("The page "+t+" does not exist")}},next:function(){return this.turn("page",Math.min(this.data().totalPages,p._view.call(this,this.data().page).pop()+1))},previous:function(){return this.turn("page",Math.max(1,p._view.call(this,this.data().page).shift()-1))},peel:function(e,t){var i,n=this.data(),s=this.turn("view");(t=void 0===t||!0===t,!1===e)?this.turn("stop",null,t):"single"==n.display?n.pages[n.page].flip("peel",e,t):(i="ltr"==n.direction?-1!=e.indexOf("l")?s[0]:s[1]:-1!=e.indexOf("l")?s[1]:s[0],n.pages[i]&&n.pages[i].flip("peel",e,t));return this},_addMotionPage:function(){var t=e(this).data().f.opts,i=t.turn;i.data();p._addMv.call(i,t.page)},_eventStart:function(e,t,i){var n=t.turn.data(),s=n.pageZoom[t.page];if(e.isDefaultPrevented())p._updateShadow.call(t.turn);else{if(s&&s!=n.zoom&&(t.turn.trigger("zoomed",[t.page,t.turn.turn("view",t.page),s,n.zoom]),n.pageZoom[t.page]=n.zoom),"single"==n.display&&i&&("l"==i.charAt(1)&&"ltr"==n.direction||"r"==i.charAt(1)&&"rtl"==n.direction?(t.next=t.next<t.page?t.next:t.page-1,t.force=!0):t.next=t.next>t.page?t.next:t.page+1),n.opts.isDoublePageLayout){var o=t.page<t.next?"rtl":"ltr",a="rtl"===o?t.page:t.page+1,r=n.pageWrap[a],l=n.pages[a];n.flipDirection=o,F(l,r,!0,n)}p._addMotionPage.call(e.target),p._updateShadow.call(t.turn)}},_eventEnd:function(t,i,n){e(t.target).data().f;var s,o,a,r=i.turn,l=r.data(),c=i.page<i.next?"rtl":"ltr";if(n){var d=l.tpage||l.page;l.previousFlip=c,l.opts.isDoublePageLayout&&l.page>1&&l.page<l.totalPages&&(s="rtl"===c?i.next+1:i.next,a=l.pageWrap[s],F(o=l.pages[s],a,!1,l)),d!=i.next&&d!=i.page||(delete l.tpage,p._fitPage.call(r,d||i.next,!0))}else{if(l.opts.isDoublePageLayout&&l.page>1&&l.page<l.totalPages)if(l.page!==i.next&&l.page!==i.page)l.previousFlip?(s="rtl"===c?i.page:i.page+1,a=l.pageWrap[s],F(o=l.pages[s],a,!1,l)):(s=l.page+1,a=l.pageWrap[s],F(o=l.pages[s],a,!1,l));else if(l.previousFlip)if("rtl"===l.previousFlip)s="rtl"===c?i.next+1:i.page+1,a=l.pageWrap[s],F(o=l.pages[s],a,!1,l);else{s="rtl"===c?i.page:i.page-1,a=l.pageWrap[s],o=l.pages[s];var h=s===(l.page%2==0?l.page+1:l.page);o&&!o.hasClass("p1")&&h&&F(o,a,!1,l)}else s=l.page+1,a=l.pageWrap[s],F(o=l.pages[s],a,!1,l);p._removeMv.call(r,i.page),p._updateShadow.call(r),r.turn("update")}},_eventPressed:function(t){var i=e(t.target).data().f,n=i.opts.turn,s=n.data();s.pages;return s.mouseAction=!0,n.turn("update"),i.time=(new Date).getTime()},_eventReleased:function(t,i){var n,s=e(t.target),o=s.data().f,a=o.opts.turn,r=a.data();n="single"==r.display?"br"==i.corner||"tr"==i.corner?i.x<s.width()/2:i.x>s.width()/2:i.x<0||i.x>s.width(),((new Date).getTime()-o.time<200||n)&&(t.preventDefault(),p._turnPage.call(a,o.opts.next)),r.mouseAction=!1},_flip:function(t){t.stopPropagation();var i=e(t.target).data().f.opts;i.turn.trigger("turn",[i.next]),i.turn.data().opts.autoCenter&&i.turn.turn("center",i.next)},_touchStart:function(){var e=this.data();for(var t in e.pages)if(w(t,e.pages)&&!1===g._eventStart.apply(e.pages[t],arguments))return!1},_touchMove:function(){var e=this.data();for(var t in e.pages)w(t,e.pages)&&g._eventMove.apply(e.pages[t],arguments)},_touchEnd:function(){var e=this.data();for(var t in e.pages)w(t,e.pages)&&g._eventEnd.apply(e.pages[t],arguments)},calculateZ:function(e){var t,i,n,s,o,a=this,r=this.data(),l=this.turn("view"),c=l[0]||l[1],d=e.length-1,h={pageZ:{},partZ:{},pageV:{}},u=function(e){var t=a.turn("view",e);t[0]&&(h.pageV[t[0]]=!0),t[1]&&(h.pageV[t[1]]=!0)};for(t=0;t<=d;t++)i=e[t],n=r.pages[i].data().f.opts.next,s=r.pagePlace[i],u(i),u(n),o=r.pagePlace[n]==n?n:i,h.pageZ[o]=r.totalPages-Math.abs(c-o),h.partZ[s]=2*r.totalPages-d+t;return h},update:function(){var t,i=this.data();if(this.turn("animating")&&0!==i.pageMv[0]){var n,s,o=this.turn("calculateZ",i.pageMv),a=this.turn("corner"),r=this.turn("view"),l=this.turn("view",i.tpage),c={};for(t in i.pageWrap)w(t,i.pageWrap)&&(s=i.pageObjs[t].hasClass("fixed"),c={display:o.pageV[t]||s?"":"none",zIndex:(i.pageObjs[t].hasClass("hard")?o.partZ[t]:o.pageZ[t])||(s?-1:0)},i.pageWrap[t].css(c),(n=i.pages[t])&&(n.flip("z",o.partZ[t]||null),o.pageV[t]&&n.flip("resize"),i.tpage?n.flip("hover",!1).flip("disable",-1==e.inArray(parseInt(t,10),i.pageMv)&&t!=l[0]&&t!=l[1]):n.flip("hover",!1===a).flip("disable",t!=r[0]&&t!=r[1])))}else for(t in i.pageWrap)if(w(t,i.pageWrap)){var d=p._setPageLoc.call(this,t);i.pages[t]&&i.pages[t].flip("disable",i.disabled||1!=d).flip("hover",!0).flip("z",null)}return this},_updateShadow:function(){var t,i,n=this.data(),s=this.width(),o=this.height(),a="single"==n.display?s:s/2;t=this.turn("view"),n.shadow||(n.shadow=e("<div />",{class:"shadow",css:m(0,0,0).css}).appendTo(this));for(var r=0;r<n.pageMv.length&&(t[0]&&t[1]);r++)t=this.turn("view",n.pages[n.pageMv[r]].data().f.opts.next),i=this.turn("view",n.pageMv[r]),t[0]=t[0]&&i[0],t[1]=t[1]&&i[1];switch(t[0]?t[1]?3:"ltr"==n.direction?2:1:"ltr"==n.direction?1:2){case 1:n.shadow.css({width:a,height:o,top:0,left:a});break;case 2:n.shadow.css({width:a,height:o,top:0,left:0});break;case 3:n.shadow.css({width:s,height:o,top:0,left:0})}},_setPageLoc:function(e){var t=this.data(),i=this.turn("view"),n=0,s={};if(e==i[0]||e==i[1]?n=1:("single"==t.display&&e==i[0]+1||"double"==t.display&&e==i[0]-2||e==i[1]+2)&&(n=2),!this.turn("animating")){switch(n){case 1:s={zIndex:t.totalPages,display:""};break;case 2:s={zIndex:t.totalPages-1,display:""};break;case 0:s={zIndex:0,display:t.pageObjs[e].hasClass("fixed")?"":"none"}}t.pageWrap[e].css(s)}return n},options:function(t){if(void 0===t)return this.data().opts;var i=this.data();if(e.extend(i.opts,t),t.pages&&this.turn("pages",t.pages),t.page&&this.turn("page",t.page),t.display&&this.turn("display",t.display),t.direction&&this.turn("direction",t.direction),t.width&&t.height&&this.turn("size",t.width,t.height),t.when)for(var n in t.when)w(n,t.when)&&this.unbind(n).bind(n,t.when[n]);return this},version:function(){return"4.1.0"}},g={init:function(e){return this.data({f:{disabled:!1,hover:!1,effect:this.hasClass("hard")?"hard":"sheet"}}),this.flip("options",e),g._addPageWrapper.call(this),this},setData:function(t){var i=this.data();return i.f=e.extend(i.f,t),this},options:function(t){var i=this.data().f;return t?(g.setData.call(this,{opts:e.extend({},i.opts||u,t)}),this):i.opts},z:function(e){var t=this.data().f;return t.opts["z-index"]=e,t.fwrapper&&t.fwrapper.css({zIndex:e||parseInt(t.parent.css("z-index"),10)||0}),this},_cAllowed:function(){var e=this.data().f,t=e.opts.page,i=e.opts.turn.data(),n=t%2;return"hard"==e.effect?"ltr"==i.direction?[n?"r":"l"]:[n?"l":"r"]:"single"==i.display?1==t?"ltr"==i.direction?l.forward:l.backward:t==i.totalPages?"ltr"==i.direction?l.backward:l.forward:l.all:"ltr"==i.direction?l[n?"forward":"backward"]:l[n?"backward":"forward"]},_cornerActivated:function(t){var i=this.data().f,n=this.width(),s=this.height(),o={x:t.x,y:t.y,corner:""},a=i.opts.cornerSize;if(o.x<=0||o.y<=0||o.x>=n||o.y>=s)return!1;var r=g._cAllowed.call(this);switch(i.effect){case"hard":if(o.x>n-a)o.corner="r";else{if(!(o.x<a))return!1;o.corner="l"}break;case"sheet":if(o.y<a)o.corner+="t";else{if(!(o.y>=s-a))return!1;o.corner+="b"}if(o.x<=a)o.corner+="l";else{if(!(o.x>=n-a))return!1;o.corner+="r"}}return!(!o.corner||-1==e.inArray(o.corner,r))&&o},_isIArea:function(e){var t=this.data().f.parent.offset();return e=a&&e.originalEvent?e.originalEvent.touches[0]:e,g._cornerActivated.call(this,{x:e.pageX-t.left,y:e.pageY-t.top})},_c:function(e,t){switch(t=t||0,e){case"tl":return b(t,t);case"tr":return b(this.width()-t,t);case"bl":return b(t,this.height()-t);case"br":return b(this.width()-t,this.height()-t);case"l":return b(t,0);case"r":return b(this.width()-t,0)}},_c2:function(e){switch(e){case"tl":case"l":return b(2*this.width(),0);case"tr":case"r":return b(-this.width(),0);case"bl":return b(2*this.width(),this.height());case"br":return b(-this.width(),this.height())}},_foldingPage:function(){var e=this.data().f;if(e){var t=e.opts;return t.turn?"single"==(e=t.turn.data()).display?t.next>1||t.page>1?e.pageObjs[0]:null:e.pageObjs[t.next]:void 0}},_backGradient:function(){var t=this.data().f,i=t.opts.turn.data(),n=i.opts.gradients&&("single"==i.display||2!=t.opts.page&&t.opts.page!=i.totalPages-1);return n&&!t.bshadow&&(t.bshadow=e("<div/>",m(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(t.parent)),n},type:function(){return this.data().f.effect},resize:function(e){var t=this.data().f,i=t.opts.turn.data(),n=this.width(),s=this.height();switch(t.effect){case"hard":e&&(t.wrapper.css({width:n,height:s}),t.fpage.css({width:n,height:s}),i.opts.gradients&&(t.ashadow.css({width:n,height:s}),t.bshadow.css({width:n,height:s})));break;case"sheet":if(e){var o=Math.round(Math.sqrt(Math.pow(n,2)+Math.pow(s,2)));t.wrapper.css({width:o,height:o}),t.fwrapper.css({width:o,height:o}).children(":first-child").css({width:n,height:s}),t.fpage.css({width:n,height:s}),i.opts.gradients&&t.ashadow.css({width:n,height:s}),g._backGradient.call(this)&&t.bshadow.css({width:n,height:s})}if(t.parent.is(":visible")){var a=I(t.parent[0]);t.fwrapper.css({top:a.top,left:a.left}),a=I(t.opts.turn[0]),t.fparent.css({top:-a.top,left:-a.left})}this.flip("z",t.opts["z-index"])}},_addPageWrapper:function(){var t=this.data().f,i=t.opts.turn.data(),s=this.parent();if(t.parent=s,!t.wrapper)switch(t.effect){case"hard":var o={};o[n+"transform-style"]="preserve-3d",o[n+"backface-visibility"]="hidden",t.wrapper=e("<div/>",m(0,0,2)).css(o).appendTo(s).prepend(this),t.fpage=e("<div/>",m(0,0,1)).css(o).appendTo(s),i.opts.gradients&&(t.ashadow=e("<div/>",m(0,0,0)).hide().appendTo(s),t.bshadow=e("<div/>",m(0,0,0)));break;case"sheet":var a=this.width(),r=this.height();Math.round(Math.sqrt(Math.pow(a,2)+Math.pow(r,2)));if(t.fparent=t.opts.turn.data().fparent,!t.fparent){var l=e("<div/>",{css:{"pointer-events":"none"}}).hide();l.data().flips=0,l.css(m(0,0,"auto","visible").css).appendTo(t.opts.turn),t.opts.turn.data().fparent=l,t.fparent=l}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"}),t.wrapper=e("<div/>",m(0,0,this.css("z-index"))).appendTo(s).prepend(this),t.fwrapper=e("<div/>",m(s.offset().top,s.offset().left)).hide().appendTo(t.fparent),t.fpage=e("<div/>",m(0,0,0,"hidden")).css({cursor:"default"}).appendTo(t.fwrapper),i.opts.gradients&&(t.ashadow=e("<div/>",m(0,0,1)).appendTo(t.fpage)),g.setData.call(this,t)}g.resize.call(this,!0)},_fold:function(e){var t=this.data().f,a=t.opts.turn.data(),r=g._c.call(this,e.corner),l=this.width(),c=this.height();switch(t.effect){case"hard":"l"==e.corner?e.x=Math.min(Math.max(e.x,0),2*l):e.x=Math.max(Math.min(e.x,l),-l);var d,h,u,p,f,m=a.totalPages,v=t.opts["z-index"]||m,w={overflow:"visible"},E=r.x?(r.x-e.x)/l:e.x/l,_=90*E,P=_<90;switch(e.corner){case"l":p="0% 50%",f="100% 50%",P?(d=0,h=t.opts.next-1>0,u=1):(d="100%",h=t.opts.page+1<m,u=0);break;case"r":p="100% 50%",f="0% 50%",_=-_,l=-l,P?(d=0,h=t.opts.next+1<m,u=0):(d="-100%",h=1!=t.opts.page,u=1)}w[n+"perspective-origin"]=f,t.wrapper.transform("rotateY("+_+"deg)translate3d(0px, 0px, "+(this.attr("depth")||0)+"px)",f),t.fpage.transform("translateX("+l+"px) rotateY("+(180+_)+"deg)",p),t.parent.css(w),P?(E=1-E,t.wrapper.css({zIndex:v+1}),t.fpage.css({zIndex:v})):(E-=1,t.wrapper.css({zIndex:v}),t.fpage.css({zIndex:v+1})),a.opts.gradients&&(h?t.ashadow.css({display:"",left:d,backgroundColor:"rgba(0,0,0,"+.5*E+")"}).transform("rotateY(0deg)"):t.ashadow.hide(),t.bshadow.css({opacity:1-E}),P?t.bshadow.parent()[0]!=t.wrapper[0]&&t.bshadow.appendTo(t.wrapper):t.bshadow.parent()[0]!=t.fpage[0]&&t.bshadow.appendTo(t.fpage),T(t.bshadow,b(100*u,0),b(100*(1-u),0),[[0,"rgba(0,0,0,0.3)"],[1,"rgba(0,0,0,0)"]],2));break;case"sheet":var I,F,C,M,k,x,L,A=this,O=0,D=b(0,0),W=b(0,0),N=b(0,0),R=g._foldingPage.call(this),B=(Math.tan(0),a.opts.acceleration),H=t.wrapper.height(),U="t"==e.corner.substr(0,1),V="l"==e.corner.substr(1,1),$=function(){var t=b(0,0),n=b(0,0);t.x=r.x?r.x-e.x:e.x,t.y=i?r.y?r.y-e.y:e.y:0,n.x=V?l-t.x/2:e.x+t.x/2,n.y=t.y/2;var d=o-Math.atan2(t.y,t.x),h=d-Math.atan2(n.y,n.x),u=Math.max(0,Math.sin(h)*Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2)));if(O=d/s*180,N=b(u*Math.sin(d),u*Math.cos(d)),d>o&&(N.x=N.x+Math.abs(N.y*t.y/t.x),N.y=0,Math.round(N.x*Math.tan(s-d))<c))return e.y=Math.sqrt(Math.pow(c,2)+2*n.x*t.x),U&&(e.y=c-e.y),$();if(d>o){var p=s-d,f=H-c/Math.sin(p);D=b(Math.round(f*Math.cos(p)),Math.round(f*Math.sin(p))),V&&(D.x=-D.x),U&&(D.y=-D.y)}I=Math.round(N.y/Math.tan(d)+N.x);var m=l-I,v=m*Math.cos(2*d),y=m*Math.sin(2*d);if(W=b(Math.round(V?m-v:I+v),Math.round(U?y:c-y)),a.opts.gradients){k=m*Math.sin(d);var S=g._c2.call(A,e.corner),w=Math.sqrt(Math.pow(S.x-e.x,2)+Math.pow(S.y-e.y,2))/l;L=Math.sin(o*(w>1?2-w:w)),x=Math.min(w,1),M=k>100?(k-100)/k:0,F=b(k*Math.sin(d)/l*100,k*Math.cos(d)/c*100),g._backGradient.call(A)&&(C=b(1.2*k*Math.sin(d)/l*100,1.2*k*Math.cos(d)/c*100),V||(C.x=100-C.x),U||(C.y=100-C.y))}return N.x=Math.round(N.x),N.y=Math.round(N.y),!0},j=function(e,i,n,s){var o=["0","auto"],r=(l-H)*n[0]/100,d=(c-H)*n[1]/100,h={left:o[i[0]],top:o[i[1]],right:o[i[2]],bottom:o[i[3]]},u={},p=90!=s&&-90!=s?V?-1:1:0,f=n[0]+"% "+n[1]+"%";A.css(h).transform(S(s)+y(e.x+p,e.y,B),f),t.fpage.css(h).transform(S(s)+y(e.x+W.x-D.x-l*n[0]/100,e.y+W.y-D.y-c*n[1]/100,B)+S((180/s-2)*s),f),t.wrapper.transform(y(-e.x+r-p,-e.y+d,B)+S(-s),f),t.fwrapper.transform(y(-e.x+D.x+r,-e.y+D.y+d,B)+S(-s),f),t.wrapper.css({position:""}),a.opts.gradients&&(n[0]&&(F.x=100-F.x),n[1]&&(F.y=100-F.y),u["box-shadow"]="0 0 20px rgba(0,0,0,"+.5*L+")",R.css(u),T(t.ashadow,b(V?100:0,U?0:100),b(F.x,F.y),[[M,"rgba(0,0,0,0)"],[.8*(1-M)+M,"rgba(0,0,0,"+.2*x+")"],[1,"rgba(255,255,255,"+.2*x+")"]],3),g._backGradient.call(A)&&T(t.bshadow,b(V?0:100,U?0:100),b(C.x,C.y),[[.6,"rgba(0,0,0,0)"],[.8,"rgba(0,0,0,"+.3*x+")"],[1,"rgba(0,0,0,0)"]],3))};switch(e.corner){case"l":case"r":break;case"tl":e.x=Math.max(e.x,1),$(),j(N,[1,0,0,1],[100,0],O);break;case"tr":e.x=Math.min(e.x,l-1),$(),j(b(-N.x,N.y),[0,0,0,1],[0,0],-O);break;case"bl":e.x=Math.max(e.x,1),$(),j(b(N.x,-N.y),[1,1,0,0],[100,100],-O);break;case"br":e.x=Math.min(e.x,l-1),$(),j(b(-N.x,-N.y),[0,1,1,0],[0,100],O)}}t.point=e},_moveFoldingPage:function(e){var t=this.data().f;if(t){var i=t.opts.turn,n=i.data(),s=n.pagePlace;if(e){var o=t.opts.next;if(s[o]!=t.opts.page)t.folding&&g._moveFoldingPage.call(this,!1),g._foldingPage.call(this).appendTo(t.fpage),s[o]=t.opts.page,t.folding=o;i.turn("update")}else if(t.folding){if(n.pages[t.folding]){var a=n.pages[t.folding].data().f;n.pageObjs[t.folding].appendTo(a.wrapper)}else n.pageWrap[t.folding]&&n.pageObjs[t.folding].appendTo(n.pageWrap[t.folding]);t.folding in s&&(s[t.folding]=t.folding),delete t.folding}}},_showFoldedPage:function(e,t){var i=g._foldingPage.call(this),n=this.data(),s=n.f,o=s&&s.visible||!1;if(i){if(!o||!s.point||s.point.corner!=e.corner){var a="hover"==s.status||"peel"==s.status||s.opts.turn.data().mouseAction?e.corner:null;if(o=!1,"prevented"==_("start",this,[s.opts,a]))return!1}if(t){var r=this,l=s.point&&s.point.corner==e.corner?s.point:g._c.call(this,e.corner,1);this.animatef({from:[l.x,l.y],to:[e.x,e.y],duration:500,frame:function(t){e.x=Math.round(t[0]),e.y=Math.round(t[1]),g._fold.call(r,e)}})}else g._fold.call(this,e),n.effect&&!n.effect.turning&&this.animatef(!1);if(!o)switch(s.effect){case"hard":s.visible=!0,g._moveFoldingPage.call(this,!0),s.fpage.show(),s.opts.shadows&&s.bshadow.show();break;case"sheet":s.visible=!0,s.fparent.show().data().flips++,g._moveFoldingPage.call(this,!0),s.fwrapper.show(),s.bshadow&&s.bshadow.show()}return!0}return!1},hide:function(){var e=this.data().f,t=e.opts.turn.data(),i=g._foldingPage.call(this);switch(e.effect){case"hard":t.opts.gradients&&(e.bshadowLoc=0,e.bshadow.remove(),e.ashadow.hide()),e.wrapper.transform(""),e.fpage.hide();break;case"sheet":0==--e.fparent.data().flips&&e.fparent.hide(),this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform(""),e.wrapper.transform(""),e.fwrapper.hide(),e.bshadow&&e.bshadow.hide(),i.transform("")}return e.visible=!1,this},hideFoldedPage:function(e){var t=this.data().f;if(t.point){var i=this,n=t.point,s=function(){t.point=null,t.status="",i.flip("hide"),i.trigger("end",[t.opts,!1])};if(e){var o=g._c.call(this,n.corner),a="t"==n.corner.substr(0,1)?Math.min(0,n.y-o.y)/2:Math.max(0,n.y-o.y)/2,r=b(n.x,n.y+a),l=b(o.x,o.y-a);this.animatef({from:0,to:1,frame:function(e){var t=v(n,r,l,o,e);n.x=t.x,n.y=t.y,g._fold.call(i,n)},complete:s,duration:800,hiding:!0})}else this.animatef(!1),s()}},turnPage:function(e){var t=this,i=this.data().f,n=i.opts.turn.data();e={corner:i.corner?i.corner.corner:e||g._cAllowed.call(this)[0]};var s=i.point||g._c.call(this,e.corner,i.opts.turn?n.opts.elevation:0),o=g._c2.call(this,e.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(i){var n=v(s,s,o,o,i);e.x=n.x,e.y=n.y,g._showFoldedPage.call(t,e)},complete:function(){t.trigger("end",[i.opts,!0])},duration:n.opts.duration,turning:!0}),i.corner=null},moving:function(){return"effect"in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},corner:function(){return this.data().f.corner},_eventStart:function(e){var t=this.data().f,i=t.opts.turn;if(!t.corner&&!t.disabled&&!this.flip("isTurning")&&t.opts.page==i.data().pagePlace[t.opts.page]){if(t.corner=g._isIArea.call(this,e),t.corner&&g._foldingPage.call(this))return this.trigger("pressed",[t.point]),g._showFoldedPage.call(this,t.corner),!1;t.corner=null}},_eventMove:function(e){var t=this.data().f;if(!t.disabled)if(e=a?e.originalEvent.touches:[e],t.corner){var i=t.parent.offset();t.corner.x=e[0].pageX-i.left,t.corner.y=e[0].pageY-i.top,g._showFoldedPage.call(this,t.corner)}else if(t.hover&&!this.data().effect&&this.is(":visible")){var n=g._isIArea.call(this,e[0]);if(n){if("sheet"==t.effect&&2==n.corner.length||"hard"==t.effect){t.status="hover";var s=g._c.call(this,n.corner,t.opts.cornerSize/2);n.x=s.x,n.y=s.y,g._showFoldedPage.call(this,n,!0)}}else"hover"==t.status&&(t.status="",g.hideFoldedPage.call(this,!0))}},_eventEnd:function(){var e=this.data().f,t=e.corner;!e.disabled&&t&&"prevented"!=_("released",this,[e.point||t])&&g.hideFoldedPage.call(this,!0),e.corner=null},disable:function(e){return g.setData.call(this,{disabled:e}),this},hover:function(e){return g.setData.call(this,{hover:e}),this},peel:function(t,i){var n=this.data().f;if(t){if(-1==e.inArray(t,l.all))throw P("Corner "+t+" is not permitted");if(-1!=e.inArray(t,g._cAllowed.call(this))){var s=g._c.call(this,t,n.opts.cornerSize/2);n.status="peel",g._showFoldedPage.call(this,{corner:t,x:s.x,y:s.y},i)}}else n.status="",g.hideFoldedPage.call(this,i);return this}};function f(e,t,i){if(i[0]&&"object"!=typeof i[0]){if(t[i[0]])return t[i[0]].apply(e,Array.prototype.slice.call(i,1));throw P(i[0]+" is not a method or property")}return t.init.apply(e,i)}function m(e,t,i,n){return{css:{position:"absolute",top:e,left:t,overflow:n||"hidden",zIndex:i||"auto"}}}function v(e,t,i,n,s){var o=1-s,a=o*o*o,r=s*s*s;return b(Math.round(a*e.x+3*s*o*o*t.x+3*s*s*o*i.x+r*n.x),Math.round(a*e.y+3*s*o*o*t.y+3*s*s*o*i.y+r*n.y))}function b(e,t){return{x:e,y:t}}function y(e,i,n){return t&&n?" translate3d("+e+"px,"+i+"px, 0px) ":" translate("+e+"px, "+i+"px) "}function S(e){return" rotate("+e+"deg) "}function w(e,t){return Object.prototype.hasOwnProperty.call(t,e)}function E(){for(var e=["Moz","Webkit","Khtml","O","ms"],t=e.length,i="";t--;)e[t]+"Transform"in document.body.style&&(i="-"+e[t].toLowerCase()+"-");return i}function T(e,t,i,s,o){var a,r=[];if("-webkit-"==n){for(a=0;a<o;a++)r.push("color-stop("+s[a][0]+", "+s[a][1]+")");e.css({"background-image":"-webkit-gradient(linear, "+t.x+"% "+t.y+"%,"+i.x+"% "+i.y+"%, "+r.join(",")+" )"})}else{t={x:t.x/100*e.width(),y:t.y/100*e.height()};var l=(i={x:i.x/100*e.width(),y:i.y/100*e.height()}).x-t.x,c=i.y-t.y,d=Math.atan2(c,l),h=d-Math.PI/2,u=Math.abs(e.width()*Math.sin(h))+Math.abs(e.height()*Math.cos(h)),p=Math.sqrt(c*c+l*l),g=b(i.x<t.x?e.width():0,i.y<t.y?e.height():0),f=Math.tan(d),m=-1/f,v=(m*g.x-g.y-f*t.x+t.y)/(m-f),y={x:v,y:m*v-m*g.x+g.y},S=Math.sqrt(Math.pow(y.x-t.x,2)+Math.pow(y.y-t.y,2));for(a=0;a<o;a++)r.push(" "+s[a][1]+" "+100*(S+p*s[a][0])/u+"%");e.css({"background-image":n+"linear-gradient("+-d+"rad,"+r.join(",")+")"})}}function _(t,i,n){var s=e.Event(t);return i.trigger(s,n),s.isDefaultPrevented()?"prevented":s.isPropagationStopped()?"stopped":""}function P(e){function t(e){this.name="TurnJsError",this.message=e}return t.prototype=new Error,t.prototype.constructor=t,new t(e)}function I(e){var t={top:0,left:0};do{t.left+=e.offsetLeft,t.top+=e.offsetTop}while(e=e.offsetParent);return t}function F(e,t,i,n){e&&t&&(i?(t.css({overflow:"hidden","clip-path":"","-webkit-clip-path":""}),setTimeout((function(){e.parent().css("overflow","hidden"),_("afterOverflowEnabled",t,n)}),1)):(t.css({overflow:"","clip-path":"polygon(-100% 0, 100% 0, 100% 100%, -100% 100%)","-webkit-clip-path":"polygon(-100% 0, 100% 0, 100% 100%, -100% 100%)"}),setTimeout((function(){e.parent().css("overflow",""),_("afterOverflowDisabled",t,n)}),1)))}window.requestAnim=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},e.extend(e.fn,{flip:function(){return f(e(this[0]),g,arguments)},turn:function(){return f(e(this[0]),p,arguments)},transform:function(e,t){var i={};return t&&(i[n+"transform-origin"]=t),i[n+"transform"]=e,this.css(i)},animatef:function(t){var i=this.data();if(i.effect&&i.effect.stop(),t){t.to.length||(t.to=[t.to]),t.from.length||(t.from=[t.from]);for(var n=[],s=t.to.length,o=!0,a=this,r=(new Date).getTime(),l=function(){if(i.effect&&o){for(var e=[],c=Math.min(t.duration,(new Date).getTime()-r),d=0;d<s;d++)e.push(i.effect.easing(1,c,t.from[d],n[d],t.duration));t.frame(1==s?e[0]:e),c==t.duration?(delete i.effect,a.data(i),t.complete&&t.complete()):window.requestAnim(l)}},c=0;c<s;c++)n.push(t.to[c]-t.from[c]);i.effect=e.extend({stop:function(){o=!1},easing:function(e,t,i,n,s){return n*Math.sqrt(1-(t=t/s-1)*t)+i}},t),this.data(i),l()}else delete i.effect}}),e.isTouch=a,e.mouseEvents=r,e.cssPrefix=E,e.cssTransitionEnd=function(){var e,t=document.createElement("fakeelement"),i={transition:"transitionend",OTransition:"oTransitionEnd",MSTransition:"transitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in i)if(void 0!==t.style[e])return i[e]},e.findPos=I}(jQuery);var FontManager=Backbone.View.extend({initialize:function(){this.fontsLoaded=[],this.fontsToLoad=[],this.defaultFontName="Arimo",this.newFont={},this.fontTable={Arial:{fontFamily:"Arial,sans-serif",css:!1},Verdana:{fontFamily:"Verdana",css:!1},"EB Garamond":{fontFamily:"EB Garamond",css:'@import url("https://fonts.googleapis.com/css?family=EB+Garamond")'},"Lucida Sans Unicode":{fontFamily:"Lucida Sans Unicode",css:!1},Lato:{fontFamily:"Lato",css:'@import url("https://fonts.googleapis.com/css?family=Lato:400,700")'},"PT Sans":{fontFamily:"PT Sans",css:'@import url("https://fonts.googleapis.com/css?family=PT+Sans:400,700")'},Calibri:{fontFamily:"Calibri",css:!1},"Droid Sans":{fontFamily:"Droid Sans",css:'@import url("https://fonts.googleapis.com/css?family=Droid+Sans:400,700")'},"Proxima Nova Reg":{fontFamily:"Proxima Nova Reg,Arial,sans-serif",css:'@font-face{font-family:"Proxima Nova Reg";font-weight:400;src:url("//www.snacktools.com/files/common/fonts/ProximaNova-Reg-gz.eot?") format("embedded-opentype"),url("//www.snacktools.com/files/common/fonts/ProximaNova-Reg-gz.woff");}'},"Proxima Nova Thin":{fontFamily:"Proxima Nova Thin,Arial,sans-serif",css:'@font-face{font-family:"Proxima Nova Thin";font-weight:100;src:url("//www.snacktools.com/files/common/fonts/ProximaNova-Thin-gz.eot?") format("embedded-opentype"),url("//www.snacktools.com/files/common/fonts/ProximaNova-Thin-gz.otf") format("truetype");}'},"Proxima Nova Light":{fontFamily:"Proxima Nova Light,Arial,sans-serif",css:'@font-face{font-family:"Proxima Nova Light";font-weight:300;src:url("//www.snacktools.com/files/common/fonts/ProximaNova-Light-gz.eot?") format("embedded-opentype"),url("//www.snacktools.com/files/common/fonts/ProximaNova-Light-gz.otf") format("opentype");}'},"Proxima Nova Bold":{fontFamily:"Proxima Nova Bold,Arial,sans-serif",css:'@font-face{font-family:"Proxima Nova Bold";font-weight:700;src:url("//www.snacktools.com/files/common/fonts/ProximaNova-Bold-gz.eot?") format("embedded-opentype"),url("//www.snacktools.com/files/common/fonts/ProximaNova-Bold-gz.woff");}'},Oswald:{fontFamily:"Oswald",css:'@import url("https://fonts.googleapis.com/css?family=Oswald:300,700")'},Lobster:{fontFamily:"Lobster",css:'@import url("https://fonts.googleapis.com/css?family=Lobster")'},"Open Sans":{fontFamily:"Open Sans",css:'@import url("https://fonts.googleapis.com/css?family=Open+Sans:400,700")'},"Mouse Memoirs":{fontFamily:"Mouse Memoirs",css:'@import url("https://fonts.googleapis.com/css?family=Mouse+Memoirs")'},"Just Me Again Down Here":{fontFamily:"Just Me Again Down Here",css:'@import url("https://fonts.googleapis.com/css?family=Just+Me+Again+Down+Here")'},"Annie Use Your Telescope":{fontFamily:"Annie Use Your Telescope",css:'@import url("https://fonts.googleapis.com/css?family=Annie+Use+Your+Telescope")'},Roboto:{fontFamily:"Roboto",css:"@import url(https://fonts.googleapis.com/css?family=Roboto:300,400&subset=latin,greek-ext,greek,vietnamese,latin-ext,cyrillic)",weight:{normal:300,bold:400}},"Droid Serif":{fontFamily:"Droid Serif",css:"@import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700)"},"Fjalla One":{fontFamily:"Fjalla One",css:"@import url(https://fonts.googleapis.com/css?family=Fjalla+One)"},"Lato Light":{fontFamily:"Lato",css:"@import url(https://fonts.googleapis.com/css?family=Lato:300,400)",weight:{normal:300,bold:400}},Lora:{fontFamily:"Lora",css:"@import url(https://fonts.googleapis.com/css?family=Lora:400,700)"},"Open Sans Light":{fontFamily:"Open Sans",css:"@import url(https://fonts.googleapis.com/css?family=Open+Sans:300,400)",weight:{normal:300,bold:400}},Parisienne:{fontFamily:"Parisienne",css:"@import url(https://fonts.googleapis.com/css?family=Parisienne)"},"Playfair Display":{fontFamily:"Playfair Display",css:"@import url(https://fonts.googleapis.com/css?family=Playfair+Display:400,700)"},"Playfair Display Italic":{fontFamily:"Playfair Display",css:"@import url(https://fonts.googleapis.com/css?family=Playfair+Display:400italic,700italic)",italic:!0},"Roboto Slab":{fontFamily:"Roboto Slab",css:"@import url(https://fonts.googleapis.com/css?family=Roboto+Slab:400,700)"},Yellowtail:{fontFamily:"Yellowtail",css:"@import url(https://fonts.googleapis.com/css?family=Yellowtail)"},"Raleway Light":{fontFamily:"Raleway",css:"@import url(https://fonts.googleapis.com/css?family=Raleway:300&subset=latin,latin-ext)",weight:{normal:300}},"Raleway Light Italic":{fontFamily:"Raleway",css:"@import url(https://fonts.googleapis.com/css?family=Raleway:300italic&subset=latin,latin-ext)",weight:{normal:300},italic:!0},Raleway:{fontFamily:"Raleway",css:"@import url(https://fonts.googleapis.com/css?family=Raleway:400&subset=latin,latin-ext)",weight:{normal:400}},"Raleway Italic":{fontFamily:"Raleway",css:"@import url(https://fonts.googleapis.com/css?family=Raleway:400italic&subset=latin,latin-ext)",weight:{normal:400},italic:!0},"Raleway Medium":{fontFamily:"Raleway",css:"@import url(https://fonts.googleapis.com/css?family=Raleway:500&subset=latin,latin-ext)",weight:{normal:500}},"Raleway Medium Italic":{fontFamily:"Raleway",css:"@import url(https://fonts.googleapis.com/css?family=Raleway:500italic&subset=latin,latin-ext)",weight:{normal:500},italic:!0},"Raleway Bold":{fontFamily:"Raleway",css:"@import url(https://fonts.googleapis.com/css?family=Raleway:700&subset=latin,latin-ext)",weight:{normal:700}},"Raleway Bold Italic":{fontFamily:"Raleway",css:"@import url(https://fonts.googleapis.com/css?family=Raleway:700italic&subset=latin,latin-ext)",weight:{normal:700},italic:!0},"Raleway Extra-Bold":{fontFamily:"Raleway",css:"@import url(https://fonts.googleapis.com/css?family=Raleway:800&subset=latin,latin-ext)",weight:{normal:800}},"Raleway Extra-Bold Italic":{fontFamily:"Raleway",css:"@import url(https://fonts.googleapis.com/css?family=Raleway:800italic&subset=latin,latin-ext)",weight:{normal:800},italic:!0},"PT Serif":{fontFamily:"PT Serif",css:"@import url(https://fonts.googleapis.com/css?family=PT+Serif:400&subset=latin,cyrillic-ext,latin-ext,cyrillic)",weight:{normal:400}},"PT Serif Italic":{fontFamily:"PT Serif",css:"@import url(https://fonts.googleapis.com/css?family=PT+Serif:400italic&subset=latin,cyrillic-ext,latin-ext,cyrillic)",weight:{normal:400},italic:!0},"PT Serif Bold":{fontFamily:"PT Serif",css:"@import url(https://fonts.googleapis.com/css?family=PT+Serif:700&subset=latin,cyrillic-ext,latin-ext,cyrillic)",weight:{normal:700}},"PT Serif Bold Italic":{fontFamily:"PT Serif",css:"@import url(https://fonts.googleapis.com/css?family=PT+Serif:700italic&subset=latin,cyrillic-ext,latin-ext,cyrillic)",weight:{normal:700},italic:!0},Pacifico:{fontFamily:"Pacifico",css:"@import url(https://fonts.googleapis.com/css?family=Pacifico)"},"Quicksand Light":{fontFamily:"Quicksand",css:"@import url(https://fonts.googleapis.com/css?family=Quicksand:300)",weight:{normal:300}},Quicksand:{fontFamily:"Quicksand",css:"@import url(https://fonts.googleapis.com/css?family=Quicksand:400)",weight:{normal:400}},"Quicksand Bold":{fontFamily:"Quicksand",css:"@import url(https://fonts.googleapis.com/css?family=Quicksand:700)",weight:{normal:700}},"Abril Fatface":{fontFamily:"Abril Fatface",css:"@import url(https://fonts.googleapis.com/css?family=Abril+Fatface&subset=latin,latin-ext)"},"Great Vibes":{fontFamily:"Great Vibes",css:"@import url(https://fonts.googleapis.com/css?family=Great+Vibes&subset=latin,latin-ext)"},Sacramento:{fontFamily:"Sacramento",css:"@import url(https://fonts.googleapis.com/css?family=Sacramento&subset=latin,latin-ext)"},Limelight:{fontFamily:"Limelight",css:"@import url(https://fonts.googleapis.com/css?family=Limelight&subset=latin,latin-ext)"},"Gravitas One":{fontFamily:"Gravitas One",css:"@import url(https://fonts.googleapis.com/css?family=Gravitas+One&subset=latin,latin-ext)"},"Rozha One":{fontFamily:"Rozha One",css:"@import url(https://fonts.googleapis.com/css?family=Rozha+One&subset=latin,devanagari,latin-ext)"},"Mrs Sheppards":{fontFamily:"Mrs Sheppards",css:"@import url(https://fonts.googleapis.com/css?family=Mrs+Sheppards&subset=latin,latin-ext)"},Montserrat:{fontFamily:"Montserrat",css:"@import url(https://fonts.googleapis.com/css?family=Montserrat:400)",weight:{normal:400}},"Montserrat Bold":{fontFamily:"Montserrat",css:"@import url(https://fonts.googleapis.com/css?family=Montserrat:700)",weight:{normal:700}},"Josefin Sans Light":{fontFamily:"Josefin Sans",css:"@import url(https://fonts.googleapis.com/css?family=Josefin+Sans:300&subset=latin,latin-ext)",weight:{normal:300}},"Josefin Sans Light Italic":{fontFamily:"Josefin Sans",css:"@import url(https://fonts.googleapis.com/css?family=Josefin+Sans:300italic&subset=latin,latin-ext)",weight:{normal:300},italic:!0},"Josefin Sans":{fontFamily:"Josefin Sans",css:"@import url(https://fonts.googleapis.com/css?family=Josefin+Sans:400&subset=latin,latin-ext)",weight:{normal:400}},"Josefin Sans Italic":{fontFamily:"Josefin Sans",css:"@import url(https://fonts.googleapis.com/css?family=Josefin+Sans:400italic&subset=latin,latin-ext)",weight:{normal:400},italic:!0},"Josefin Sans Bold":{fontFamily:"Josefin Sans",css:"@import url(https://fonts.googleapis.com/css?family=Josefin+Sans:700&subset=latin,latin-ext)",weight:{normal:700}},"Josefin Sans Bold Italic":{fontFamily:"Josefin Sans",css:"@import url(https://fonts.googleapis.com/css?family=Josefin+Sans:700italic&subset=latin,latin-ext)",weight:{normal:700},italic:!0},"Hammersmith One":{fontFamily:"Hammersmith One",css:"@import url(https://fonts.googleapis.com/css?family=Hammersmith+One&subset=latin,latin-ext)"},"Cantora One":{fontFamily:"Cantora One",css:"@import url(https://fonts.googleapis.com/css?family=Cantora+One&subset=latin,latin-ext)"},Coustard:{fontFamily:"Coustard",css:"@import url(https://fonts.googleapis.com/css?family=Coustard)"},Glegoo:{fontFamily:"Glegoo",css:"@import url(https://fonts.googleapis.com/css?family=Glegoo&subset=latin,devanagari,latin-ext)"},"Julius Sans One":{fontFamily:"Julius Sans One",css:"@import url(https://fonts.googleapis.com/css?family=Julius+Sans+One&subset=latin,latin-ext)"},Merriweather:{fontFamily:"Merriweather",css:"@import url(https://fonts.googleapis.com/css?family=Merriweather&subset=latin,cyrillic-ext,latin-ext,cyrillic)"},Quando:{fontFamily:"Quando",css:"@import url(https://fonts.googleapis.com/css?family=Quando&subset=latin,latin-ext)"},Sanchez:{fontFamily:"Sanchez",css:"@import url(https://fonts.googleapis.com/css?family=Sanchez&subset=latin,latin-ext)"},Vidaloka:{fontFamily:"Vidaloka",css:"@import url(https://fonts.googleapis.com/css?family=Vidaloka)"},Alike:{fontFamily:"Alike",css:"@import url(https://fonts.googleapis.com/css?family=Alike)"},Antic:{fontFamily:"Antic",css:"@import url(https://fonts.googleapis.com/css?family=Antic)"},Arimo:{fontFamily:"Arimo",css:"@import url(https://fonts.googleapis.com/css?family=Arimo&subset=latin,greek,hebrew,vietnamese,cyrillic-ext,latin-ext,cyrillic,greek-ext)",weight:{normal:400}},"Arimo Italic":{fontFamily:"Arimo",css:"@import url(https://fonts.googleapis.com/css?family=Arimo:400italic&subset=latin,greek,hebrew,vietnamese,cyrillic-ext,latin-ext,cyrillic,greek-ext)",weight:{normal:400},italic:!0},"Arimo Bold":{fontFamily:"Arimo",css:"@import url(https://fonts.googleapis.com/css?family=Arimo:700&subset=latin,greek,hebrew,vietnamese,cyrillic-ext,latin-ext,cyrillic,greek-ext)",weight:{normal:700}},"Arimo Bold Italic":{fontFamily:"Arimo",css:"@import url(https://fonts.googleapis.com/css?family=Arimo:700italic&subset=latin,greek,hebrew,vietnamese,cyrillic-ext,latin-ext,cyrillic,greek-ext)",weight:{normal:700},italic:!0},Vollkorn:{fontFamily:"Vollkorn",css:"@import url(https://fonts.googleapis.com/css?family=Vollkorn)"},Allura:{fontFamily:"Allura",css:"@import url(https://fonts.googleapis.com/css?family=Allura&subset=latin,latin-ext)"},"Amatic SC":{fontFamily:"Amatic SC",css:"@import url(https://fonts.googleapis.com/css?family=Amatic+SC&subset=latin,latin-ext)"},Courgette:{fontFamily:"Courgette",css:"@import url(https://fonts.googleapis.com/css?family=Courgette&subset=latin,latin-ext)"},"Kaushan Script":{fontFamily:"Kaushan Script",css:"@import url(https://fonts.googleapis.com/css?family=Kaushan+Script&subset=latin,latin-ext)"},"Libre Baskerville":{fontFamily:"Libre Baskerville",css:"@import url(https://fonts.googleapis.com/css?family=Libre+Baskerville&subset=latin,latin-ext)"},"Fauna One":{fontFamily:"Fauna One",css:"@import url(https://fonts.googleapis.com/css?family=Fauna+One&subset=latin,latin-ext)"},"Fugaz One":{fontFamily:"Fugaz One",css:"@import url(https://fonts.googleapis.com/css?family=Fugaz+One)"},Monda:{fontFamily:"Monda",css:"@import url(https://fonts.googleapis.com/css?family=Monda&subset=latin,latin-ext)"},"Unica One":{fontFamily:"Unica One",css:"@import url(https://fonts.googleapis.com/css?family=Unica+One&subset=latin,latin-ext)"},"Gentium Basic":{fontFamily:"Gentium Basic",css:"@import url(https://fonts.googleapis.com/css?family=Gentium+Basic&subset=latin,latin-ext)"},"Old Standard TT":{fontFamily:"Old Standard TT",css:"@import url(https://fonts.googleapis.com/css?family=Old+Standard+TT)"},Questrial:{fontFamily:"Questrial",css:"@import url(https://fonts.googleapis.com/css?family=Questrial)"},"Vast Shadow":{fontFamily:"Vast Shadow",css:"@import url(https://fonts.googleapis.com/css?family=Vast+Shadow)"},"Playfair Display SC":{fontFamily:"Playfair Display SC",css:"@import url(https://fonts.googleapis.com/css?family=Playfair+Display+SC&subset=latin,latin-ext,cyrillic)"},Ultra:{fontFamily:"Ultra",css:"@import url(https://fonts.googleapis.com/css?family=Ultra)"},"Slabo 13px":{fontFamily:"Slabo 13px",css:"@import url(https://fonts.googleapis.com/css?family=Slabo+13px&subset=latin,latin-ext)"},"Alfa Slab One":{fontFamily:"Alfa Slab One",css:"@import url(https://fonts.googleapis.com/css?family=Alfa+Slab+One)"},"Gentium Book Basic":{fontFamily:"Gentium Book Basic",css:"@import url(https://fonts.googleapis.com/css?family=Gentium+Book+Basic&subset=latin,latin-ext)"},"Nixie One":{fontFamily:"Nixie One",css:"@import url(https://fonts.googleapis.com/css?family=Nixie+One)"},"Crimson Text":{fontFamily:"Crimson Text",css:"@import url(https://fonts.googleapis.com/css?family=Crimson+Text)"},Muli:{fontFamily:"Muli",css:"@import url(https://fonts.googleapis.com/css?family=Muli)"},Alice:{fontFamily:"Alice",css:"@import url(https://fonts.googleapis.com/css?family=Alice)"},Dosis:{fontFamily:"Dosis",css:"@import url(https://fonts.googleapis.com/css?family=Dosis&subset=latin,latin-ext)"},Cantarell:{fontFamily:"Cantarell",css:"@import url(https://fonts.googleapis.com/css?family=Cantarell)"}}},getFontUrl:function(e,t){var i=window.URLPaths.CONTENT_PATH.length?"/":"";return"admin"===e?window.URLPaths.LIBRARY_FONT_PATH:window.URLPaths.CONTENT_PATH+i+t+"/library/fonts/"},addFont:function(e,t,i){var n,s,o,a;if(-1===this.fontsLoaded.indexOf(e)&&-1===this.fontsToLoad.indexOf(e)){if(this.fontTable[e]||-1===e.indexOf("_")){var r=FSWidgetModel.gi().get("accountId");i&&(r=FSWidgetModel.gi().get("sirAccountId")||FSWidgetModel.gi().get("accountId")),a='@font-face {font-family: "'+e+'"; src: url("'+(s=this.getFontUrl(t,r)+e)+'"); }',this.newFont[e]={fontFamily:e,css:a}}else n=e.split("_"),s=URLPaths.FONT_PATH+n[n.length-1],a='@font-face {font-family: "'+(o=n[n.length-1].substr(0,30))+'"; src: url("'+s+'"); }',this.fontTable[e]={fontFamily:o,css:a};this.fontsToLoad.push(e)}},loadFonts:function(){for(var e,t,i="";this.fontsToLoad.length>0;)i="",(t=this.fontsToLoad.pop())&&!this.fontTable[t]?e=this.newFont[t]:(this.fontTable[t]||this.fontTable[this.defaultFontName])&&(e=this.fontTable[t]||this.fontTable[this.defaultFontName]),e.css&&(i+=e.css),this.fontsLoaded.push(t),i.length>0&&(i='<style type="text/css">'+i+"</style>",$("head").prepend(i))},getFontSettings:function(e){return this.fontTable[e]?this.fontTable[e]:{fontFamily:e}},getFontFamily:function(e){return this.getFontSettings(e).fontFamily},getFontWeight:function(e,t){var i=this.getFontSettings(e),n=t;return void 0!==i.weight&&(n=t&&"normal"!==t?i.weight.bold:i.weight.normal),n},getFontStyle:function(e){return this.getFontSettings(e).italic?"italic":"normal"}});FontManager._instance=null,FontManager.gi=function(){return FontManager._instance||(FontManager._instance=new FontManager),FontManager._instance};var Tracker={gtag:function(e,t,i,n){!FSWidgetModel.gi().get("isDownload")&&window&&window.gtag&&"function"==typeof window.gtag&&gtag("event",t,{event_category:e,event_label:i,value:n,non_interaction:!0,send_to:"clientTracker"})}},MAIN_CONTAINER_ID="fsw",CSS_RULES_ID="fsw-style",DisplayState={NORMAL:"displayStateNormal",FULLSCREEN:"displayStateFullScreen",CLASSIC_FULLSCREEN:"displayStateClassicFullScreen"},DisplayType={LARGE:"large",SMALL:"small"},WidgetType={CLASSIC:"classic",SHELF:"shelf"},CollectionType={PUBLISHED:"published",EDITABLE:"editable",TEMPORARY:"temporary"},FlipbookVisibilityType={PUBLIC:"PUBLIC",UNLISTED:"UNLISTED",PRIVATE:"PRIVATE",PRIVATE_EMAIL:"PRIVATE_EMAIL",PRIVATE_SSO:"PRIVATE_SSO",SHARED_TEAM:"SHARED_TEAM"},PageType={EMPTY_PAGE:-1,UPLOADED_PAGE:0,CUSTOM_PAGE:1,MOVED_PAGE:3},WATERMARK_PAGE_LIMIT=30,WATERMARK_ITEM_LIMIT=3,WidgetStateType={INITIALIZING:"initializing",INITIALIZED:"initialized",BLOCKED_BY_FORM:"blockedByForm",PAYPAL_POPIN_DISPLAYED:"paypalDisplayed",IDLE:"idle",CHANGING_PAGE:"changingPage",CHANGING_ITEM:"changingItem",SEARCHING:"searching"},ImageExtensions=["jpg","png"],ImageTypes={THUMB:"thumb",SMALL:"small",MEDIUM:"medium",ORIGINAL:"original"},ImageSizeAppend={thumb:"_t",small:"_s",medium:"_m",original:""},DefaultPageSize={WIDTH:827,HEIGHT:1170},ImageSizes={thumb:{WIDTH:200,HEIGHT:200},small:{WIDTH:400,HEIGHT:400},medium:{WIDTH:900,HEIGHT:900}},MaxShelfThumbItemWidth=150,ControlsResize={MIN_WIDTH:800,MAX_WIDTH:1366},ContentLoaderStatus={IDLE:"idle",LOADING:"loading",ERROR:"error",COMPLETE:"complete"},ComponentContainers={MAIN_LAYOUT:"#mainLayout",MAIN_VIEW:"#mainView",THUMBNAIL_VIEW:"#thumbnailView",COLLECTION_VIEW:"#collectionView",MENU:"#menu",BOTTOM_BAR:"#bottomBar",FLIP_VIEW:"#flipView",SLIDER_VIEW:"#slideView",CLICK_TO_READ:"clickToRead",CUSTOM_TOOLTIP:"#genericElements",LEAD_FORM:"leadForm",SHELF_VIEW:"#shelfView",NAV_SLIDER:"#navSlider",BUY_BUTTON:"buyButton",BUY_CURTAIN:"#buyCurtain",PLAYER_MENU:"#playerMenu",AUTOMATOR_VIEW:"automatorView",ACCESSIBILITY_VIEW:"#accessibility"},ElementType={OUTLINE:0,CART:1,CREDIT_CARD:2,PLUS:3,CART_TOOLTIP:4,CREDIT_CARD_TOOLTIP:5,PLUS_TOOLTIP:6,FACEBOOK:7,TWITTER:8,LINKEDIN:9,YOUTUBE:10,FLICKR:11,GOOGLE_PLUS:12,PINTEREST:13,SOUNDCLOUD:14,VIMEO:15,ETSY:16,WEBSITE:17,PREVIOUS_PAGE:18,NEXT_PAGE:19,FIRST_PAGE:20,LAST_PAGE:21,PAGE:22,DOWNLOAD:23,FLIPSNACK_PROFILE:24,CHECKMARK:25,HYPERLINK:26,MAIL:27,TEXT:28,CAPTION:29,PLAY:30,AUDIO:31,CHAT:32,PAYPAL:33,PAYPAL_TOOLTIP:34,FORM:35,IMAGE:37,VIDEO:46,TAG:48,INSTAGRAM:49,SHAPES:50,MASKED:51,TEXT_BOX:53,PRODUCT_TAG:54,BEHANCE:55,SPOTIFY:56,CART_WITH_LABEL:57,CREDIT_CARD_WITH_LABEL:58,MESSENGER:59,SNAPCHAT:60,REDDIT:61,TIKTOK:62,TABLE:63,SLIDESHOW:67,ADD_CART:71,CART_HYPERLINK:72,GROUP:100,EMBED:101},OldAudioIcon={ON:"31",OFF:"137"},OldCaptionIcon={OPEN:"136",CLOSED:"29"},LeadFormField={FIELD_TYPE_INPUT:0,FIELD_TYPE_COUNTRY:1,FIELD_TYPE_CUSTOM_DROPDOWN:2,FIELD_TYPE_MDY_DATE:3,FIELD_TYPE_DMY_DATE:4,FIELD_TYPE_CHECKBOX:5,FIELD_TYPE_TEXTAREA:6,FIELD_TYPE_EMAIL:7,FIELD_TYPE_BIRTHDATE_MDY:8,FIELD_TYPE_BIRTHDATE_DMY:9},LeadFormElementEmail={name:"Email",type:"7",mandatory:"1"},LeadFormBlocking={PAGE:"page",ALL:"all"},PremiumTypeLinks=[35],CLICKTOREAD_SHOW_INTERVAL=3e3,EDITOR_ALERTS={share:"showShareMsg",download:"showDownloadMsg",print:"showPrintMsg"},VideoProvider={YOUTUBE:"youtube",VIMEO:"vimeo",PIXABAY:"pixabay",PEXELS:"pexels",OTHER:"other"},IFRAME_LOAD_MESSAGE="widgetLoaded",DEFAULT_ZOOM_STEP=5,DEFAULT_TEXT_LINE_HEIGHT=1.2,DEFAULT_TEXT_LETTER_SPACING=0,DEFAULT_BORDER_RADIUS=0,TextDirection={LEFT_TO_RIGHT:"ltr",RIGHT_TO_LEFT:"rtl"},DOWNLOAD_PDF_SUFFIX="download-pdf",PRINT_PDF_SUFFIX="print-pdf",PAGE_TURN_DURATION=1e3,WidgetSkinType={CLASSIC:"classic",PLAYER:"player"},ContentLayout={SINGLE_PAGE:"singlePage",DOUBLE_PAGE:"doublePage",SMART_VIEW:"smartView"},SourcePage={LEFT:"left",RIGHT:"right"},PRIVATE_FLIPBOOKS="private",PasswordEncryptionVersion={NONE:0,V1:1,V2:2},WidgetEvent={STARTUP:"startup",INIT_CONFIG:"initConfig",CONFIG_DONE:"configDone",RESIZE:"resize",DISPLAY_STATE_CHANGE:"displayStateChange",ITEM_VIEW_INIT:"itemViewInit",ITEM_INIT:"itemInit",ITEM_CHANGED:"itemChanged",PREV_ITEM:"prevItem",NEXT_ITEM:"nextItem",CHANGE_ITEM:"changeItem",PAGE_TURN_START:"pageTurnStart",PAGE_TURN_END:"pageTurnEnd",PAGE_TURN_CANCELED:"pageTurnCanceled",PAGE_CHANGED:"pageChanged",PREV_PAGE:"prevPage",NEXT_PAGE:"nextPage",CHANGE_PAGE:"changePage",AUTO_FLIP:"autoFlip",PASSWORD_POPIN_CLOSE:"passwordPopinClose",POPIN_OPEN:"popinOpen",POPIN_CLOSE:"popinClose",BEFORE_POPIN_CLOSE:"beforePopinClose",POPIN_RESIZE:"popinResize",ENTER_FULLSCREEN:"enterFullScreen",EXIT_FULLSCREEN:"exitFullScreen",FULLSCREEN_CHANGED:"fullScreen",RENDER_LAYOUT:"render-layout",WIDGET_CLICK_OR_TAP:"widgetClickOrTap",ZOOM_CHANGED:"zoomChanged",ZOOM_END:"zoomEnd",ZOOM_START:"zoomStart",MAX_ZOOM_CHANGED:"maxZoomChanged",CHANGE_ZOOM:"changeZoom",COLLECTION_PAGE_CHANGED:"collection-view:page-changed",OPEN_SHARE_OPTIONS:"options-panel-share:open",CLOSE_SHARE_OPTIONS:"options-panel-share:close",OPEN_ZOOM_OPTIONS:"options-zoom:open",CLOSE_ZOOM_OPTIONS:"options-zoom:close",OPEN_DOWNLOAD_OPTIONS:"options-panel-download:open",CLOSE_DOWNLOAD_OPTIONS:"options-panel-download:close",OPEN_SEARCH_OPTIONS:"options-panel-search:open",CLOSE_SEARCH_OPTIONS:"options-panel-search:close",CLOSE_DROP_DOWN_OPTIONS:"options-panel:close",CHANGE_SEARCH_STATE:"search:change-state",SEARCH_TEXTS_LOADED:"search:textjs-loaded",CLEAR_SEARCH:"search:clear",MUTE:"sound:off",UN_MUTE:"sound:on",SEND_EMAIL:"sendMail",SEND_SQS_MAIL:"sendSQSMail",CUSTOM_VIEW_LOADED:"customViewLoaded",HYPERLINK:"openLink",MOUSE_OVER_PAGE:"mouseOverPage",MOUSE_OUT_PAGE:"mouseOutPage",COUNTRIES_LOADED:"countriesLoaded",LEAD_FORM_SENT:"leadFormSent",LEAD_FORM_OPENED:"leadFormOpened",LEAD_FORM_CLOSED:"leadFormClosed",LEAD_FORM_INPUT_FOCUS:"leadFormInputFocus",LEAD_FORM_INPUT_KEYPRESS:"leadFormInputKeypress",SEND_LEAD_FORM:"sendLeadForm",PDF_LINKS_LOADED:"hyperlinks-loaded",WIDGET_VIEW_INIT:"widget-view-init",DESTROY:"widget-detroy",STOP_AUTOHIDE:"stopAutoHide",START_AUTOHIDE:"startAutoHide",AUTOHIDE_CONTROLS:"controllersHide",PREVIEW_PAGES_UPDATED:"previewPagesUpdated",CHANGE_SHELF_COLOR:"changeShelfColor",OPEN_TOC:"table-of-contents:open",CLOSE_TOC:"table-of-contents:close",DESELECT_TABLE_ROW:"table-of-contents:deselect",CHANGE_LANGUAGE:"changeLanguage",OPEN_PRODUCT_TAG_POPIN:"openProductTagPopin",CLOSE_PRODUCT_TAG_POPIN:"closeProductTagPopin",SCALE_PRODUCT_TAG_POPIN:"scaleProductTagPopin",OPEN_AUTOMATOR:"openAutomator",CLOSE_AUTOMATOR:"closeAutomator",OPEN_ACCESSIBILITY:"openAccessibility",CLOSE_ACCESSIBILITY:"closeAccessibility",OPEN_SPOTLIGHT_POPIN:"openSpotlightPopin",CLOSE_SPOTLIGHT_POPIN:"closeSpotlightPopin",SCALE_SPOTLIGHT_POPIN:"scaleSpotlightPopin",OPEN_POPUP_FRAME:"openPopupFrame",CLOSE_POPUP_FRAME:"closePopupFrame",SCALE_POPUP_FRAME:"scalePopupFrame"},StatsEvents={REGISTER:"stats-register-event",REGISTER_COLLECTION_VIEW:"stats-register-collection-view",SEND_STATS:"stats-send"},Stats=Backbone.Model.extend({initialize:function(){this.queue=[],this.pingInterval=null,this.deviceType=this.getDeviceType(),this.referrerType=this.getReferrerType(),this.lastRequestTime=null,this.canPing=!1,this.firstViewSent=!1,this.impressionSent=!1,this.setupPing(),this.registerEvent([{eid:Stats.TYPE.IMPRESSION}]),this.impressionSent=!0,Backbone.Mediator.sub(StatsEvents.REGISTER,this.registerEvent,this),Backbone.Mediator.sub(StatsEvents.REGISTER_COLLECTION_VIEW,this.registerViewEvent,this),Backbone.Mediator.sub(WidgetEvent.PASSWORD_POPIN_CLOSE,this.registerViewEvent,this),FSWidgetModel.gi().get("collectionData").security||$(document).on("click",this,this.registerViewEvent)},registerViewEvent:function(e){var t=e?e.data:this;t.firstViewSent||(t.canPing=!0,t.firstViewSent=!0,t.addToQueue([{eid:Stats.TYPE.VIEW,d:t.deviceType,s:t.referrerType}]),t.sendStats(),$(document).off("click",t.registerViewEvent))},getCurrentPid:function(){var e=FSWidgetModel.gi().widgetState.get("currentPageIndex");return FSWidgetModel.gi().widgetState.get("currentItem").get("pages").at(e).get("pID")},registerEvent:function(e){var t=e;e.eid&&(t=[e]),this.addToQueue(t)},addToQueue:function(e){var t=!1,i=new Date,n=this;e&&$.each(e,(function(e,i){i.eid===Stats.TYPE.IMPRESSION&&(t=!0),n.queue.push(i)})),i.getTime()-this.lastRequestTime>Stats.EVENTS_FREQUENCY&&(t=!0),t&&this.sendStats()},clearQueue:function(){this.queue=[]},sendStats:function(){var e,t=new Date,i=Math.max(t-this.lastRequestTime,0),n=Math.max(Stats.EVENTS_PING_TIMER+1e3,0),s=i<n?i:n,o=FSWidgetModel.gi().get("shelfData")&&FSWidgetModel.gi().get("shelfData").get("itemOpened")?FSWidgetModel.gi().get("shelfData").get("itemHash"):FSWidgetModel.gi().get("collectionHash");if(!(document.hidden||FSWidgetModel.gi().get("blockEvents")||t.getTime()-this.lastRequestTime<Stats.EVENTS_FREQUENCY)){if(clearInterval(this.pingInterval),this.impressionSent){if(!this.firstViewSent)return;this.addTimeEvents(s)}e={ih:FlipSnackEmbed.impressionHash,ch:o,cih:FSWidgetModel.gi().widgetState.get("currentItem").get("hash"),e:this.queue,ts:Math.floor(t.getTime()/1e3)},FSWidgetModel.gi().get("readerHash")&&$.extend(e,{rh:FSWidgetModel.gi().get("readerHash")}),Backbone.Mediator.pub(StatsEvents.SEND_STATS,e),this.lastRequestTime=t.getTime(),this.clearQueue(),this.setupPing()}},addTimeEvents:function(e){var t,i=FSWidgetModel.gi().widgetState.get("currentPageIndex"),n=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").length,s=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").at(i);this.queue.push({eid:Stats.TYPE.TIME,t:e}),s.get("pID")&&this.queue.push({eid:Stats.TYPE.TIME_PAGE,pid:s.get("pID"),t:e}),i>0&&i<n-1&&(t=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").at(i+1)).get("pID")&&this.queue.push({eid:Stats.TYPE.TIME_PAGE,pid:t.get("pID"),t:e})},setupPing:function(){var e=this;this.canPing&&(this.pingInterval=setInterval((function(){e.addToQueue(),e.sendPingRequest()}),Stats.EVENTS_PING_TIMER))},sendPingRequest:function(){this.sendStats()},getPingData:function(){return{}},getDeviceType:function(){return FSUtils.isSmartphone()?Stats.DEVICE_MOBILE:FSUtils.isTablet()?Stats.DEVICE_TABLET:Stats.DEVICE_DESKTOP},getReferrerType:function(){for(var e,t=FlipSnackEmbed.referrer||"",i=["http(s?)://www.flipsnack.com","http(s?)://[a-z0-9.]*site.flipsnack.net","http(s?)://[a-z0-9.]*flipsnack.io"],n=["http(s?)://www.facebook.com"],s="facebook"===t,o=0,a=!1;!a&&o<i.length;){if(0===t.search(i[o])){a=!0;break}o++}if(!(e=a)&&!s){for(o=0,a=!1;!a&&o<n.length;)0===t.search(n[o])?a=!0:o++;a&&(s=a)}return s?Stats.REFERRER_SOCIAL:e?Stats.REFERRER_FLIPSNACK:Stats.REFERRER_EMBED}});Stats.TYPE={IMPRESSION:1,VIEW:2,TIME:3,DOWNLOAD_COLLECTION:4,DOWNLOAD_ITEM:5,VIEW_PAGE:6,CLICK_ELEMENT:7,CLICK_LINK:8,VIEW_ITEM:9,TIME_PAGE:10,PRINT:11},Stats.DEVICE_DESKTOP=0,Stats.DEVICE_TABLET=1,Stats.DEVICE_MOBILE=2,Stats.REFERRER_FLIPSNACK=0,Stats.REFERRER_SOCIAL=1,Stats.REFERRER_EMBED=2,Stats.EVENTS_FREQUENCY=500,Stats.EVENTS_PING_TIMER=5e3,Stats.HOVER_TIMER=2e3,Stats._instance=null,Stats.gi=function(){return Stats._instance||(Stats._instance=new Stats),Stats._instance};const Templates={wheelPreloader:'<div class="fswp-default-css"><div class="spinner"></div></div>',mainLayout:'<div id="mainLayout"><div id="accessibility" tabindex="1" /><div id="mainView"><div id="menu" /><div id="flipView" /><div id="slideView" /><div id="collectionView" /><div id="bottomBarContainer"><div id="navSlider" /><div id="fsw-watermark-bar" /></div><div id="genericElements" /></div><div id="buyCurtain" /><div id="shelfView" /><div id="toc-container" /></div>',automatorView:'<div class="automator-container"><button id="toggleProductsButton" class="button-blue"><span id="buttonLabel"><%- buttonLabel %></span> products (<%- productsCount %>)<img class="automator-arrow" src="<%- arrowSrc %>"></button><div class="products-container"></div></div>',automatorProduct:'<div class="automator-product product-<%- index %>"><% if (image_link) { %><div class="image-container"><img src="<%- image_link %>"></div><% } %><% if (title) { %><div class="product-title"><%- title %></div><% } %><div class="product-price"><%- sell_price %></div><div class="product-description"><% if (showReadMore) { %><span class="visible-description visible-<%- index %>"><%- visibleDescription %></span><span class="dots dots-<%- index %>">...</span><div data-index="<%- index %>" class="view-more more-<%- index %>">View more</div> <span class="hidden-description hidden-<%- index %>"><%- description %></span><div data-index="<%- index %>" class="view-less less-<%- index %>">View less</div> <% } else { %><%- description %><% } %></div><% if (link) { %><a class="button-blue product-button" href="<%- link %>" target="_blank" rel="nofollow noopener">Buy product</a><% } %></div>',playerLayout:'<div id="mainLayout"><div id="accessibility" tabindex="1" /><div id="mainView"><div id="genericElements" /><div id="bottomBarContainer"><div id="bottomBar"><div id="bottomBarTop"><div id="playerNavSlider" /></div><div id="bottomBarBottom" ><div id="bottomLeft" /><div id="bottomRight" /></div></div><div id="fsw-watermark-bar" /></div><div id="flip-container"><div id="flipView" /></div></div><div id="buyCurtain" /><div id="shelfView" /><div id="player-toc-container" /></div>',embedWatermark:'<div id="fsw-watermark"><img src="" alt="Flipsnack logo" /></div>',embedWatermarkBar:'<div id="fsw-powered"><div><span>Powered by</span><img src="" alt="Flipsnack logo" /></div><div><span>Try this</span>&nbsp;<a href="" target="_blank">flipbook maker</a></div></div>',simpleLoader:'<div class="fsw-simpleloader"><a><div class="vignette-layer"></div><img class="fsw-simpleimage" src="" /></a><div class="fsw-wheelpreloader" /></div>',clickToRead:'<div class="wrapper"><svg width="18" height="18" viewBox="0 0 30 30"><path fill="#FFF" d="M2 19H0v11h11v-2H2v-9zm-2-8h2V2h9V0H0v11zm28 17h-9v2h11V19h-2v9zM19 0v2h9v9h2V0H19z" opacity=".9"/></svg><span class="click-to-read"><%- label %></span></div>',pageContentPreLoader:'<div class="page-content-bar-loader"><div class="progress-bar"></div></div>',genericTooltip:'<div class="content"><span class="tooltip-text"><%- tooltipText %></span></div>',genericPopin:'<div class="popin-overlay" /><div class="popin-panel"><a class="btn-x">X</a><div class="popin-content"></div></div>',productTagPopin:'<div class="popin-overlay" /><div class="popin-panel"><div class="popin-content"></div></div>',productTagPopinContent:'<% if (media && media.length) { %><div class="left-section"><div class="image-container"><img src="" /></div> <% if (media.length > 1) { %><div class="product-images"></div> <% } %></div><% } %><div class="right-section"><div class="top-section"><div class="section-header"><div class="close-popin"><svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path d="M.167 1.817l1.65-1.65 11.55 11.55-1.65 1.65z"/><path d="M13.366 1.817l-1.65-1.65L.167 11.717l1.65 1.65z"/></svg></div></div><% if (title) { %><div class="title"><%- title %></div><% } %><% if (description) { %><div class="description"><%- description %></div><% } %></div><div class="bottom-section"><div class="price-container"><% if (price && !discountPrice) { %><div class="new"><%- price %></div><% } %><% if (price && discountPrice) { %><div class="old"><%- price %></div><% } %><% if (discountPrice) { %><div class="new"><%- discountPrice %></div><% } %></div><% if (url) { %><a class="button" target="_blank" rel="nofollow noopener" href="<%- url %>"><%- buttonLabel %></a><% } %></div></div>',leadForm:'<div class="form-main"><div class="form-container"><div class="form-header"><%- header %></div><div class="form-content"></div><div class="form-footer"><div class="form-required">(<span class="form-error">*</span>) <span class="footer-label"><%- labels.requiredFieldLabel %></span></div><div class="submit-button"><%- labels.buttonLabel %></div></div></div></div>',leadFormLabel:'<label class="form-label"><%- label %><% if (mandatory) { %> <span class="form-error">*</span><% } %></label>',leadFormError:'<div class="error-label"><%- error %></div>',leadFormInput:'<input type="<%- type %>" class="form-input input-border" spellcheck="false">',leadFormTextArea:'<textarea class="form-input input-border" spellcheck="false"></textarea>',leadFormDropDown:'<select class="form-input input-border"></select>',leadFormCheckbox:'<div class="cb-container"><input id="<%- id %>" type="checkbox" class="form-input"><label for="<%- id %>" class="form-cblabel"><%- label %></label></div>',pdfLinkTemplate:'<a href="<%- url %>" target="_blank" rel="nofollow noopener"></a>',passwordPopinTemplate:'<div class="main"><div class="content"><form class="password-container" autocomplete="off" onsubmit="return false;"><div class="title"><%- title %></div><div class="labels"><label for="password"><%- passwordLabel %></label><span id="error" class="hidden"><%- wrongPasswordLabel %></span><span class="clear"></span></div><div class="password-field"><input type="password" name="psw" id="password" spellcheck="false" tabindex="1" autocomplete="off" </div><input type="button" id="submit" value="<%- submitButtonLabel %>" /></form></div></div>',navSlider:'<div class="nav-slider-back" /><div class="nav-slider"><div class="slider-bar"/></div><div class="nav-slider-components"><div class="nav-slider-tooltip-container"><div class="nav-slider-thumb"></div><div class="nav-slider-tooltip"></div></div><div class="nav-slider-knob" /></div>',playerNavSlider:'<div class="nav-slider-back" /><div class="nav-slider"><div class="slider-bar"><div class="nav-slider-progress"/></div></div><div class="nav-slider-components"><div class="nav-slider-tooltip-container"><div class="nav-slider-thumb"><div class="nav-slider-tooltip"></div></div></div><div class="nav-slider-knob" /></div>',accessibilityButton:'<div class="accessibility-btn"><span><svg xmlns="http://www.w3.org/2000/svg" width="27" height="27"><path d="M13.5 0C20.956 0 27 6.044 27 13.5S20.956 27 13.5 27 0 20.956 0 13.5 6.044 0 13.5 0zm0 2C7.149 2 2 7.149 2 13.5S7.149 25 13.5 25 25 19.851 25 13.5 19.851 2 13.5 2zm7.528 5.9c.205.622-.105 1.272-.726 1.464-1.312.405-2.628.795-3.943 1.191-.298.09-.596.177-.892.273-.28.088-.474.32-.455.607.067 1.045.031 2.106.289 3.127.208.815.466 1.616.772 2.4.57 1.472 1.181 2.928 1.785 4.387.409.986-.39 1.686-1.067 1.641-.485-.031-.812-.295-1.014-.733-.688-1.493-1.38-2.986-2.073-4.477-.025-.05-.055-.094-.108-.187-.142.282-.266.52-.384.76a2141.81 2141.81 0 00-1.974 4.03c-.212.43-.683.679-1.139.604-.481-.078-.912-.506-.938-.982-.014-.23.022-.462.106-.677.805-1.922 1.623-3.84 2.282-5.819.247-.724.39-1.479.425-2.242.025-.595.08-1.188.115-1.783.02-.35-.122-.552-.456-.654-.916-.28-1.835-.555-2.752-.832-.702-.21-1.403-.416-2.102-.635-.548-.171-.824-.618-.773-1.216.04-.475.418-.851.957-.917.19-.024.384-.009.57.044 1.588.476 3.181.928 4.806 1.269 1.003.21 1.988.124 2.962-.134 1.427-.377 2.85-.77 4.268-1.179.594-.17 1.278.121 1.459.67zM13.686 3c1.166.004 2.139 1.007 2.132 2.195a2.177 2.177 0 01-2.213 2.169c-1.19-.007-2.156-.993-2.15-2.192.005-1.22.988-2.176 2.231-2.172z" fill="#000" fill-rule="nonzero"/></svg><label>Accessibility</label></span></div>',accessibilityPanel:'<div class="accessibility-panel"><div class="accessibility-zoom"><div class="accessibility-zoom-out"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="13"><path fill="#FFF" d="M2.47 13l1.037-2.98h4.957L9.51 13h2.32L6.987.203H4.992L.158 13H2.47zm5.37-4.772H4.13l1.855-5.31 1.855 5.31z"/></svg></div><div class="accessibility-zoom-in"><svg xmlns="http://www.w3.org/2000/svg" width="19" height="20"><path fill="#FFF" d="M3.842 20l1.613-4.635h7.711L14.793 20h3.61L10.868.094H7.766L.246 20h3.596zm8.353-7.424h-5.77l2.886-8.258 2.884 8.258z"/></svg></div></div><div class="accessibility-close-button"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14"><path d="M13.36.633c.39.39.39 1.02 0 1.41L8.41 6.998l4.951 4.957a.997.997 0 01-1.407 1.41L7 8.41l-4.953 4.956A.995.995 0 11.64 11.956L5.59 7 .64 2.042A.997.997 0 012.047.632L7 5.59 11.953.633a.995.995 0 011.407 0z" fill="#FFF" fill-rule="evenodd"/></svg></div><div class="accessibility-page-number" /><div class="accessibility-content"><div class="accessibility-content-title" /><div class="accessibility-content-description" /></div><div class="accessibility-page-control"><div class="accessibility-page-previous">< Previous page</div><div class="accessibility-page-next">Next page ></div></div></div>',accessibilityPageNumber:"<span>Page <%- currentPage %> of <%- totalPages %></span>",buyButton:'<% if (activeSubscription) { %><a class="buy-btn large-btn issue-btn" target="_blank" href="<%- buyLink %>?selected=flipbook"><%- singleFlipbook %> <span class="issue-btn"><%- price %></span></a><a class="buy-btn large-btn subscription-btn" target="_blank" href="<%- rollingSubscriptionLink %>"><%- rollingSubscriptionLabel %><span></span></a><% } else if (isInSubscription) { %><a class="buy-btn large-btn issue-btn" target="_blank" href="<%- buyLink %>?selected=flipbook"><%- singleFlipbook %> <span class="issue-btn"><%- price %></span></a><a class="buy-btn large-btn subscription-btn" target="_blank" href="<%- buyLink %>?selected=subscription"><%- buySubscription %> <%- subscriptionFlipbooks %> <%- issues %><span> <%- subscriptionPrice %></span></a><% } else { %><div class="buy-btn issue-btn"><a class="issue-btn" target="_blank" href="<%- buyLink %>"><%- buyLabel %> <span class="issue-btn"><%- price %></span></a></div><% } %>',buyCurtain:'<div class="curtain-top"><div class="full-screen-exit-btn"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 26 26"><g fill="#AAB2C3" fill-rule="nonzero"><path d="M15.3 13L25.5 2.8A1.6 1.6 0 1 0 23.2.5L13 10.7 2.8.5A1.6 1.6 0 1 0 .5 2.8L10.7 13 .5 23.2a1.6 1.6 0 1 0 2.3 2.3L13 15.3l10.2 10.2a1.6 1.6 0 0 0 2.3 0 1.6 1.6 0 0 0 0-2.3L15.3 13z"/> </g></svg></div></div><div class="curtain-main <% if (isPlayerSkin) { %>playerCurtain<% } %>"><div class="prev-btn"><% if (!isPlayerSkin) { %><svg class="nav-button" width="26" height="93" viewBox="0 0 36 93" xmlns="http://www.w3.org/2000/svg"><path class="nav-button" d="M29.958 0L0 46.035l29.958 46.02H36L6.042 46.035 36 0z" /></svg><% } else { %><svg xmlns="http://www.w3.org/2000/svg" width="25" height="47" viewBox="0 0 33 54"><path d="M.967 25.44l19.338 19.906c1.29 1.267 2.438 1.267 3.728 0 1.29-1.266 1.29-2.392 0-3.658L6.087 23.148l17.945-18.54c1.29-1.266 1.29-2.392 0-3.658-1.29-1.267-2.437-1.267-3.727 0L.967 20.856a3.2 3.2 0 000 4.584z" fill="#FFF" fill-rule="evenodd"/></svg><% } %></div><div class="curtain-body"><div class="publish-author">Published by <a class="author" href="<%- userUrl %>" target="_blank"><%- author %></a></div><div class="curtain-message"><%- message %></div><div class="flipbook-title"><%- title %></div><% if (showBuyButtons) { %><% if (isInSubscription) { %><div class="buy-btn large-btn issue-btn"><a class="issue-btn" target="_blank" href="<%- buyLink %>?selected=flipbook"><%- singleFlipbook %> <%- price %></a></div><div class="buy-btn large-btn subscription-btn"><a target="_blank" href="<%- buyLink %>?selected=subscription"><%- buySubscription %> <%- subscriptionFlipbooks %> <%- issues %> <%- subscriptionPrice %></a></div><% } else if (activeSubscription) { %><div class="buy-btn issue-btn"><a class="issue-btn" target="_blank" href="<%- buyLink %>"><%- buyLabel %> <%- price %></a></div><div class="buy-btn large-btn subscription-btn"><a target="_blank" href="<%- rollingSubscriptionLink %>"><%- rollingSubscriptionLabel %></a></div><% } else { %><div class="buy-btn issue-btn"><a class="issue-btn" target="_blank" href="<%- buyLink %>"><%- buyLabel %> <%- price %></a></div><% } %><% } %></div><div class="next-btn"><% if (!isPlayerSkin) { %><svg class="nav-button" width="26" height="93" viewBox="0 0 36 93" xmlns="http://www.w3.org/2000/svg"><path class="nav-button" d="M6.042 0L36 46.035 6.042 92.055H0l29.958-46.02L0 0z" /></svg><% } else { %><svg xmlns="http://www.w3.org/2000/svg" width="25" height="47" viewBox="0 0 33 54"><path d="M24.033 25.44L4.695 45.346c-1.29 1.267-2.438 1.267-3.728 0-1.29-1.266-1.29-2.392 0-3.658l17.946-18.54L.968 4.608C-.322 3.342-.322 2.216.968.95c1.29-1.267 2.437-1.267 3.727 0l19.338 19.906a3.2 3.2 0 010 4.584z" fill="#FFF" fill-rule="evenodd"/></svg><% } %></div></div>',spotlightPopin:'<div class="popin-overlay" /><div class="popin-panel"><div class="popin-content"></div></div>',spotlightImage:'<img src="<%- spotlightImageUrl %>" width="<%- width %>" height="<%- height %>" />',spotlightPlaceholder:'<div class="placeholder-container"><svg width="79" height="79" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.905.206h62.87a7.86 7.86 0 017.86 7.859v47.153a7.859 7.859 0 01-7.86 7.858H55.058L39.34 78.794 23.622 63.076H7.905a7.859 7.859 0 01-7.86-7.858V8.065a7.859 7.859 0 017.86-7.86zm0 7.859v47.153h18.979L39.34 67.674l12.456-12.456h18.98V8.065H7.904zm13.753 7.859a5.894 5.894 0 110 11.787 5.894 5.894 0 010-11.787zm-5.895 31.435l19.648-19.647 7.858 7.859 19.648-19.647v31.435H15.762z" fill="#000"/>\n</svg><p>Your spotlight has <br>no image set.</p></div>',closeSpotlightPopin:'<div class="close-popin"><svg width="14" height="14" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path d="M.167 1.817l1.65-1.65 11.55 11.55-1.65 1.65z"/><path d="M13.366 1.817l-1.65-1.65L.167 11.717l1.65 1.65z"/></svg></div>',popupFrame:'<div class="popin-overlay" /><div class="popin-panel"><div class="popin-content"></div></div>',popupFrameCode:'<iframe class="code-container"></iframe>',popupFramePlaceholder:'<div class="placeholder-container"><p>This code appears to be malformed or unsupported. Make sure you are copying the exact code that appears in your embed / share settings page.</p></div>'};!function(e){"use strict";window.FSUtils||(window.FSUtils={}),window.FSUtils={ua:navigator.userAgent.toLowerCase(),devicePixelRatio:window.devicePixelRatio||1,screenWidth:window.screen.width,screenHeight:window.screen.height,isWebkit:function(){var e=this.ua.match(/webkit/i);return e||(e=navigator.appVersion.match(/webkit/i)),e&&e.length>0},hasTouch:function(){return"ontouchstart"in window},isAndroid:function(){var e=this.ua.match(/android/i);return e&&e.length>0},isBlackBerry:function(){var e=this.ua.match(/blackberry/i);return e&&e.length>0},isIOS:function(){var e=this.ua.match(/iphone|ipad|ipod/i);return e&&e.length>0},isOpera:function(){var e=this.ua.match(/opera mini/i);return e&&e.length>0},isWindows:function(){var e=this.ua.match(/iemobile/i)||this.ua.match(/windows phone/i);return e&&e.length>0},isIE8:function(){return this.ua.search("msie 8")>-1||navigator.appVersion.search("msie 8")>-1},isIE9:function(){return this.ua.search("msie 9")>-1||navigator.appVersion.search("msie 9")>-1},isKindle:function(){var e=this.ua.match(/silk/i);return e&&e.length>0},isInFullScreen:function(){return FSWidgetModel.gi().widgetState.get("displayState")!==DisplayState.NORMAL},isMobileDevice:function(){var e=this.ua.match(/(iphone|ipod|ipad|android|windows phone|silk|blackberry|iemobile)/i);return!(!e||!e.length)||this.ua.indexOf("macintosh")>-1&&navigator.maxTouchPoints>0},isSmartphone:function(){var e=this.ua.match(/(iphone|ipod|android|windows phone|silk|blackberry|iemobile)/i),t=this.getScreenSize();return e&&e.length>0&&t.width<960&&t.height<960},isIpad:function(){var e=this.ua.match(/(ipod|ipad|macintosh|mac)/i);return!(!e||!e.length)&&navigator.maxTouchPoints>0},isTablet:function(){var e=this.ua.match(/(ipad|android|windows phone|silk|blackberry|iemobile)/i),t=this.getScreenSize();return e&&e.length>0&&(t.width>=960||t.height>=960)},isAndroidStockBrowser:function(){var e,t=!1,i=!1;return!!this.isAndroid()&&(t=(e=this.ua.match(/firefox/i))&&e.length>0,i=(e=this.ua.match(/chrome/i))&&e.length>0,!t&&!i)},isChrome:function(){var e=this.ua.match(/chrome/i);return e&&e.length>0},getScreenSize:function(){this.getAndroidVersion();var e=window.screen.width,t=window.screen.height;return this.isAndroidStockBrowser()&&(e/=devicePixelRatio,t/=devicePixelRatio),{width:e,height:t}},getAndroidVersion:function(){var e=this.ua.match(/android\s([0-9\.]*)/);return!!e&&e[1]},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},getTextSize:function(t,i){var n=t.replace(/(?:\r\n|\r|\n)/g,"<br />"),s=e("<span>").appendTo("body").html(n).css(i).css({position:"absolute",left:"-9999px"}),o={width:s[0].scrollWidth,height:s[0].scrollHeight};return s.remove(),o},calculatePageSize:function(e,t,i,n,s){var o=i/e,a=n/t;return s="function"==typeof s?s:Math.round,o>a?{width:e,height:s.call(this,n/o)}:{width:s.call(this,i/a),height:t}},calculateScaledSize:function(e,t,i,n,s){var o=e/i,a=t/n;return!s&&e<i&&t<n?{width:e,height:t}:o>a?{width:i,height:t/o}:{width:e/a,height:n}},calculateScale:function(e,t,i,n,s){return e/FSUtils.calculateScaledSize(e,t,i,n,s).width},getImageSizeType:function(e,t){return _.find(ImageTypes,(function(i){return ImageSizes[i]&&ImageSizes[i].WIDTH>=e&&ImageSizes[i].HEIGHT>=t}))||ImageTypes.ORIGINAL},elementCanBeDisplayed:function(e,t,i){return-1===t.indexOf(e)||i&&t.indexOf(e)>-1},getZoomLevel:function(){return Math.round(document.documentElement.clientWidth/window.innerWidth*100)/100},isVideo:function(e){return this.getVideoHash(e).length>0},getVideoHash:function(e){var t,i,n=[],s="";return"string"==typeof e&&e.length&&((e.indexOf("http://")<0||e.indexOf("https://")<0)&&(e="https://"+e),e.indexOf("://www.youtube.com/")>-1||e.indexOf("://youtube.com/")>-1?(n=e.split("v=")).length>1?(t=(s=n[1]).indexOf("&"))>-1&&(s=s.substring(0,t)):(n=e.split("/embed/")).length>1&&((i=(s=n[1]).indexOf("/"))>-1&&(s=s.substring(0,i)),(t=s.indexOf("&"))>-1&&(s=s.substring(0,t))):e.indexOf("://youtu.be/")>-1?(n=e.split("youtu.be/")).length>1&&(t=(s=n[1]).indexOf("&"))>-1&&(s=s.substring(0,t)):e.indexOf("vimeo.com/")>-1&&(n=e.match(/\/[0-9]+/gi))&&n.length&&(s=n[0].substr(1,n[0].length))),s},getVideoProvider:function(e,t){var i=t||"";return"string"==typeof e&&e.length?e.indexOf("youtube.com/")>-1||e.indexOf("youtu.be/")>-1?VideoProvider.YOUTUBE:e.indexOf("vimeo.com/")>-1?VideoProvider.VIMEO:i||VideoProvider.OTHER:null},getVideoExtraParams:function(e){var t;return"string"==typeof e&&e.length&&(t=e.split("?"))&&t[1]?t[1]:""},getUrlProtocol:function(e){var t=e.match(/(mailto(?=:))|^\w+(?=:\/\/)/gi);return t&&t.length>0?t[0]:""},urlHasProtocol:function(e){return["http","https","ftp","sftp","udp","mailto"].indexOf(this.getUrlProtocol(e.toLowerCase()))>=0},isEmailValid:function(e){return null!==("string"==typeof e&&e.length>0&&e.match(/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/gi))},isPortrait:function(){if(this.isMobileDevice()){if("number"==typeof window.orientation)return 0===Math.abs(window.orientation)||Math.abs(180===window.orientation);if(screen.orientation&&"number"==typeof screen.orientation.angle)return 0===Math.abs(screen.orientation.angle)||Math.abs(180===screen.orientation.angle)}return!1},getElementCSSTransform:function(e){var t,i,n,s,o,a,r,l;try{return n=0===(i=(t=getComputedStyle(e,null)).transform||t.webkitTransform||t.MozTransform||t.msTransform||t.OTransform).indexOf("matrix3d"),s=i.split("(")[1].split(")")[0].split(","),n?(o=parseInt(s[12],10),a=parseInt(s[13],10),r=parseFloat(s[0]),l=parseFloat(s[5])):(o=parseInt(s[4],10),a=parseInt(s[5],10),r=parseFloat(s[0]),l=parseFloat(s[3])),{x:o,y:a,scaleX:r,scaleY:l}}catch(e){return{x:0,y:0,scaleX:1,scaleY:1}}},colorToString:function(e){var t="string"==typeof e?e:"";return"number"==typeof e&&(t=e>16777215?"FFFFFF":e.toString(),t=e<0?"000000":t),3===(t=(t="#"===t.substr(0,1)?t.substr(1,t.length-1):t).length>6?"000000":t).length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),t.length<6&&(t=new Array(7-t.length).join("0")+t),"#"+t},compareArrays:function(e,t){var i=e.map((function(e){return e})),n=t.map((function(e){return e}));function s(e,t){return e-t}return i.sort(s),n.sort(s),i.length===n.length&&i.every((function(e,t){return e===n[t]}))},arrayDiff:function(e,t){return e.concat(t).filter((function(e,t,i){return i.indexOf(e)===i.lastIndexOf(e)}))},HASH:{hexcase:0,b64pad:"",chrsz:8,hex_md5:function(e){return this.binl2hex(this.core_md5(this.str2binl(e),e.length*this.chrsz))},b64_md5:function(e){return this.binl2b64(this.core_md5(this.str2binl(e),e.length*this.chrsz))},str_md5:function(e){return this.binl2str(this.core_md5(this.str2binl(e),e.length*this.chrsz))},hex_hmac_md5:function(e,t){return this.binl2hex(this.core_hmac_md5(e,t))},b64_hmac_md5:function(e,t){return this.binl2b64(this.core_hmac_md5(e,t))},str_hmac_md5:function(e,t){return this.binl2str(this.core_hmac_md5(e,t))},md5_vm_test:function(){return"900150983cd24fb0d6963f7d28e17f72"===this.hex_md5("abc")},core_md5:function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var i=1732584193,n=-271733879,s=-1732584194,o=271733878,a=0;a<e.length;a+=16){var r=i,l=n,c=s,d=o;i=this.md5_ff(i,n,s,o,e[a+0],7,-680876936),o=this.md5_ff(o,i,n,s,e[a+1],12,-389564586),s=this.md5_ff(s,o,i,n,e[a+2],17,606105819),n=this.md5_ff(n,s,o,i,e[a+3],22,-1044525330),i=this.md5_ff(i,n,s,o,e[a+4],7,-176418897),o=this.md5_ff(o,i,n,s,e[a+5],12,1200080426),s=this.md5_ff(s,o,i,n,e[a+6],17,-1473231341),n=this.md5_ff(n,s,o,i,e[a+7],22,-45705983),i=this.md5_ff(i,n,s,o,e[a+8],7,1770035416),o=this.md5_ff(o,i,n,s,e[a+9],12,-1958414417),s=this.md5_ff(s,o,i,n,e[a+10],17,-42063),n=this.md5_ff(n,s,o,i,e[a+11],22,-1990404162),i=this.md5_ff(i,n,s,o,e[a+12],7,1804603682),o=this.md5_ff(o,i,n,s,e[a+13],12,-40341101),s=this.md5_ff(s,o,i,n,e[a+14],17,-1502002290),n=this.md5_ff(n,s,o,i,e[a+15],22,1236535329),i=this.md5_gg(i,n,s,o,e[a+1],5,-165796510),o=this.md5_gg(o,i,n,s,e[a+6],9,-1069501632),s=this.md5_gg(s,o,i,n,e[a+11],14,643717713),n=this.md5_gg(n,s,o,i,e[a+0],20,-373897302),i=this.md5_gg(i,n,s,o,e[a+5],5,-701558691),o=this.md5_gg(o,i,n,s,e[a+10],9,38016083),s=this.md5_gg(s,o,i,n,e[a+15],14,-660478335),n=this.md5_gg(n,s,o,i,e[a+4],20,-405537848),i=this.md5_gg(i,n,s,o,e[a+9],5,568446438),o=this.md5_gg(o,i,n,s,e[a+14],9,-1019803690),s=this.md5_gg(s,o,i,n,e[a+3],14,-187363961),n=this.md5_gg(n,s,o,i,e[a+8],20,1163531501),i=this.md5_gg(i,n,s,o,e[a+13],5,-1444681467),o=this.md5_gg(o,i,n,s,e[a+2],9,-51403784),s=this.md5_gg(s,o,i,n,e[a+7],14,1735328473),n=this.md5_gg(n,s,o,i,e[a+12],20,-1926607734),i=this.md5_hh(i,n,s,o,e[a+5],4,-378558),o=this.md5_hh(o,i,n,s,e[a+8],11,-2022574463),s=this.md5_hh(s,o,i,n,e[a+11],16,1839030562),n=this.md5_hh(n,s,o,i,e[a+14],23,-35309556),i=this.md5_hh(i,n,s,o,e[a+1],4,-1530992060),o=this.md5_hh(o,i,n,s,e[a+4],11,1272893353),s=this.md5_hh(s,o,i,n,e[a+7],16,-155497632),n=this.md5_hh(n,s,o,i,e[a+10],23,-1094730640),i=this.md5_hh(i,n,s,o,e[a+13],4,681279174),o=this.md5_hh(o,i,n,s,e[a+0],11,-358537222),s=this.md5_hh(s,o,i,n,e[a+3],16,-722521979),n=this.md5_hh(n,s,o,i,e[a+6],23,76029189),i=this.md5_hh(i,n,s,o,e[a+9],4,-640364487),o=this.md5_hh(o,i,n,s,e[a+12],11,-421815835),s=this.md5_hh(s,o,i,n,e[a+15],16,530742520),n=this.md5_hh(n,s,o,i,e[a+2],23,-995338651),i=this.md5_ii(i,n,s,o,e[a+0],6,-198630844),o=this.md5_ii(o,i,n,s,e[a+7],10,1126891415),s=this.md5_ii(s,o,i,n,e[a+14],15,-1416354905),n=this.md5_ii(n,s,o,i,e[a+5],21,-57434055),i=this.md5_ii(i,n,s,o,e[a+12],6,1700485571),o=this.md5_ii(o,i,n,s,e[a+3],10,-1894986606),s=this.md5_ii(s,o,i,n,e[a+10],15,-1051523),n=this.md5_ii(n,s,o,i,e[a+1],21,-2054922799),i=this.md5_ii(i,n,s,o,e[a+8],6,1873313359),o=this.md5_ii(o,i,n,s,e[a+15],10,-30611744),s=this.md5_ii(s,o,i,n,e[a+6],15,-1560198380),n=this.md5_ii(n,s,o,i,e[a+13],21,1309151649),i=this.md5_ii(i,n,s,o,e[a+4],6,-145523070),o=this.md5_ii(o,i,n,s,e[a+11],10,-1120210379),s=this.md5_ii(s,o,i,n,e[a+2],15,718787259),n=this.md5_ii(n,s,o,i,e[a+9],21,-343485551),i=this.safe_add(i,r),n=this.safe_add(n,l),s=this.safe_add(s,c),o=this.safe_add(o,d)}return[i,n,s,o]},md5_cmn:function(e,t,i,n,s,o){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(n,o)),s),i)},md5_ff:function(e,t,i,n,s,o,a){return this.md5_cmn(t&i|~t&n,e,t,s,o,a)},md5_gg:function(e,t,i,n,s,o,a){return this.md5_cmn(t&n|i&~n,e,t,s,o,a)},md5_hh:function(e,t,i,n,s,o,a){return this.md5_cmn(t^i^n,e,t,s,o,a)},md5_ii:function(e,t,i,n,s,o,a){return this.md5_cmn(i^(t|~n),e,t,s,o,a)},core_hmac_md5:function(e,t){var i=this.str2binl(e);i.length>16&&(i=this.core_md5(i,e.length*this.chrsz));for(var n=[16],s=[16],o=0;o<16;o++)n[o]=909522486^i[o],s[o]=1549556828^i[o];var a=this.core_md5(n.concat(this.str2binl(t)),512+t.length*this.chrsz);return this.core_md5(s.concat(a),640)},safe_add:function(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i},bit_rol:function(e,t){return e<<t|e>>>32-t},str2binl:function(e){for(var t=[],i=(1<<this.chrsz)-1,n=0;n<e.length*this.chrsz;n+=this.chrsz)t[n>>5]|=(e.charCodeAt(n/this.chrsz)&i)<<n%32;return t},binl2str:function(e){for(var t="",i=(1<<this.chrsz)-1,n=0;n<32*e.length;n+=this.chrsz)t+=String.fromCharCode(e[n>>5]>>>n%32&i);return t},binl2hex:function(e){for(var t=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",i="",n=0;n<4*e.length;n++)i+=t.charAt(e[n>>2]>>n%4*8+4&15)+t.charAt(e[n>>2]>>n%4*8&15);return i},binl2b64:function(e){for(var t="",i=0;i<4*e.length;i+=3)for(var n=(e[i>>2]>>i%4*8&255)<<16|(e[i+1>>2]>>(i+1)%4*8&255)<<8|e[i+2>>2]>>(i+2)%4*8&255,s=0;s<4;s++)8*i+6*s>32*e.length?t+=this.b64pad:t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6*(3-s)&63);return t}},cssRules:{_rules:{},_generateCssRules:function(){var t=e('<style type="text/css" id="'+CSS_RULES_ID+'" />');this._removeCssRules(),e("head").append(t),this.cssRuleContainer=e("#"+CSS_RULES_ID),this._appendRules()},_appendRules:function(){var t=this;e.each(t._rules,(function(e,i){t.cssRuleContainer.append(i)}))},_removeCssRules:function(){this.cssRuleContainer=e("#"+CSS_RULES_ID),this.cssRuleContainer.length&&this.cssRuleContainer.remove()},_addRule:function(t,i,n){var s="\n#"+MAIN_CONTAINER_ID+" "+i+" {\n";e.each(n,(function(e,t){s+="    "+e+":"+t+";\n"})),s+="}\n",this._rules[t]=s},add:function(e,t,i){if(!e||!t||!i)return"Missing params!";this._addRule(e,t,i),this._generateCssRules()},remove:function(e){void 0!==this._rules[e]&&(delete this._rules[e],this._generateCssRules())},reset:function(){this._rules={},this._generateCssRules()}},generateImpressionHash:function(e){return FSUtils.HASH.hex_md5(e+(new Date).getTime().toString()+(1e17*Math.random()).toString())},removeFromArrayWhereKey:function(e,t,i){for(var n,s=0;n=e[s++];)if(n[t]===i)return e.splice(s-1,1),!0;return!1},loadScript:function(e,t,i){var n=document.createElement("script");return n.type="text/javascript",n.onload=function(){t&&t()},n.onerror=function(){i&&i()},document.head.appendChild(n),n.src=e,n},getDirectlink:function(e){var t=FSWidgetModel.gi().widgetSettings.get("shareLinkText"),i=FSWidgetModel.gi().get("collectionData");if(""!==FlipSnackEmbed.urls.customDomain){var n=t.split("/");t=FlipSnackEmbed.urls.customDomain+"/"+n[n.length-1]}if(-1===t.indexOf("http://")&&-1===t.indexOf("https://")?t="http://"+t:t.indexOf("http://")>-1&&(t=t.replace("http://","https://")),0===t.length){var s=FSUtils.getCurrentHash();t="https:"+window.URLPaths.BASE+"/?fh="+s}if(i&&i.visibility&&(i.visibility===FlipbookVisibilityType.PRIVATE_EMAIL||i.visibility===FlipbookVisibilityType.SHARED_TEAM||i.visibility===FlipbookVisibilityType.PRIVATE||i.visibility===FlipbookVisibilityType.PRIVATE_SSO)&&!e){var o=FlipSnackEmbed.urls.appUrl+"/"+PRIVATE_FLIPBOOKS+"/";t=t.replace(/\/\/.+?\//i,o).replace(".html","")}return t},getCurrentHash:function(){return FSWidgetModel.gi().get("shelfData")&&FSWidgetModel.gi().get("shelfData").get("itemOpened")?FSWidgetModel.gi().get("shelfData").get("itemHash"):FSWidgetModel.gi().get("collectionHash")},getDownloadedPdfPath:function(){return FSWidgetModel.gi().get("exportName")},getDownloadLink:function(){return FSWidgetModel.gi().get("isDownload")&&""!==FSWidgetModel.gi().get("exportName")?FSUtils.getDownloadedPdfPath():FSUtils.getDirectlink(!0).split(".html")[0]+"/"+DOWNLOAD_PDF_SUFFIX+".html"},getPrintLink:function(){return FSWidgetModel.gi().get("isDownload")&&""!==FSWidgetModel.gi().get("exportName")?FSUtils.getDownloadedPdfPath():FSUtils.getDirectlink(!0).split(".html")[0]+"/"+PRINT_PDF_SUFFIX+".html"},hasAccessToElement:function(e,t){var i=ElementActionToFeature[e.action];return void 0===i||t[i]},parseJSONData:function(e,t,i){var n,s,o,a,r,l=["title","security","trackingId"];e.config&&(r=e.config);var c={};for(r.params.widgetType===WidgetType.SHELF&&r.params.newShelf&&(c.shelfData={shelf:!0,shelfOpened:!0,items:r.collection,shelfJson:e}),void 0!==r.blocked&&"true"===r.blocked&&(c.isBlocked=!0),n=0;s=l[n++];)"string"==typeof r[s]&&r[s]&&(c[s]=r[s]);return o=r.features?r.features:null,a=r.sell?r.sell:null,"string"==typeof r.userProfile&&r.userProfile.length?(c.userProfile=r.userProfile,c.author=r.userProfile,a&&(a.buyLink=FSUtils.getFlipbookBuyLink(t,r.userProfile,i),a.activeSubscription&&(a.rollingSubscriptionLink=FSUtils.getRollingSubscriptionLink(FlipSnackEmbed.urls.appUrl,r.accountId)))):a=null,"string"==typeof r.linkName&&r.linkName.length&&(c.linkName=r.linkName),"string"==typeof r.author&&r.author.length&&(c.author=r.author),c.albumType=r.type,c.templateHash=r.template_hash,c.publisher=1===r.publisher||"1"===r.publisher,c.resourceVersion=r.resourceVersion||"1",c.watermark=r.watermark&&"yes"===r.watermark.toLowerCase(),c.params=FSUtils.parseJSONParams(r.params),c.collection=FSUtils.parseCollection(r.collection),c.features=FSUtils.parseJSONFeatures(o),c.sell=c.features&&c.features.SELL?FSUtils.parseSellData(a):{},c.visibility=r.visibility,c.accountId=r.accountId,c.sirAccountId=r.sirAccountId,c.ipAnonymization=r.ipAnonymization||!1,c.gtmId=r.gtmId||"",c.encryptVersion=PasswordEncryptionVersion.V1,"number"==typeof r.encryptionVersion&&(c.encryptVersion=PasswordEncryptionVersion[Object.keys(PasswordEncryptionVersion).find((e=>PasswordEncryptionVersion[e]===r.encryptionVersion))]||PasswordEncryptionVersion.V1),c.features&&c.features.TABLE_OF_CONTENT&&r.params.enableToc&&r.collection.flip&&r.collection.flip.length&&(c.tocPageLinks=FSUtils.getTocPageLinks(r.collection.flip[0].pageData),c.toc={tocData:r.collection.toc,visible:!1}),r.collection.accessibility&&r.collection.accessibility.enable?c.accessibility=r.collection.accessibility.pages:c.accessibility=null,c.leadForm=r.collection.leadForm?r.collection.leadForm:null,c.sell.rollingSubscriptionLink=FSUtils.getRollingSubscriptionLink(FlipSnackEmbed.urls.appUrl,c.accountId),c},getFlipbookBuyLink:function(e,t,i){return e+"/store/publishers/"+t+"/flips/"+i+"/"},getRollingSubscriptionLink:function(e,t){return e+"/profile-subscription/checkout/"+t},parseJSONParams:function(e){var t={};for(var i in e)if(e.hasOwnProperty(i))switch(i){case"collectionWidth":case"collectionHeight":case"autoFlipDelay":t[i]=parseInt(e[i]);break;default:"true"===e[i]||"false"===e[i]?t[i]="true"===e[i]:t[i]=e[i]}return t},parseCollection:function(e){var t=e.flip;return _.each(t,(function(e){e.pageData=e.pageData.page,_.each(e.pageData,(function(e){e.links&&e.links.l&&(e.links=e.links.l,e.links=e.links.filter((function(e){return!e.invisible})))}))})),t},parseJSONFeatures:function(e){var t={};if(!e)return{};for(var i in e)e.hasOwnProperty(i)&&("true"===e[i]||"false"===e[i]?t[i]="true"===e[i]:t[i]=e[i]);return t},parseSellData:function(e){var t={};return e&&e.enabled&&e.price&&"object"==typeof e.previewPages&&e.previewPages.length&&(t={price:e.price.toString(),previewPages:_.uniq(e.previewPages).sort((function(e,t){return e-t})),buyLink:e.buyLink,activeSubscription:e.activeSubscription,rollingSubscriptionLink:""},e.subscriptionPrice&&(t.subscriptionPrice=e.subscriptionPrice.toString(),t.subscriptionFlipbooks=e.subscriptionFlipbooks)),t},getTocPageLinks:function(e){var t,i,n={};return e.forEach((function(e,s){e.originalHash&&!isNaN(e.pdfidx)&&(i=e.pdfidx+1,t=e.originalHash+"_"+i,n[t]=s)})),n},getOldEditorScaling:function(e,t,i){var n,s=t/e;return n=i.width/i.height>s?i.height*s:i.width,Math.min(n/t,1)},getCollectionContentURL:function(e,t){return URLPaths.COLLECTION_CONTENT.replace("{accountId}",e).replace("{hash}",t)},getUserExternalLibraryURL:function(e){return URLPaths.EXTERNAL_CONTENT.replace("{accountId}",e)},getVideoParam:function(e,t){var i=e.split("&"),n=0;return i.forEach((function(e){var i=e.split("=");t===i[0]&&(n=i[1])})),n},isPlayerSkin:function(){return FSWidgetModel.gi().widgetSettings.get("skinType")===WidgetSkinType.PLAYER},generateZoomValues:function(e,t,i){for(var n=[],s=t/i,o=0;o<=i;o++)n.push(s*o);return n},getClosestZoomValue:function(e,t){return e.reduce((function(e,i){return Math.abs(i-t)<Math.abs(e-t)?i:e}))},isCorrectPassword:function(e){var t=FSWidgetModel.gi().get("collectionData").encryptVersion,i=FSWidgetModel.gi().get("collectionData").security;return t===PasswordEncryptionVersion.V2?dcodeIO.bcrypt.compareSync(e,i):String(CryptoJS.SHA1(e))===i}}}(jQuery),FSUtils.FULLSCREEN_PORTRAIT_MARGIN=16,FSUtils.FULLSCREEN_LANDSCAPE_MARGIN=26,FSUtils.ORIENTATION_PORTRAIT="portrait",FSUtils.ORIENTATION_LANDSCAPE="landscape";var LoaderManager=Backbone.Model.extend({initialize:function(){this.taskList=[],this.hasTask=!1},removeAllTasks:function(){var e=this;this.taskList.forEach((function(t){$(t).off("complete error",e.completeHandler)})),this.taskList=[],this.hasTask=!1},addTask:function(e){this.taskList.push(e),this.hasTask||this.processTask()},processTask:function(){var e,t=this;this.taskList.length>0&&(this.hasTask=!0,(e=this.taskList.shift()).isLoadComplete()?this.processComplete():(void 0===(t=this).completeHandler&&(t.completeHandler=function(){t.processComplete()}),$(e).off("complete error",t.completeHandler),$(e).on("complete error",t.completeHandler),e.load()))},processComplete:function(){this.hasTask=!1,this.processTask()}}),SQSManager=Backbone.Model.extend({initialize:function(){FSWidgetModel.gi().get("isDownload")||(Backbone.Mediator.sub(WidgetEvent.SEND_SQS_MAIL,this.onSendMail,this),Backbone.Mediator.sub(WidgetEvent.SEND_LEAD_FORM,this.onSendFormData,this),Backbone.Mediator.sub(StatsEvents.SEND_STATS,this.onSendStats,this))},onSendMail:function(e){this.pushMessage({type:"paypal-email",data:this.appendOrigin(e)},URLPaths.SQS_WIDGET_QUEUE,"POST")},onSendFormData:function(e){this.pushMessage({type:"lead-form",data:this.appendOrigin(e)},URLPaths.SQS_WIDGET_QUEUE,"POST")},appendOrigin:function(e){return _.extend(e,FSWidgetModel.gi().get("isWhiteLabel")?{origin:"whitelabel"}:{})},onSendStats:function(e){this.pushMessage(e,URLPaths.SQS_STATS_QUEUE)},pushMessage:function(e,t,i){var n=i||"GET",s={Action:"SendMessage",MessageBody:JSON.stringify(e)},o={type:i,url:t+("GET"===n?"?"+$.param(s):"")};"POST"===i&&(o.data=s),$.ajax(o)}});SQSManager._instance=null,SQSManager.gi=function(){return SQSManager._instance||(SQSManager._instance=new SQSManager),SQSManager._instance},function(e){"use strict";window.ShelfUtils||(window.ShelfUtils={}),window.ShelfUtils={loadShelfItem:function(t,i){if(!FSUtils.isIOS()){var n=FlipSnackEmbed.urls.collectionJSON+t;e.getJSON(n,"",(function(e){i(e)})).fail(ShelfUtils.loadShelfItemError)}},loadShelfItemError:function(){var t=e("#fsw");e(t).append(e('<div class="fsw-embedmsg-container"></div>').append(e('<p class="fsw-embed-message">There was an error loading the collection. Please try again later.</p>')))}}}(jQuery),function(){"use strict";window.URLPaths||(window.URLPaths={}),window.URLPaths={LOCAL_PATH:"widget.flipsnack.io",DEV_PATH:"stage.site.flipsnack.net",LIVE_PATH:"www.flipsnack.com",CDN_DEV:"cdn.flipsnack.net",CDN_LIVE:"cdn.flipsnack.com",CONTENT_DEV:"content.flipsnack.net",CONTENT_LIVE:"content.flipsnack.com",STATIC_CDN_DEV_PATH:"https://static.flipsnack.net",STATIC_CDN_LIVE_PATH:"https://static.flipsnack.com",CDN_DEV_WHITELABEL:"d3hnuexrnaisrd.cloudfront.net",CDN_LIVE_WHITELABEL:"dgbgkkl7v688n.cloudfront.net",S3_DEV:"s3-eu-central-1.amazonaws.com",S3_DEV_SNACKTOOLS:"devfiles.snacktools.net",DEV_CLOUDFRONT:"d1dc988o4ywp3l.cloudfront.net",S3_LIVE:"files.flipsnack.net",LIVE_CLOUDFRONT:"d1dhn91mufybwl.cloudfront.net",S3_DEV_WHITELABEL:"devfiles.enterprise.flipsnack.net.s3.amazonaws.com",S3_LIVE_WHITELABEL:"dgbgkkl7v688n.cloudfront.net",EC3:"",HASH_ID:"",TEMPLATE_HASH_ID:"",BASE:"",BASE_FILES_PATH:"",COLLECTIONS_PATH:"",COVER_IMAGE:"",COVER_PATH:"",ASSETS_PATH:"",DIRECT_LINK:"",DIRECT_FULLSCREEN_LINK:"",ORIGINAL_IMAGE:"",THUMB_IMAGE:"",SMALL_IMAGE:"",MEDIUM_IMAGE:"",LARGE_IMAGE:"",TYPE:"",UPLOADS_PATH:"",HYPERLINK_UPLOADED_IMAGES_PATH:"",HYPERLINK_TEXTURE_IMAGES_PATH:"",HYPERLINK_STOCK_IMAGES_PATH:"",PAYPAL_NOTIFY_URL:"",PAYPAL_URL:"",COUNTRIES_URL:"",PREMIUM_LAYOUTS_URL:"",STATS_URL:"",SQS_URL:"",YOUTUBE_THUMB_URL:"",SVG_SHAPE_URL:"",SVG_ICON_URL:"",SQS_WIDGET_QUEUE:"",SQS_STATS_QUEUE:"",FONT_PATH:"",LIBRARY_FONT_PATH:"",init:function(e){var t=location.host;this.isDownload=e.isDownload,this.collectionHashId=e.collectionHash,this.isDev=t.indexOf(this.DEV_PATH)>-1||t.indexOf(this.LOCAL_PATH)>-1||t.indexOf(this.S3_DEV)>-1&&0===location.pathname.indexOf("/flipsnack-dev")||t.indexOf(this.S3_DEV_SNACKTOOLS)>-1||t.indexOf(this.CDN_DEV)>-1||t.indexOf(this.S3_DEV_WHITELABEL)>-1||t.indexOf(this.CDN_DEV_WHITELABEL)>-1||t.indexOf(this.DEV_CLOUDFRONT)>-1||t.indexOf("192.168.0")>-1,this.isDev||(this.isDev=t.indexOf("flipsnack")>=0&&-1===t.indexOf("flipsnack.com")&&-1===t.indexOf(this.S3_LIVE)&&-1===t.indexOf(this.CDN_LIVE)&&-1===t.indexOf(this.S3_LIVE_WHITELABEL)&&-1===t.indexOf(this.LIVE_CLOUDFRONT)&&-1===t.indexOf(this.CDN_LIVE_WHITELABEL)),e.isWhiteLabel?(this.isDev?(this.BASE="//enterprise.dev.flipsnack.net",this.EC3="http://ec3dev.snacktools.net",this.BASE_FILES_PATH=e.useCDN?"//"+this.CDN_DEV_WHITELABEL:"http://"+this.S3_DEV_WHITELABEL,this.PAYPAL_URL="https://www.sandbox.paypal.com/cgi-bin/webscr",this.SQS_URL="https://sqs.eu-central-1.amazonaws.com/756737886395/",this.SQS_WIDGET_QUEUE=this.SQS_URL+"flip-dev-widget-queue",this.SQS_STATS_QUEUE=this.SQS_URL+"flip-dev-stats-queue",this.CONTENT_PATH="https://"+this.CONTENT_DEV,this.STATIC_CDN_PATH=this.STATIC_CDN_DEV_PATH):(this.BASE="//flipsnackenterprise.com",this.EC3="http://ec3.snacktools.net",this.BASE_FILES_PATH="//"+this.CDN_LIVE_WHITELABEL,this.PAYPAL_URL="https://www.paypal.com/cgi-bin/webscr",this.SQS_URL="https://sqs.us-east-1.amazonaws.com/756737886395/",this.SQS_WIDGET_QUEUE=this.SQS_URL+"flip-widget-queue",this.SQS_STATS_QUEUE=this.SQS_URL+"wlstats-flip",this.CONTENT_PATH="https://"+this.CONTENT_LIVE,this.STATIC_CDN_PATH=this.STATIC_CDN_LIVE_PATH),this.DOWNLOAD_PATH_SUFFIX="&wl=1"):(this.isCloudFront(t)&&(this.CDN_DEV=this.DEV_CLOUDFRONT,this.CDN_LIVE=this.LIVE_CLOUDFRONT),this.isDev?(this.BASE="//site.flipsnack.net",this.EC3="http://ec3dev.snacktools.net",this.BASE_FILES_PATH=e.useCDN?"//"+this.CDN_DEV:"http://"+this.S3_DEV,this.CONTENT_PATH="https://"+this.CONTENT_DEV,this.PAYPAL_URL="https://www.sandbox.paypal.com/cgi-bin/webscr",this.SQS_URL="https://sqs.eu-central-1.amazonaws.com/756737886395/",this.SQS_WIDGET_QUEUE=this.SQS_URL+"flip-dev-widget-queue",this.SQS_STATS_QUEUE=this.SQS_URL+"flip-dev-stats-queue",this.STATIC_CDN_PATH=this.STATIC_CDN_DEV_PATH):(this.BASE="//www.flipsnack.com",this.EC3="http://ec3.snacktools.net",this.BASE_FILES_PATH="//"+this.CDN_LIVE,this.CONTENT_PATH="https://"+this.CONTENT_LIVE,this.PAYPAL_URL="https://www.paypal.com/cgi-bin/webscr",this.SQS_URL="https://sqs.us-east-1.amazonaws.com/756737886395/",this.SQS_WIDGET_QUEUE=this.SQS_URL+"flip-widget-queue",this.SQS_STATS_QUEUE=this.SQS_URL+"flip-sts",this.STATIC_CDN_PATH=this.STATIC_CDN_LIVE_PATH),this.DOWNLOAD_PATH_SUFFIX=""),this.DIRECT_LINK="https:"+this.BASE+"/flips/"+this.collectionHashId,this.isDownload?(this.BASE_FILES_PATH=e.resourcePath&&e.resourcePath.length?e.resourcePath+"/":"",this.ASSETS_PATH=e.resourcePath&&e.resourcePath.length?e.resourcePath+"/":"collections/assets/",this.COLLECTION_CONTENT=this.BASE_FILES_PATH,this.EXTERNAL_CONTENT=this.BASE_FILES_PATH,this.CONTENT_PATH=this.BASE_FILES_PATH):(this.BASE_FILES_PATH+="/",this.ASSETS_PATH=this.BASE_FILES_PATH+"widget/assets/",this.COLLECTION_CONTENT=this.CONTENT_PATH+"/{accountId}/collections/{hash}/",this.EXTERNAL_CONTENT=this.CONTENT_PATH+"/{accountId}/library/external/"),this.COLLECTIONS_PATH=this.BASE_FILES_PATH+"collections/",this.ITEMS_BASE_PATH=this.COLLECTIONS_PATH+"items/",this.UPLOADS_PATH=this.BASE_FILES_PATH+"collections/uploads/",this.HYPERLINK_UPLOADED_IMAGES_PATH=this.BASE_FILES_PATH+"collections/uploads/",this.HYPERLINK_STOCK_IMAGES_PATH=this.BASE_FILES_PATH+"collections/resources/images/high/",this.HYPERLINK_PROVIDERS_IMAGES_PATH=this.BASE_FILES_PATH+"collections/resources/images/saved/",this.HYPERLINK_PROVIDERS_VIDEOS_PATH=this.BASE_FILES_PATH+"collections/resources/videos/saved/",this.HYPERLINK_PROVIDERS_VIDEOS_COVER_PATH=this.BASE_FILES_PATH+"collections/resources/videos/covers/",this.HYPERLINK_TEXTURE_IMAGES_PATH=this.BASE_FILES_PATH+"collections/resources/images/high/",this.COUNTRIES_URL=this.BASE_FILES_PATH+"templates/countries.gz.js",this.PAYPAL_NOTIFY_URL=this.BASE+"/scripts/paypal_ipn.php",this.PREMIUM_LAYOUTS_URL=this.BASE_FILES_PATH+"templates/premium-layouts.gz.js",this.STATS_URL=this.BASE+"/scripts/stats/send-data.php",this.YOUTUBE_THUMB_URL="https://i.ytimg.com/vi/",this.COVER_PATH=this.ITEMS_BASE_PATH+this.collectionHashId+"/covers/",this.COVER_IMAGE=this.COVER_PATH+"page_1"+(this.isDownload?".jpg":""),this.ORIGINAL_IMAGE=this.COVER_PATH+"{page}/original"+(this.isDownload?".jpg":""),this.THUMB_IMAGE=this.COVER_PATH+"{page}/thumb"+(this.isDownload?".jpg":""),this.SMALL_IMAGE=this.COVER_PATH+"{page}/small"+(this.isDownload?".jpg":""),this.MEDIUM_IMAGE=this.COVER_PATH+"{page}/medium"+(this.isDownload?".jpg":""),this.SVG_SHAPE_URL=this.BASE_FILES_PATH+"resources/svg/",this.SVG_ICON_URL=this.BASE_FILES_PATH+"resources/icons/",this.FONT_PATH=this.BASE_FILES_PATH+"collections/uploads/",this.LIBRARY_FONT_PATH=this.STATIC_CDN_PATH+"/library/fonts/"},isCloudFront:function(e){return e.indexOf(this.DEV_CLOUDFRONT)>-1||e.indexOf(this.LIVE_CLOUDFRONT)>-1},getLinksForItem:function(e){var t=this.COLLECTIONS_PATH+"items/"+e+"/covers/";return{COLLECTIONS_PATH:this.COLLECTIONS_PATH,COVER_IMAGE:t+"page_1"+(this.isDownload?".jpg":""),ORIGINAL_IMAGE:t+"{page}/original"+(this.isDownload?".jpg":""),THUMB_IMAGE:t+"{page}/thumb"+(this.isDownload?".jpg":""),SMALL_IMAGE:t+"{page}/small"+(this.isDownload?".jpg":""),MEDIUM_IMAGE:t+"{page}/medium"+(this.isDownload?".jpg":"")}}}}(),function(e,t){"function"==typeof define&&define.amd?define([],t):"function"==typeof require&&"object"==typeof module&&module&&module.exports?module.exports=t():(e.dcodeIO=e.dcodeIO||{}).bcrypt=t()}(this,(function(){function e(e){if("undefined"!=typeof module&&module&&module.exports)try{return require("crypto").randomBytes(e)}catch(e){}try{var t;return(self.crypto||self.msCrypto).getRandomValues(t=new Uint32Array(e)),Array.prototype.slice.call(t)}catch(e){}if(!d)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return d(e)}function t(e,t){for(var i=0,n=0,s=0,o=e.length;s<o;++s)e.charCodeAt(s)===t.charCodeAt(s)?++i:++n;return!(0>i)&&0===n}function i(e,t){var i,n,s=0,o=[];if(0>=t||t>e.length)throw Error("Illegal len: "+t);for(;s<t;){if(i=255&e[s++],o.push(p[i>>2&63]),i=(3&i)<<4,s>=t){o.push(p[63&i]);break}if(i|=(n=255&e[s++])>>4&15,o.push(p[63&i]),i=(15&n)<<2,s>=t){o.push(p[63&i]);break}i|=(n=255&e[s++])>>6&3,o.push(p[63&i]),o.push(p[63&n])}return o.join("")}function n(e,t){var i,n,s,o=0,a=e.length,r=0,l=[];if(0>=t)throw Error("Illegal len: "+t);for(;o<a-1&&r<t&&(i=(s=e.charCodeAt(o++))<g.length?g[s]:-1,n=(s=e.charCodeAt(o++))<g.length?g[s]:-1,-1!=i&&-1!=n)&&(s=i<<2>>>0,s|=(48&n)>>4,l.push(f(s)),!(++r>=t||o>=a))&&-1!=(i=(s=e.charCodeAt(o++))<g.length?g[s]:-1)&&(s=(15&n)<<4>>>0,s|=(60&i)>>2,l.push(f(s)),!(++r>=t||o>=a));)n=(s=e.charCodeAt(o++))<g.length?g[s]:-1,s=(3&i)<<6>>>0,s|=n,l.push(f(s)),++r;for(a=[],o=0;o<r;o++)a.push(l[o].charCodeAt(0));return a}function s(e,t,i,n){var s,o=e[t],a=e[t+1];return s=n[(o=o^i[0])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(a=a^(s+=n[768|255&o])^i[1])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(o=o^(s+=n[768|255&a])^i[2])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(a=a^(s+=n[768|255&o])^i[3])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(o=o^(s+=n[768|255&a])^i[4])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(a=a^(s+=n[768|255&o])^i[5])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(o=o^(s+=n[768|255&a])^i[6])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(a=a^(s+=n[768|255&o])^i[7])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(o=o^(s+=n[768|255&a])^i[8])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(a=a^(s+=n[768|255&o])^i[9])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(o=o^(s+=n[768|255&a])^i[10])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(a=a^(s+=n[768|255&o])^i[11])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(o=o^(s+=n[768|255&a])^i[12])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(a=a^(s+=n[768|255&o])^i[13])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],s=n[(o=o^(s+=n[768|255&a])^i[14])>>>24],s+=n[256|o>>16&255],s^=n[512|o>>8&255],s=n[(a=a^(s+=n[768|255&o])^i[15])>>>24],s+=n[256|a>>16&255],s^=n[512|a>>8&255],o=o^(s+=n[768|255&a])^i[16],e[t]=a^i[17],e[t+1]=o,e}function o(e,t){for(var i=0,n=0;4>i;++i)n=n<<8|255&e[t],t=(t+1)%e.length;return{key:n,offp:t}}function a(e,t,i){for(var n,a=0,r=[0,0],l=t.length,c=i.length,d=0;d<l;d++)a=(n=o(e,a)).offp,t[d]^=n.key;for(d=0;d<l;d+=2)r=s(r,0,t,i),t[d]=r[0],t[d+1]=r[1];for(d=0;d<c;d+=2)r=s(r,0,t,i),i[d]=r[0],i[d+1]=r[1]}function r(e,t,i,n,r){function l(){if(r&&r(m/i),!(m<i)){for(m=0;64>m;m++)for(f=0;f<h>>1;f++)s(d,f<<1,p,g);for(o=[],m=0;m<h;m++)o.push((d[m]>>24&255)>>>0),o.push((d[m]>>16&255)>>>0),o.push((d[m]>>8&255)>>>0),o.push((255&d[m])>>>0);return n?void n(null,o):o}for(var o=Date.now();m<i&&(m+=1,a(e,p,g),a(t,p,g),!(100<Date.now()-o)););n&&u(l)}var c,d=y.slice(),h=d.length;if(4>i||31<i){if(c=Error("Illegal number of rounds (4-31): "+i),n)return void u(n.bind(this,c));throw c}if(16!==t.length){if(c=Error("Illegal salt length: "+t.length+" != 16"),n)return void u(n.bind(this,c));throw c}i=1<<i>>>0;var p,g,f,m=0;if(Int32Array?(p=new Int32Array(v),g=new Int32Array(b)):(p=v.slice(),g=b.slice()),function(e,t,i,n){for(var a,r=0,l=[0,0],c=i.length,d=n.length,h=0;h<c;h++)r=(a=o(t,r)).offp,i[h]^=a.key;for(h=r=0;h<c;h+=2)r=(a=o(e,r)).offp,l[0]^=a.key,r=(a=o(e,r)).offp,l[1]^=a.key,l=s(l,0,i,n),i[h]=l[0],i[h+1]=l[1];for(h=0;h<d;h+=2)r=(a=o(e,r)).offp,l[0]^=a.key,r=(a=o(e,r)).offp,l[1]^=a.key,l=s(l,0,i,n),n[h]=l[0],n[h+1]=l[1]}(t,e,p,g),void 0!==n)l();else for(;;)if(void 0!==(c=l()))return c||[]}function l(e,t,s,o){function a(e){var t=[];return t.push("$2"),"a"<=l&&t.push(l),t.push("$"),10>d&&t.push("0"),t.push(d.toString()),t.push("$"),t.push(i(h,h.length)),t.push(i(e,4*y.length-1)),t.join("")}if("string"!=typeof e||"string"!=typeof t){if(o=Error("Invalid string / salt: Not a string"),s)return void u(s.bind(this,o));throw o}var l,c;if("$"!==t.charAt(0)||"2"!==t.charAt(1)){if(o=Error("Invalid salt version: "+t.substring(0,2)),s)return void u(s.bind(this,o));throw o}if("$"===t.charAt(2))l=String.fromCharCode(0),c=3;else{if("a"!==(l=t.charAt(2))&&"b"!==l&&"y"!==l||"$"!==t.charAt(3)){if(o=Error("Invalid salt revision: "+t.substring(2,4)),s)return void u(s.bind(this,o));throw o}c=4}if("$"<t.charAt(c+2)){if(o=Error("Missing salt rounds"),s)return void u(s.bind(this,o));throw o}var d=10*parseInt(t.substring(c,c+1),10)+parseInt(t.substring(c+1,c+2),10);t=t.substring(c+3,c+25),e=function(e){var t=[],i=0;return m.encodeUTF16toUTF8((function(){return i>=e.length?null:e.charCodeAt(i++)}),(function(e){t.push(e)})),t}(e+("a"<=l?"\0":""));var h=n(t,16);if(void 0===s)return a(r(e,h,d));r(e,h,d,(function(e,t){e?s(e,null):s(null,a(t))}),o)}var c={},d=null;try{e(1)}catch(e){}d=null,c.setRandomFallback=function(e){d=e},c.genSaltSync=function(t,n){if("number"!=typeof(t=t||10))throw Error("Illegal arguments: "+typeof t+", "+typeof n);4>t?t=4:31<t&&(t=31);var s=[];return s.push("$2a$"),10>t&&s.push("0"),s.push(t.toString()),s.push("$"),s.push(i(e(16),16)),s.join("")},c.genSalt=function(e,t,i){function n(t){u((function(){try{t(null,c.genSaltSync(e))}catch(e){t(e)}}))}if("function"==typeof t&&(i=t,t=void 0),"function"==typeof e&&(i=e,e=void 0),void 0===e)e=10;else if("number"!=typeof e)throw Error("illegal arguments: "+typeof e);if(!i)return new Promise((function(e,t){n((function(i,n){i?t(i):e(n)}))}));if("function"!=typeof i)throw Error("Illegal callback: "+typeof i);n(i)},c.hashSync=function(e,t){if(void 0===t&&(t=10),"number"==typeof t&&(t=c.genSaltSync(t)),"string"!=typeof e||"string"!=typeof t)throw Error("Illegal arguments: "+typeof e+", "+typeof t);return l(e,t)},c.hash=function(e,t,i,n){function s(i){"string"==typeof e&&"number"==typeof t?c.genSalt(t,(function(t,s){l(e,s,i,n)})):"string"==typeof e&&"string"==typeof t?l(e,t,i,n):u(i.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)))}if(!i)return new Promise((function(e,t){s((function(i,n){i?t(i):e(n)}))}));if("function"!=typeof i)throw Error("Illegal callback: "+typeof i);s(i)},c.compareSync=function(e,i){if("string"!=typeof e||"string"!=typeof i)throw Error("Illegal arguments: "+typeof e+", "+typeof i);return 60===i.length&&t(c.hashSync(e,i.substr(0,i.length-31)),i)},c.compare=function(e,i,n,s){function o(n){"string"!=typeof e||"string"!=typeof i?u(n.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof i))):60!==i.length?u(n.bind(this,null,!1)):c.hash(e,i.substr(0,29),(function(e,s){e?n(e):n(null,t(s,i))}),s)}if(!n)return new Promise((function(e,t){o((function(i,n){i?t(i):e(n)}))}));if("function"!=typeof n)throw Error("Illegal callback: "+typeof n);o(n)},c.getRounds=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)},c.getSalt=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);if(60!==e.length)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)};var h,u="undefined"!=typeof process&&process&&"function"==typeof process.nextTick?"function"==typeof setImmediate?setImmediate:process.nextTick:setTimeout,p="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),g=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1],f=String.fromCharCode,m=(h={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var i=null;for("number"==typeof e&&(i=e,e=function(){return null});null!==i||null!==(i=e());)128>i?t(127&i):(2048>i?t(i>>6&31|192):(65536>i?t(i>>12&15|224):(t(i>>18&7|240),t(i>>12&63|128)),t(i>>6&63|128)),t(63&i|128)),i=null},decodeUTF8:function(e,t){for(var i,n,s,o,a=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(i=e());)if(0==(128&i))t(i);else if(192==(224&i))null===(n=e())&&a([i,n]),t((31&i)<<6|63&n);else if(224==(240&i))null!==(n=e())&&null!==(s=e())||a([i,n,s]),t((15&i)<<12|(63&n)<<6|63&s);else{if(240!=(248&i))throw RangeError("Illegal starting byte: "+i);null!==(n=e())&&null!==(s=e())&&null!==(o=e())||a([i,n,s,o]),t((7&i)<<18|(63&n)<<12|(63&s)<<6|63&o)}},UTF16toUTF8:function(e,t){for(var i,n=null;null!==(i=null!==n?n:e());)55296<=i&&57343>=i&&null!==(n=e())&&56320<=n&&57343>=n?(t(1024*(i-55296)+n-56320+65536),n=null):t(i);null!==n&&t(n)},UTF8toUTF16:function(e,t){var i=null;for("number"==typeof e&&(i=e,e=function(){return null});null!==i||null!==(i=e());)65535>=i?t(i):(t(55296+((i-=65536)>>10)),t(i%1024+56320)),i=null},encodeUTF16toUTF8:function(e,t){h.UTF16toUTF8(e,(function(e){h.encodeUTF8(e,t)}))},decodeUTF8toUTF16:function(e,t){h.decodeUTF8(e,(function(e){h.UTF8toUTF16(e,t)}))},calculateCodePoint:function(e){return 128>e?1:2048>e?2:65536>e?3:4},calculateUTF8:function(e){for(var t,i=0;null!==(t=e());)i+=h.calculateCodePoint(t);return i},calculateUTF16asUTF8:function(e){var t=0,i=0;return h.UTF16toUTF8(e,(function(e){++t,i+=h.calculateCodePoint(e)})),[t,i]}},h);Date.now=Date.now||function(){return+new Date};var v=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],b=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],y=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];return c.encodeBase64=i,c.decodeBase64=n,c}));var initializing=!1,fnTest=/xyz/.test((function(){xyz}))?/\b_super\b/:/.*/;function rgbToHsl(e,t,i){var n,s,o=e/255,a=t/255,r=i/255,l=Math.max(o,a,r),c=Math.min(o,a,r),d=(l+c)/2;if(l===c)n=s=0;else{var h=l-c;switch(s=d>.5?h/(2-l-c):h/(l+c),l){case o:n=(a-r)/h+(a<r?6:0);break;case a:n=(r-o)/h+2;break;case r:n=(o-a)/h+4}n/=6}return{h:n,s:s,l:d}}function hexToRgb(e){var t,i=[];if(7!==e.length){if((e=e.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/)).shift(),3!==e.length)return null;for(var n=0;n<3;n++)1===(t=e[n]).length&&(t+=t),i.push(parseInt(t,16))}else i=[(e=parseInt(e.slice(1),16))>>16,e>>8&255,255&e];return{r:i[0],g:i[1],b:i[2]}}function isLightColor(e){var t=hexToRgb(e);return!!t&&rgbToHsl(t.r,t.g,t.b).l>.5}this.Class=function(){},Class.extend=function(e){var t,i,n=this.prototype;for(i in initializing=!0,t=new this,initializing=!1,e)t[i]="function"==typeof e[i]&&"function"==typeof n[i]&&fnTest.test(e[i])?function(e,t){return function(){var i,s=this._super;return this._super=n[e],i=t.apply(this,arguments),this._super=s,i}}(i,e[i]):e[i];function s(){!initializing&&this.create&&this.create.apply(this,arguments)}return s.prototype=t,s.prototype.constructor=s,s.extend=arguments.callee,s};var CryptoJS=CryptoJS||function(e,t){var i={},n=i.lib={},s=function(){},o=n.Base={extend:function(e){s.prototype=this;var t=new s;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=n.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,i=e.words,n=this.sigBytes;if(e=e.sigBytes,this.clamp(),n%4)for(var s=0;s<e;s++)t[n+s>>>2]|=(i[s>>>2]>>>24-s%4*8&255)<<24-(n+s)%4*8;else if(65535<i.length)for(s=0;s<e;s+=4)t[n+s>>>2]=i[s>>>2];else t.push.apply(t,i);return this.sigBytes+=e,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-i%4*8,t.length=e.ceil(i/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i=[],n=0;n<t;n+=4)i.push(4294967296*e.random()|0);return new a.init(i,t)}}),r=i.enc={},l=r.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++){var s=t[n>>>2]>>>24-n%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new a.init(i,t/2)}},c=r.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++)i.push(String.fromCharCode(t[n>>>2]>>>24-n%4*8&255));return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n++)i[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new a.init(i,t)}},d=r.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},h=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,n=i.words,s=i.sigBytes,o=this.blockSize,r=s/(4*o);if(t=(r=t?e.ceil(r):e.max((0|r)-this._minBufferSize,0))*o,s=e.min(4*t,s),t){for(var l=0;l<t;l+=o)this._doProcessBlock(n,l);l=n.splice(0,t),i.sigBytes-=s}return new a.init(l,s)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});n.Hasher=h.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new u.HMAC.init(e,i).finalize(t)}}});var u=i.algo={};return i}(Math);!function(){var e=CryptoJS,t=(s=e.lib).WordArray,i=s.Hasher,n=[],s=e.algo.SHA1=i.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var i=this._hash.words,s=i[0],o=i[1],a=i[2],r=i[3],l=i[4],c=0;80>c;c++){if(16>c)n[c]=0|e[t+c];else{var d=n[c-3]^n[c-8]^n[c-14]^n[c-16];n[c]=d<<1|d>>>31}d=(s<<5|s>>>27)+l+n[c],d=20>c?d+(1518500249+(o&a|~o&r)):40>c?d+(1859775393+(o^a^r)):60>c?d+((o&a|o&r|a&r)-1894007588):d+((o^a^r)-899497514),l=r,r=a,a=o<<30|o>>>2,o=s,s=d}i[0]=i[0]+s|0,i[1]=i[1]+o|0,i[2]=i[2]+a|0,i[3]=i[3]+r|0,i[4]=i[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(i/4294967296),t[15+(n+64>>>9<<4)]=i,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=i._createHelper(s),e.HmacSHA1=i._createHmacHelper(s)}(),function(e){for(var t=CryptoJS,i=(s=t.lib).WordArray,n=s.Hasher,s=t.algo,o=[],a=[],r=function(e){return 4294967296*(e-(0|e))|0},l=2,c=0;64>c;){var d;e:{d=l;for(var h=e.sqrt(d),u=2;u<=h;u++)if(!(d%u)){d=!1;break e}d=!0}d&&(8>c&&(o[c]=r(e.pow(l,.5))),a[c]=r(e.pow(l,1/3)),c++),l++}var p=[];s=s.SHA256=n.extend({_doReset:function(){this._hash=new i.init(o.slice(0))},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],s=i[1],o=i[2],r=i[3],l=i[4],c=i[5],d=i[6],h=i[7],u=0;64>u;u++){if(16>u)p[u]=0|e[t+u];else{var g=p[u-15],f=p[u-2];p[u]=((g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3)+p[u-7]+((f<<15|f>>>17)^(f<<13|f>>>19)^f>>>10)+p[u-16]}g=h+((l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25))+(l&c^~l&d)+a[u]+p[u],f=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&s^n&o^s&o),h=d,d=c,c=l,l=r+g|0,r=o,o=s,s=n,n=g+f|0}i[0]=i[0]+n|0,i[1]=i[1]+s|0,i[2]=i[2]+o|0,i[3]=i[3]+r|0,i[4]=i[4]+l|0,i[5]=i[5]+c|0,i[6]=i[6]+d|0,i[7]=i[7]+h|0},_doFinalize:function(){var t=this._data,i=t.words,n=8*this._nDataBytes,s=8*t.sigBytes;return i[s>>>5]|=128<<24-s%32,i[14+(s+64>>>9<<4)]=e.floor(n/4294967296),i[15+(s+64>>>9<<4)]=n,t.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=n._createHelper(s),t.HmacSHA256=n._createHmacHelper(s)}(Math),function(){var e=CryptoJS,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,i){e=this._hasher=new e.init,"string"==typeof i&&(i=t.parse(i));var n=e.blockSize,s=4*n;i.sigBytes>s&&(i=e.finalize(i)),i.clamp();for(var o=this._oKey=i.clone(),a=this._iKey=i.clone(),r=o.words,l=a.words,c=0;c<n;c++)r[c]^=1549556828,l[c]^=909522486;o.sigBytes=a.sigBytes=s,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}();var CollectionItem=Backbone.Model.extend({defaults:{hash:"",title:"",description:"",hardCover:!1,noOfPages:1,hasCustomPages:!1,onlyCustomPages:!1,hasMovedPages:!1,imagesOnly:!1,extension:"pdf",blocked:!1,pages:void 0,forms:[]},addBlankPage:function(e,t){var i=null!=t?t:this.get("pages").length,n=new PageData({type:PageType.EMPTY_PAGE,width:this.get("pages").at(0).get("width"),height:this.get("pages").at(0).get("height"),itemHash:this.get("pages").at(0).get("itemHash"),pageIndex:i});null!=t?this.get("pages").add(n,{at:t}):this.get("pages").add(n,e?{at:0}:void 0)},destroy:function(){this.get("pages").reset()}}),CountryList=Backbone.Model.extend({defaults:{countries:[],countryOptions:""},initialize:function(){this.loading=!1,this.loaded=!1,this.loadContryList()},loadContryList:function(){var e=this;this.loading||(this.loading=!0,window.fs_countries=function(t){t&&t.countries&&t.countries.length?e.setCountryList(t.countries):e.setCountryList(CountryList.DEFAULT)},FSUtils.loadScript(URLPaths.COUNTRIES_URL,(function(){}),(function(){e.setCountryList(CountryList.DEFAULT)})))},setCountryList:function(e){var t=this.createCountryOptionsList(e);this.set({countries:e,countryOptions:t}),this.loading=!1,this.loaded=!0},createCountryOptionsList:function(e){return e.map((function(e){return'<option value="'+e+'">'+e+"</option>"})).join("")}});CountryList.DEFAULT=["--"];var CustomElement=Backbone.Model.extend({defaults:{type:0,action:0,bounds:"",color:"807F7D",eID:0}}),Links=Backbone.Collection.extend({model:CustomElement}),FSWidgetModel=Backbone.Model.extend({defaults:{viewIDPrefix:"fsw_widget_",collectionHash:"",widgetSuffix:"",isDownload:!1,exportName:"",isMobileDevice:!1,openPayPalIndex:void 0,showLimit:!1,isDetailsPage:!1,blockEvents:!1,noWatermark:!0,isPublisher:!0,location:"",randomVal:"",width:640,height:385,forceSmall:!1,forceWidget:!1,collectionData:{},sandBoxType:"live",ip:"",logo:{},allowBrowserFullScreen:!1,labels:{l_thumbnails:"View thumbnails",l_download:"Download",l_print:"Print",l_enter_fs:"View in full screen",l_exit_fs:"Exit full screen",l_mute:"Turn off sounds",l_unmute:"Turn on sounds",l_prev_page:"Go to previous page",l_next_page:"Go to next page",l_click_to_read:"Fullscreen",l_click_to_zoom:"Double-click to zoom",l_nextLabelText:"Next",l_prevLabelText:"Previous",l_pages:"pages",l_page:"page",l_download_one:"Download current file",l_download_all:"Download entire collection",l_files:"files",l_search:"Search",l_resultsFound:"# results found",l_playerResults:"# results",l_pageSearch:"Page #",l_share:"Share",l_click_to_open:"Click to open",l_click_to_close:"Click to close",l_password:"Password",l_password_text:"The flipbook youre trying to access is password protected.",l_password_text_whitelabel:"The publication youre trying to access is password protected.",l_incorrect_password:"Incorrect password",l_enter:"Enter",l_zoom:"Zoom",l_toc:"Table of contents",l_cortina_message:"Unlock the full version of",l_single_flipbook:"Buy single issue",l_subscription:"Subscribe to",l_buy_subscription:"Buy subscription",l_issues:"issues",l_buy:"buy",l_acsb_title:"Pages unavailable",l_acsb_description:"The accessibility text is blocked on these pages, because the content is only available if you purchase the magazine.",l_acsb_form:"The accessibility text is blocked on these pages. Please enter your email inside the form if you want to unlock the rest of the pages."},premiumLayouts:[],useCDN:!0,mainContentWidth:0,retryFirstItem:!1,isWhiteLabel:!1,currentZoom:0,maxZoomValue:0,textDirection:TextDirection.LEFT_TO_RIGHT,firstPageThumb:"",userProfile:"",linkName:"",sell:{price:"",subscriptionPrice:"",subscriptionFlipbooks:0,previewPages:[],buyLink:"",activeSubscription:!1,rollingSubscriptionLink:""},isForSelling:!1,hasAccessToCart:!1,isInSubscription:!1,author:"",sellSettingsPage:!1,resourcePath:"",leadForm:null},initialize:function(e){var t,i,n,s,o=e.collectionData.shelfData&&e.collectionData.shelfData.shelfOpened;Backbone.Mediator.pub(WidgetEvent.INIT_CONFIG),URLPaths.init({useCDN:this.get("useCDN"),isDownload:this.get("isDownload"),collectionHash:this.get("collectionHash"),isWhiteLabel:this.get("isWhiteLabel"),resourcePath:this.get("resourcePath")}),this.widgetSettings=new WidgetSettings(this.get("collectionData").params),this.get("isWhiteLabel")&&this.widgetSettings.set("enableDownload",!1),s=this.widgetSettings.get("mergePdfs"),this.singlePageView=this.widgetSettings.get("singlePageView"),this.arabicStyle=this.widgetSettings.get("arabicStyle"),this.isAutomatorOpen=!1,e.collectionData.sell&&e.collectionData.sell.price&&e.collectionData.sell.price.length&&(this.set("sell",e.collectionData.sell),this.set("isForSelling",!0),e.collectionData.sell.subscriptionPrice&&this.set("isInSubscription",!0)),e.collectionData.userProfile&&e.collectionData.userProfile.length&&this.set("userProfile",e.collectionData.userProfile),e.collectionData.linkName&&e.collectionData.linkName.length&&this.set("linkName",e.collectionData.linkName),e.collectionData.author&&e.collectionData.author.length&&this.set("author",e.collectionData.author),this.widgetSettings.set("mergePdfs",!0),""!==this.widgetSettings.get("language")&&""!==this.widgetSettings.get("language")||this.set("textDirection",TextDirection.RIGHT_TO_LEFT),this.set("sellSettingsPage",e.sellSettingsPage),o?this.set("shelfData",new ShelfData(e.collectionData.shelfData)):(this.get("shelfData")&&this.set("shelfData",e.collectionData.shelfData),this.flipCollection=new FlipCollection({noOfItems:1,hash:this.get("collectionHash"),title:this.get("collectionData").title,watermark:this.get("collectionData").watermark,type:this.get("collectionData").albumType,publisher:this.get("collectionData").publisher,password:this.get("collectionData").security||"",mergePdfs:this.widgetSettings.get("mergePdfs"),arabicStyle:this.arabicStyle,singlePageView:this.singlePageView,collection:[].concat(this.get("collectionData").collection),resourceVersion:this.get("collectionData").resourceVersion,enableHardCover:this.widgetSettings.get("enableHardCover"),maxFlipPages:e.features.FLIP_PAGES?e.features.FLIP_PAGES:-1,previewPages:this.get("isForSelling")?this.get("sell").previewPages:[],exportVideo:this.widgetSettings.get("exportVideo"),isDoublePageLayout:this.widgetSettings.get("contentLayout")===ContentLayout.DOUBLE_PAGE,leadForm:this.get("leadForm")}),this.flipCollection2=new FlipCollection({noOfItems:1,hash:this.get("collectionHash"),title:this.get("collectionData").title,watermark:this.get("collectionData").watermark,type:this.get("collectionData").albumType,publisher:this.get("collectionData").publisher,password:this.get("collectionData").security||"",mergePdfs:s,arabicStyle:this.arabicStyle,singlePageView:this.singlePageView,collection:[].concat(this.get("collectionData").collection),resourceVersion:this.get("collectionData").resourceVersion,enableHardCover:this.widgetSettings.get("enableHardCover"),maxFlipPages:e.features.FLIP_PAGES?e.features.FLIP_PAGES:-1,exportVideo:this.widgetSettings.get("exportVideo")})),!e.startBook&&!e.startPage||o?(i=0,t=this.arabicStyle?this.flipCollection.get("items").at(i).get("pages").length-1:0):(i=(n=this.getStartItem(e.startBook,e.startPage)).itemIndex,t=n.pageIndex),this.setItem(i,t,e),this.autoFlipTimeoutId=null,this.autoFlip=this.widgetSettings.get("autoFlip"),this.autoFlipDelay=this.widgetSettings.get("autoFlipDelay"),this.isAudioPlaying=!1,this.autoFlip&&this.setAutoFlip(),this.get("shelfData")&&this.get("shelfData").get("shelfOpened")||(this.collectionUsesCountries=this.flipCollection.hasCountryList(),this.collectionUsesCountries&&(this.countries=new CountryList,this.listenTo(this.countries,"change",this.countriesUpdated))),Backbone.Mediator.sub(WidgetEvent.NEXT_PAGE,this.goNextPage,this),Backbone.Mediator.sub(WidgetEvent.PREV_PAGE,this.goPreviousPage,this),Backbone.Mediator.sub(WidgetEvent.CHANGE_PAGE,this.jumpToPage,this),Backbone.Mediator.sub(WidgetEvent.PAGE_CHANGED,this.setPage,this),Backbone.Mediator.sub(WidgetEvent.NEXT_ITEM,this.goNextItem,this),Backbone.Mediator.sub(WidgetEvent.PREV_ITEM,this.goPreviousItem,this),Backbone.Mediator.sub(WidgetEvent.CHANGE_ITEM,this.jumpToFirstPageOfItem,this),Backbone.Mediator.sub(WidgetEvent.ITEM_VIEW_INIT,this.handleItemViewInitialized,this),Backbone.Mediator.sub(WidgetEvent.LEAD_FORM_SENT,this.handleFormSent,this),Backbone.Mediator.sub(WidgetEvent.AUTO_FLIP,this.goAutoFlip,this),Backbone.Mediator.sub(WidgetEvent.HYPERLINK,this.goToUrl,this),Backbone.Mediator.sub(WidgetEvent.SEND_EMAIL,this.sendEmail,this),Backbone.Mediator.sub(WidgetEvent.OPEN_AUTOMATOR,this.toggleAutomator,this),Backbone.Mediator.sub(WidgetEvent.CLOSE_AUTOMATOR,this.toggleAutomator,this),Backbone.Mediator.sub(WidgetEvent.LEAD_FORM_OPENED,this.stopAutoFlip,this),Backbone.Mediator.sub(WidgetEvent.LEAD_FORM_CLOSED,this.setAutoFlip,this),Backbone.Mediator.sub(WidgetEvent.PAGE_TURN_START,this.stopAutoFlip,this),Backbone.Mediator.sub(WidgetEvent.PAGE_TURN_CANCELED,this.setAutoFlip,this),Backbone.Mediator.sub(WidgetEvent.POPIN_OPEN,this.stopAutoFlip,this),Backbone.Mediator.sub(WidgetEvent.POPIN_CLOSE,this.setAutoFlip,this),Backbone.Mediator.sub(WidgetEvent.WIDGET_CLICK_OR_TAP,this.handleWidgetClickOrTap,this),Backbone.Mediator.sub(WidgetEvent.CHANGE_ZOOM,this.changeZoom,this),Backbone.Mediator.sub(WidgetEvent.FULLSCREEN_CHANGED,this.resetZoom,this),Backbone.Mediator.sub(NewShelfEvents.OPEN_ITEM,this.newShelfOpenItem,this),Backbone.Mediator.sub(NewShelfEvents.ITEM_LOADED,this.newShelfItemLoaded,this),Backbone.Mediator.sub("audioStarted",this.stopAutoFlip,this),Backbone.Mediator.sub("audioStopped",this.handleAudioStopped,this),Backbone.Mediator.sub("captionOpened",this.stopAutoFlip,this),Backbone.Mediator.sub("customContentClick",this.stopAutoFlip,this),this.listenTo(this.widgetSettings,"change:autoFlip",this.updateAutoFlip),this.listenTo(this.widgetSettings,"change:autoFlipDelay",this.updateAutoFlip),this.listenTo(this.widgetSettings,"change:singlePageView",this.singlePageChanged),this.listenTo(this.widgetSettings,"change:language",this.updateLanguageSettings),this.listenTo(this,"change:maxZoomValue",this.handleMaxZoomChange),this.listenTo(this,"change:currentZoom",this.handleZoomChange),this.listenTo(this,"change:sell",this.updateSellSettings)},destroy:function(){Backbone.Mediator.unsubscribe(WidgetEvent.NEXT_PAGE,this.goNextPage,this),Backbone.Mediator.unsubscribe(WidgetEvent.PREV_PAGE,this.goPreviousPage,this),Backbone.Mediator.unsubscribe(WidgetEvent.CHANGE_PAGE,this.jumpToPage,this),Backbone.Mediator.unsubscribe(WidgetEvent.PAGE_CHANGED,this.setPage,this),Backbone.Mediator.unsubscribe(WidgetEvent.NEXT_ITEM,this.goNextItem,this),Backbone.Mediator.unsubscribe(WidgetEvent.PREV_ITEM,this.goPreviousItem,this),Backbone.Mediator.unsubscribe(WidgetEvent.CHANGE_ITEM,this.jumpToFirstPageOfItem,this),Backbone.Mediator.unsubscribe(WidgetEvent.ITEM_VIEW_INIT,this.handleItemViewInitialized,this),Backbone.Mediator.unsubscribe(WidgetEvent.LEAD_FORM_SENT,this.handleFormSent,this),Backbone.Mediator.unsubscribe(WidgetEvent.AUTO_FLIP,this.goAutoFlip,this),Backbone.Mediator.unsubscribe(WidgetEvent.HYPERLINK,this.goToUrl,this),Backbone.Mediator.unsubscribe(WidgetEvent.SEND_EMAIL,this.sendEmail,this),Backbone.Mediator.unsubscribe(WidgetEvent.LEAD_FORM_OPENED,this.stopAutoFlip,this),Backbone.Mediator.unsubscribe(WidgetEvent.LEAD_FORM_CLOSED,this.setAutoFlip,this),Backbone.Mediator.unsubscribe(WidgetEvent.PAGE_TURN_START,this.stopAutoFlip,this),Backbone.Mediator.unsubscribe(WidgetEvent.PAGE_TURN_CANCELED,this.setAutoFlip,this),Backbone.Mediator.unsubscribe(WidgetEvent.POPIN_OPEN,this.stopAutoFlip,this),Backbone.Mediator.unsubscribe(WidgetEvent.POPIN_CLOSE,this.setAutoFlip,this),Backbone.Mediator.unsubscribe(WidgetEvent.WIDGET_CLICK_OR_TAP,this.handleWidgetClickOrTap,this),Backbone.Mediator.unsubscribe(WidgetEvent.CHANGE_ZOOM,this.changeZoom,this),Backbone.Mediator.unsubscribe(WidgetEvent.EXIT_FULLSCREEN,this.resetZoom,this),Backbone.Mediator.unsubscribe("audioStarted",this.stopAutoFlip,this),Backbone.Mediator.unsubscribe("audioStopped",this.handleAudioStopped,this),Backbone.Mediator.unsubscribe("captionOpened",this.stopAutoFlip,this),Backbone.Mediator.unsubscribe("customContentClick",this.stopAutoFlip,this),Backbone.Mediator.unsubscribe(NewShelfEvents.OPEN_ITEM,this.newShelfOpenItem,this),Backbone.Mediator.unsubscribe(NewShelfEvents.ITEM_LOADED,this.newShelfItemLoaded,this),this.off(),this.stopListening(),clearTimeout(this.autoFlipTimeoutId),this.widgetState=null,this.flipCollection&&this.flipCollection.destroy(),this.get("shelfData")&&this.get("shelfData").destroy(),this.flipCollection2&&this.flipCollection2.destroy(),this.flipCollection=null,this.widgetSettings=null,this.countries&&(this.countries=null),Backbone.Mediator.pub(WidgetEvent.DESTROY)},handleFormSent:function(e){this.removeForm(e),this.unblockPage(e.pageIndex),this.resetCollectionItemBlocked()},unblockPage:function(e){this.widgetState.get("currentItem").get("pages").at(e).set({form:null,formCanBlockItem:!1,hasForm:!1})},removeForm:function(e){var t=_.find(this.widgetState.get("currentItem").get("forms"),(function(t){return t.index===e.pageIndex})),i=_.without(this.widgetState.get("currentItem").get("forms"),t);FSWidgetModel.gi().widgetState.get("currentItem").set("forms",i,{silent:!0})},resetCollectionItemBlocked:function(){_.find(this.widgetState.get("currentItem").get("forms"),(function(e){return e.formCanBlockItem}))||this.widgetState.get("currentItem").set("blocked",!1)},findFirstBlockingPage:function(e,t){var i=!1,n=e,s=this.arabicStyle?0:t.get("pages").length,o=t.get("pages").at(n);for(o.get("hasForm")&&o.get("formCanBlockItem")&&(i=!0);!i&&n>=s;)(o=t.get("pages").at(n)).get("hasForm")&&o.get("formCanBlockItem")?i=!0:n=this.arabicStyle?n-1:n+1;return i?n:-1},findFirstBlockedItem:function(e){var t=!1,i=e,n=this.flipCollection.get("noOfItems");for(this.flipCollection.get("items").at(i);!t&&i!==n;)this.flipCollection.get("items").at(i).get("blocked")?t=!0:i+=1;return t?i:-1},toggleAutomator:function(e){this.isAutomatorOpen=e.openContainer,this.isAutomatorOpen?this.stopAutoFlip():this.setAutoFlip()},jumpToFirstPageOfItem:function(e){var t=this.get("collectionData").collection.reduce((function(t,i,n){var s=i.pageData&&i.pageData.length?i.pageData.length:0;return t+(n<e?s:0)}),0);this.setPage(this.arabicStyle?this.flipCollection.totalPages-t-1:t)},jumpToItem:function(e){var t,i,n=this.widgetState.get("currentItemIndex"),s=-1;e!==n&&(i=this.findFirstBlockedItem(n),e<n||-1===i?this.setItem(e):i>-1&&(e<i?this.setItem(e):(t=this.flipCollection.get("items").at(i),s=this.findFirstBlockingPage(this.arabicStyle?t.get("pages").length-1:0,t),this.setItem(i,-1===s?void 0:s))))},goNextItem:function(){var e,t=this.widgetState.get("currentItemIndex"),i=this.widgetState.get("currentItem");t<this.flipCollection.get("noOfItems")-1&&(this.widgetSettings.get("arabicStyle")?this.setItem(t+1):i.get("blocked")&&(e=this.findFirstBlockingPage(this.widgetState.get("currentPageIndex"),i))>=this.widgetState.get("currentPageIndex")?this.setPage(e):this.setItem(t+1))},goPreviousItem:function(){var e,t=this.widgetState.get("currentItemIndex"),i=this.widgetState.get("currentItem");t>0&&(this.widgetSettings.get("arabicStyle")&&i.get("blocked")&&(e=this.findFirstBlockingPage(this.widgetState.get("currentPageIndex"),i))<=this.widgetState.get("currentPageIndex")?this.setPage(e):this.setItem(t-1))},setItem:function(e,t,i){var n,s,o,a,r,l=i&&i.fullScreen?DisplayState.CLASSIC_FULLSCREEN:DisplayState.NORMAL,c=l!==DisplayState.NORMAL,d=t%2==0?Math.max(t-1,0):t;this.get("shelfData")&&this.get("shelfData").get("shelfOpened")?this.widgetState?this.widgetState.set({displayState:l}):this.widgetState=new WidgetState({displayState:l}):e<0||e>=this.flipCollection.get("noOfItems")||(n=this.flipCollection.get("items").at(e),t<0||t>n.get("pages").length-1||(s="number"==typeof t?this.singlePageView?t:d:this.arabicStyle?n.get("pages").length-1:0,this.singlePageView?o=s:a=(o=0===s?-1:s)+1,Backbone.Mediator.pub(WidgetEvent.ITEM_INIT,{previousItemIndex:this.widgetState?this.widgetState.get("currentItemIndex"):void 0,previousItem:this.widgetState?this.widgetSettings.get("currentItem"):void 0,newItemIndex:e,newItem:n}),r={currentItemIndex:e,currentItem:n,currentPageIndex:s,leftPageIndex:o,rightPageIndex:a},this.widgetState?this.widgetState.set(r):(_.extend(r,{displayState:l,widgetType:this.get("forceWidget")?WidgetType.CLASSIC:this.widgetSettings.get("widgetType"),displayType:c?DisplayType.LARGE:DisplayType.SMALL}),this.widgetState=new WidgetState(r)),Backbone.Mediator.pub(WidgetEvent.ITEM_CHANGED),this.resetZoom()))},getStartItem:function(e,t){var i,n,s,o,a=this.flipCollection.get("noOfItems");return e="number"!=typeof e||(e-=1)<0?0:e>=a?a-1:e,o=(s=this.flipCollection.get("items").at(e)).get("pages").length,t="number"!=typeof t?this.arabicStyle?o-1:0:(t-=1)<0?0:t>=o?o-1:t,(i=this.findFirstBlockedItem(0))>-1&&i<e?(o=(s=this.flipCollection.get("items").at(i)).get("pages").length,n=(n=this.findFirstBlockingPage(this.arabicStyle?o-1:0,s))>-1?n:t):(i=e,((n=this.findFirstBlockingPage(this.arabicStyle?o-1:0,s))<0||n>-1&&(this.arabicStyle&&n<t||!this.arabicStyle&&n>t))&&(n=t)),{itemIndex:i,pageIndex:n}},setPage:function(e){var t,i=e,n=e;!this.widgetState||e<0||e>this.widgetState.get("currentItem").get("pages").length-1||e===this.widgetState.get("currentPageIndex")||(this.singlePageView||(t=(n=0===(i=e%2==0?Math.max(e-1,0):e)?i-1:i)+1),this.widgetState.set({currentPageIndex:i,leftPageIndex:n,rightPageIndex:t}),this.isAudioPlaying=!1,this.setAutoFlip(),0===e||e===this.widgetState.get("currentItem").get("pages").length-1?this.registerPageViewEvent(this.widgetState.get("currentItem").get("pages").at(e).get("pID")):this.registerPageViewEvent([this.widgetState.get("currentItem").get("pages").at(e).get("pID"),this.widgetState.get("currentItem").get("pages").at(e+1).get("pID")]))},jumpToPage:function(e){var t=this.widgetState.get("currentItem"),i=this.widgetState.get("currentPageIndex"),n=this.findFirstBlockingPage(i,t);n>-1&&this.arabicStyle&&(e=n),this.setPage(e)},goNextPage:function(){var e=this.widgetState.get("currentItem"),t=this.widgetState.get("currentPageIndex"),i=e.get("pages").at(t),n=e.get("pages").length,s=e.get("pages").at(t+1),o=0;t<n-1&&(this.singlePageView?!this.arabicStyle&&i.get("formCanBlockItem")||(o=t+1):(this.arabicStyle||!i.get("formCanBlockItem")&&(i.get("pageIndex")%2==0||!s||s&&!s.get("formCanBlockItem")))&&(o=0===t?t+1:Math.min(t+2,n-1)),"string"==typeof FSWidgetModel.gi().get("collectionData").trackingId&&FSWidgetModel.gi().get("collectionData").trackingId.length&&!FlipSnackEmbed.isEditor&&Tracker.gtag(FSWidgetModel.gi().get("collectionData").title,o),this.setPage(o))},goPreviousPage:function(){var e=this.widgetState.get("currentItem"),t=this.widgetState.get("currentPageIndex"),i=e.get("pages").at(t),n=e.get("pages").at(t+1),s=0;t>0&&(this.singlePageView?this.arabicStyle&&i.get("formCanBlockItem")||(s=t-1):this.arabicStyle&&(i.get("formCanBlockItem")||i.get("pageIndex")%2!=0&&n&&(!n||n.get("formCanBlockItem")))||(s=Math.max(t-2,0)),"string"==typeof FSWidgetModel.gi().get("collectionData").trackingId&&FSWidgetModel.gi().get("collectionData").trackingId.length&&!FlipSnackEmbed.isEditor&&Tracker.gtag(FSWidgetModel.gi().get("collectionData").title,"Previous",t+1),this.setPage(s))},goAutoFlip:function(){var e=this.widgetState.get("currentItem"),t=this.widgetState.get("currentPageIndex"),i=e.get("pages").length;this.arabicStyle?t<=0?Backbone.Mediator.pub(WidgetEvent.CHANGE_PAGE,i-1):Backbone.Mediator.pub(WidgetEvent.PREV_PAGE):t>=i-1?Backbone.Mediator.pub(WidgetEvent.CHANGE_PAGE,0):Backbone.Mediator.pub(WidgetEvent.NEXT_PAGE)},setAutoFlip:function(){this.isAudioPlaying||(this.autoFlipTimeoutId&&(clearTimeout(this.autoFlipTimeoutId),this.autoFlipTimeoutId=null),this.autoFlip&&!this.isAutomatorOpen&&(this.autoFlipDelay<1&&(this.autoFlipDelay=1),this.autoFlipTimeoutId=setTimeout((function(){Backbone.Mediator.pub(WidgetEvent.AUTO_FLIP)}),1e3*this.autoFlipDelay)))},updateAutoFlip:function(){this.autoFlip=this.widgetSettings.get("autoFlip"),this.autoFlipDelay=this.widgetSettings.get("autoFlipDelay"),this.setAutoFlip()},stopAutoFlip:function(){this.autoFlipTimeoutId&&(clearTimeout(this.autoFlipTimeoutId),this.autoFlipTimeoutId=null)},handleAudioStopped:function(){this.isAudioPlaying=!1},handleWidgetClickOrTap:function(e){var t=$(e.target);(t.hasClass("page-content")||t.hasClass("page-image")||t.hasClass("custom-content")||t.hasClass("pdf-links"))&&this.stopAutoFlip()},isInitialized:function(){return this.widgetState&&this.widgetState.has("currentItem")},getFirstPage:function(){var e=this.arabicStyle?this.widgetState.get("currentItem").get("pages").length-1:0;return this.widgetState.get("currentItem").get("pages").models[e]||null},getFirstPageThumb:function(){var e=this.getFirstPage();return new PageCommon(e.toJSON()).get("src")||""},checkCollectionViewVisibility:function(){return!1},getShareOptions:function(){var e=this.widgetSettings.get("shareLinkText").indexOf("http://")>-1?this.widgetSettings.get("shareLinkText").replace("http://","https://"):this.widgetSettings.get("shareLinkText");return{sharePost:this.widgetSettings.get("sharePost"),shareLink:this.widgetSettings.get("shareLink"),shareLinkText:e,sharePinterest:this.widgetSettings.get("sharePinterest"),shareTwitter:this.widgetSettings.get("shareTwitter"),shareEmail:this.widgetSettings.get("shareEmail"),shareFaceBook:this.widgetSettings.get("shareFaceBook"),shareGooglePlus:this.widgetSettings.get("shareGooglePlus")}},getTOCData:function(){return FSWidgetModel.gi().get("collectionData").toc},goToUrl:function(e,t){var i=void 0===t?"_blank":t;window.parent!==window.top?("_blank"===i?window:parent).location.href=e:window.open(e,i)},sendEmail:function(e){void 0!==e&&(window.self!==window.top?window.top.location="mailto:"+e:window.location.href="mailto:"+e)},getItemIndex:function(e){var t=this.get("collectionData").collection,i=!1;return $.each(t,(function(t,n){return n.source!==e||(i=t,!1)})),i},getPagesBeforeItem:function(e){var t=this.get("collectionData").collection,i=0;return $.each(t,(function(t,n){return n.source!==e&&(i+=n.pageData.length,!0)})),i},countriesUpdated:function(){Backbone.Mediator.pub(WidgetEvent.COUNTRIES_LOADED)},getCountries:function(){return this.countries.get("countries")},getCountryOptions:function(){return this.countries.get("countryOptions")},getRealPageNumber:function(e,t){return this.flipCollection.get("items").at(e).get("pages").at(t).get("pageIndexInBook")},getCurrentDownloadLink:function(){var e=FSWidgetModel.gi().widgetState.get("currentItem"),t=URLPaths.EC3+"/flipsnack_download_pdf/getPDF.php?hash="+e.get("hash"),i="custom"===e.get("extension")?"jpg":e.get("extension")||"pdf",n=e.get("title").length>0?e.get("title"):e.get("hash")+"&extension="+i,s=t+"&title="+encodeURIComponent(n),o=FSWidgetModel.gi().get("collectionHash");return(e.get("hasCustomPages")||e.get("hasMovedPages"))&&(s+="&collectionHash="+encodeURIComponent(o)+"&hasCustomPages=true"),s},getCollectionDownloadLink:function(e){return e?FSUtils.getPrintLink():FSUtils.getDownloadLink()},sendMessage:function(e){var t=e.has("action")&&void 0!==EDITOR_ALERTS[e.get("action")]?EDITOR_ALERTS[e.get("action")]:null;t&&(FSWidgetModel.gi().widgetState.get("displayState")!==DisplayState.NORMAL&&Backbone.Mediator.pub(WidgetEvent.EXIT_FULLSCREEN),window.top.postMessage("editor_error_fnc:"+t,"*"),e.get("parent")&&e.get("parent").closePanel())},handleItemViewInitialized:function(){this.registerCollectionViewEvent()},registerCollectionViewEvent:function(){var e=this.widgetState.get("currentPageIndex"),t=this.widgetState.get("currentItem").get("pages");Backbone.Mediator.pub(StatsEvents.REGISTER,{eid:Stats.TYPE.VIEW_ITEM,pageIndex:e}),0===e||e===t.length-1?this.registerPageViewEvent(t.at(e).get("pID")):this.registerPageViewEvent([t.at(e).get("pID"),t.at(e+1).get("pID")])},registerPageViewEvent:function(e){var t;"number"==typeof e?Backbone.Mediator.pub(StatsEvents.REGISTER,{eid:Stats.TYPE.VIEW_PAGE,pid:e}):e&&e.length&&(t=e.filter((function(e){return"number"==typeof e||"string"==typeof e&&e.length})).map((function(e){return{eid:Stats.TYPE.VIEW_PAGE,pid:e}})),Backbone.Mediator.pub(StatsEvents.REGISTER,t))},singlePageChanged:function(){this.singlePageView=this.widgetSettings.get("singlePageView"),this.flipCollection.set("singlePageView",this.singlePageView),this.setItem(this.widgetState.get("currentItemIndex"),this.widgetState.get("currentPageIndex"))},changeZoom:function(e){var t=Math.max(0,Math.min(this.get("maxZoomValue"),e.value));this.set("currentZoom",t)},handleZoomChange:function(){Backbone.Mediator.pub(WidgetEvent.ZOOM_CHANGED,{value:this.get("currentZoom")})},handleMaxZoomChange:function(){Backbone.Mediator.pub(WidgetEvent.MAX_ZOOM_CHANGED)},canShowControls:function(){return!(!FSWidgetModel.gi().widgetSettings.get("showControls")||FSWidgetModel.gi().widgetState.get("isBuyCurtainDisplayed"))&&this.hasEnoughSpaceForControls()},hasEnoughSpaceForControls:function(){var e=FSWidgetModel.gi().get("width"),t=FSWidgetModel.gi().get("height");return e>FSWidgetModel.SHOW_CONTROLS_MIN_WIDTH&&t>FSWidgetModel.SHOW_CONTROLS_MIN_HEIGHT},resetZoom:function(){this.set("currentZoom",0)},updateSellSettings:function(){var e,t,i=FSWidgetModel.gi().get("sell").price,n=FSWidgetModel.gi().get("sell").subscriptionPrice;FSWidgetModel.gi().set("isForSelling",i&&i.length>0),FSWidgetModel.gi().set("isInSubscription",!!(n&&n.length>0)),FSWidgetModel.gi().get("isForSelling")&&(e=_.clone(FSWidgetModel.gi().get("sell")).previewPages,t=_.clone(this.flipCollection.get("previewPages")),FSUtils.compareArrays(e,t)||(this.flipCollection.set("previewPages",e),Backbone.Mediator.pub(WidgetEvent.PREVIEW_PAGES_UPDATED,FSUtils.arrayDiff(e,t))))},sendNewShelfItemLoadedEvent:function(e){Backbone.Mediator.pub(NewShelfEvents.ITEM_LOADED,e)},newShelfOpenItem:function(e){this.get("shelfData").set("itemHash",e.hash),ShelfUtils.loadShelfItem(e.hash,this.sendNewShelfItemLoadedEvent)},newShelfItemLoaded:function(e){var t;this.get("shelfData").set("itemOpened",!0),this.get("shelfData").set("shelfOpened",!1),(t=FSUtils.parseJSONData(e,FlipSnackEmbed.urls.siteURL,this.get("shelfData").get("itemHash"))).shelfData=this.get("shelfData"),Backbone.Mediator.pub(NewShelfEvents.RELOAD_WITH_ITEM,t)},updateLanguageSettings:function(){""===this.widgetSettings.get("language")||""===this.widgetSettings.get("language")?this.set("textDirection",TextDirection.RIGHT_TO_LEFT):this.set("textDirection",TextDirection.LEFT_TO_RIGHT),Backbone.Mediator.pub(WidgetEvent.CHANGE_LANGUAGE)},getAccessibilityData:function(){return FSWidgetModel.gi().get("collectionData").accessibility}});FSWidgetModel._instance=null,FSWidgetModel.gi=function(e){return!FSWidgetModel._instance&&e&&(FSWidgetModel._instance=new FSWidgetModel(e)),FSWidgetModel._instance},FSWidgetModel.SHOW_CONTROLS_MIN_WIDTH=400,FSWidgetModel.SHOW_CONTROLS_MIN_HEIGHT=330;var FlipCollection=Backbone.Model.extend({defaults:{noOfItems:1,hash:"",title:"",watermark:!1,type:"published",publisher:!0,blocked:!1,password:"",mergePdfs:!1,arabicStyle:!1,singlePageView:!1,hasCustomElements:!1,items:void 0,resourceVersion:"1",enableHardCover:!1,maxFlipPages:-1,previewPages:[],isDoublePageLayout:!1,leadForm:null},initialize:function(e){this.data=this.data||e,this.exportVideo=e.exportVideo,this.setupItems(this.data),this.listenTo(this,"change:singlePageView",this.singlePageChanged),this.listenTo(this,"change:previewPages",this.updatePreviewPages)},setupItems:function(e){this.totalPages=0,e.collection&&(this.set("items",this.parseCollectionItems(e.collection)),this.set("hasCustomElements",this.hasCustomElements()),this.get("isDoublePageLayout")&&this.setupForDoublePageLayout(this.get("items"))),this.set("noOfItems",this.get("items").length)},setupForDoublePageLayout:function(e){var t=e.at(0).get("pages").toJSON(),i=this.processPageElements(t);e.at(0).set("pages",i)},processPageElements:function(e){var t=this,i=new Pages;return _.each(e,(function(e,n,s){var o,a,r,l,c,d,h,u;n<=0||n>=s.length-2||n%2==0||(o=s[n+1],a=t.getPageElements(e),r=t.getPageElements(o),(l=t.checkIfDoublePageElementsHaveZIndex(a,r))||(t.addZIndexToElements(a,r),e.customElements=a,o.customElements=r),h=t.addPropsToPageElements(a,{sourcePage:SourcePage.LEFT,pageWidth:e.width,pageHeight:e.height,pid:e.pID}),u=t.addPropsToPageElements(r,{sourcePage:SourcePage.RIGHT,pageWidth:e.width,pageHeight:e.height,pid:e.pID}),l?((c=t.orderElementsByZIndex(e.customElements,u)).length&&(e.customElements=c),d=t.orderElementsByZIndex(h,o.customElements),c.length&&(o.customElements=d)):(u.length&&(e.customElements=a.concat(u)),h.length&&(o.customElements=h.concat(r))),i.add(e),i.add(o))})),i.unshift(e[0]),1!==e.length&&i.push(e[e.length-1]),i},getPageElements:function(e){return e.customElements&&e.customElements.length?e.customElements:[]},checkIfDoublePageElementsHaveZIndex:function(e,t){var i=_.some(e,(function(e){return"number"==typeof e.zIndex&&e.zIndex>0})),n=_.some(t,(function(e){return"number"==typeof e.zIndex&&e.zIndex>0}));return i||n},addZIndexToElements:function(e,t){var i=0;_.each(e,(function(e,t){e.zIndex="number"==typeof e.zIndex&&e.zIndex>0?e.zIndex:t+1,i=e.zIndex})),_.each(t,(function(e,t){e.zIndex="number"==typeof e.zIndex&&e.zIndex>0?e.zIndex:i+t+1}))},addPropsToPageElements:function(e,t){return _.map(e,(function(e){return $.extend(!0,{},e,t)}))},orderElementsByZIndex:function(e,t){var i=e.concat(t);return i.sort((function(e,t){return e.zIndex<t.zIndex?-1:e.zIndex>t.zIndex?1:0})),i},destroy:function(){this.off(),this.stopListening(),this.get("items").reset()},parseCollectionItems:function(e){var t,i,n=e&&e.length?e.length:0,s=new Items,o=this,a=this.get("maxFlipPages");if(n){$.each(e,(function(e,n){var r,l,c;if(a>0&&o.totalPages>=a&&!FlipSnackEmbed.isEditor||o.get("watermark")&&!o.get("mergePdfs")&&e+1>WATERMARK_ITEM_LIMIT)return!1;if(t=o.createCollectionItem(n,e),o.get("mergePdfs"))0===s.length?o.get("arabicStyle")?s.unshift(t):s.add(t):(r=t,l=t.get("pages"),t=s.at(0),o.get("arabicStyle")?t.get("pages").unshift(l.models):t.get("pages").add(l.models),(c=r.get("forms"))&&c.length&&t.set("forms",t.get("forms").concat(c)),t.set("noOfPages",t.get("noOfPages")+l.length),t.set("hasCustomPages",t.get("hasCustomPages")||r.get("hasCustomPages")),t.set("onlyCustomPages",t.get("onlyCustomPages")&&r.get("onlyCustomPages")),t.set("hasMovedPages",t.get("hasMovedPages")||r.get("hasMovedPages")),t.set("imagesOnly",t.get("imagesOnly")&&r.get("imagesOnly")),t.set("blocked",t.get("blocked")||r.get("blocked")));else{i=t.get("pages").length;var d=!o.get("singlePageView")||o.get("arabicStyle");i%2>0&&d&&1!==i&&(t.addBlankPage(o.get("arabicStyle")),t.set("noOfPages",t.get("noOfPages")+1)),s.add(t)}return!0})),i=s.at(0).get("pages").length;var r=!o.get("singlePageView")||o.get("arabicStyle");return this.get("mergePdfs")&&i%2>0&&1!==i&&r&&(s.at(0).addBlankPage(o.get("arabicStyle")),s.at(0).set("noOfPages",i)),this.get("arabicStyle")&&s.each((function(e){var t=e.get("noOfPages"),i=t%2>0&&1!==t;e.get("pages").each((function(e,t){e.set({pageIndex:i?t-1:t},{silent:!0})})),_.each(e.get("forms"),(function(e){e.index=t-e.index-(i?0:1)}))})),this.get("previewPages").length&&this.get("mergePdfs")&&(s.at(0).get("pages").at(-1).get("type")===PageType.EMPTY_PAGE&&s.at(0).get("pages").at(-1).set("isBlockedForSellingPreview",!0),this.setPagesForPreview(s.at(0),this.get("previewPages"))),s}},createCollectionItem:function(e,t){var i,n,s,o=new Pages,a=!1,r=!0,l=!1,c=!1,d=!1,h=this,u=URLPaths.getLinksForItem(e.source),p=[],g=this.get("maxFlipPages");return _.each(e.pageData,(function(t,s){var f=!1;if((!(g>0&&h.totalPages>=g)||FlipSnackEmbed.isEditor)&&(!h.get("watermark")||!(h.get("mergePdfs")&&h.totalPages>=WATERMARK_PAGE_LIMIT||!h.get("mergePdfs")&&s>=WATERMARK_PAGE_LIMIT))){if(h.totalPages++,i=h.get("mergePdfs")?h.totalPages-1:s,n=h.parseItemPageData(t,i,e,u),h.get("arabicStyle")?o.unshift(n):o.add(n),n.get("hasForm")){try{f=localStorage.getItem(h.get("hash"))}catch(e){f=!1}f||p.push({index:h.get("mergePdfs")?h.totalPages-1:s,formCanBlockItem:n.get("formCanBlockItem"),form:n.get("form")})}switch(d=d||n.get("hasForm")&&n.get("formCanBlockItem"),l=l||t.links&&t.links.length>0,t.type){case PageType.UPLOADED_PAGE:r=!1;break;case PageType.CUSTOM_PAGE:a=!0;break;case PageType.MOVED_PAGE:c=!0}}})),s={itemIndex:t,hash:e.source,title:e.name||(t+1).toString(),description:e.description||"",hardCover:h.get("enableHardCover"),noOfPages:o.length,hasCustomPages:a,onlyCustomPages:r,hasCustomContent:l,hasMovedPages:c,imagesOnly:"true"===e.imagesOnly||"boolean"==typeof e.imagesOnly&&e.imagesOnly,extension:e.extension,blocked:d,pages:o,forms:p},new CollectionItem(s)},parseItemPageData:function(e,t,i,n){var s=void 0!==e.pdfidx&&null!==e.pdfidx?parseInt(e.pdfidx,10):void 0,o=void 0!==e.type&&null!==e.type&&!isNaN(parseInt(e.type,10))?parseInt(e.type,10):0,a=this.getResolvedPageSize(e.width,DefaultPageSize.WIDTH),r=this.getResolvedPageSize(e.height,DefaultPageSize.HEIGHT),l={pageIndex:t,pageIndexInBook:this.get("mergePdfs")?this.totalPages:t+1,width:a,height:r,type:o,pdfidx:s,itemHash:e.originalHash||e.itemhash||i.source,originalHash:e.originalHash||"",pID:"string"==typeof e.pID?parseInt(e.pID,10):e.pID,thumbHash:o===PageType.CUSTOM_PAGE&&e.thumbHash?e.thumbHash:"page_"+(s+1),thumbVersion:e.thumbVersion||"1",extension:o!==PageType.CUSTOM_PAGE&&"string"==typeof i.extension&&i.extension.length>0?i.extension:"",isBlockedForSellingPreview:this.get("previewPages").length>0,bgColor:e.bgColor?e.bgColor:""},c=e.originalHash||e.itemhash?URLPaths.getLinksForItem(l.itemHash):n,d=this.getResourceVersion();return l.thumb=this.getImageURL(c.THUMB_IMAGE,l,l.thumbVersion),l.small=this.getImageURL(c.SMALL_IMAGE,l,d),l.medium=this.getImageURL(c.MEDIUM_IMAGE,l,d),l.original=o!==PageType.CUSTOM_PAGE?this.getImageURL(c.ORIGINAL_IMAGE,l,d):"",l.customElements=this.parsePageElements(e,l),new PageData(l)},parsePageElements:function(e,t){var i=[],n=this,s=this.get("leadForm");return e.products&&(t.products=e.products),s&&s.active&&s.pageIndex===t.pageIndex&&(t=$.extend(!0,t,n.getPageFormData(s))),e.links&&_.each(e.links,(function(e,o){e.type=parseInt(e.type,10),e.action=parseInt(e.action,10),e.icon||(e.icon={default:{id:e.type>0?e.type.toString():""}},e.type===ElementType.AUDIO&&(e.icon={default:{id:OldAudioIcon.ON},active:{id:OldAudioIcon.OFF}}),e.type===ElementType.CAPTION&&(e.icon={default:{id:OldCaptionIcon.CLOSED},active:{id:OldCaptionIcon.OPEN}})),e.type===ElementType.FORM&&n.exportVideo||(s&&s.pageIndex===t.pageIndex||e.type!==ElementType.FORM||!FSUtils.elementCanBeDisplayed(e.type,PremiumTypeLinks,n.get("publisher"))||(t=$.extend(!0,t,n.getPageFormData($.extend(!0,e,{pageIndex:t.pageIndex})))),i.push($.extend(!0,{},e)))})),i},getPageFormData:function(e){var t,i={hasForm:!0,form:$.extend(!0,{},e)};try{i.formCanBlockItem=e.limit===LeadFormBlocking.ALL&&!localStorage.getItem(this.get("hash"))}catch(t){i.formCanBlockItem=e.limit===LeadFormBlocking.ALL}return i.form.elements&&(e.elements&&e.elements.el&&e.elements.el.length?t=e.elements.el:e.elements&&e.elements.length&&(t=e.elements),i.form.elements=[].concat(t)),_.each(i.form.elements,(function(e){e.mandatory=1===parseInt(e.mandatory,10)||!0===e.mandatory,e.type=parseInt(e.type,10)})),i},getResourceVersion:function(){return this.get("resourceVersion")},getImageURL:function(e,t,i){var n="";if(t.type===PageType.CUSTOM_PAGE)n=e.replace("{page}",t.thumbHash);else n=e.replace("{page}","page_"+(t.pdfidx+1));return void 0!==i&&(n+="?v="+i),n},getResolvedPageSize:function(e,t){var i=t;if(e&&!isNaN(parseInt(e,10)))try{i=parseInt(e,10),i=isNaN(i)||0===i?t:i}catch(e){i=t}return i},getForms:function(){var e=[];return _.each(this.get("items").models,(function(t){var i=t.get("forms");i&&i.length&&(e=e.concat(i))})),e},hasCountryList:function(){var e=this.getForms(),t=!1,i=this;return e&&e.length&&(t=null!=_.find(e,(function(e){return i.formHasElement(e.form,LeadFormField.FIELD_TYPE_COUNTRY)}))),t},formHasElement:function(e,t){var i=e.elements,n=i&&_.find(i,(function(e){return e.type===t}));return null!=n},hasCustomElements:function(){var e=this.get("items").models,t=!1;return e&&(t=_.some(e,(function(e){var t=e.get("pages").models;return _.some(t,(function(e){var t=e.get("customElements");return t&&t.length}))}))),t},singlePageChanged:function(){this.destroy(),this.initialize()},setPagesForPreview:function(e,t){var i=e.get("pages"),n=this;t&&t.length&&_.each(t,(function(e){var t=n.get("arabicStyle")?i.length-e:e-1;i.at(t)&&i.at(t).set("isBlockedForSellingPreview",!1)}))},resetPagesForPreview:function(e){e.get("pages").forEach((function(e){e.set("isBlockedForSellingPreview",!0)}))},updatePreviewPages:function(){this.resetPagesForPreview(this.get("items").at(0)),this.setPagesForPreview(this.get("items").at(0),this.get("previewPages"))}}),Items=Backbone.Collection.extend({model:CollectionItem}),LeadFormModel=Backbone.Model.extend({defaults:{eID:0,pid:0,limit:LeadFormBlocking.ALL,header:"",bookIndex:0,pageIndex:0,realPageNumber:1,bookTitle:"",elements:[LeadFormElementEmail],labels:{},pageSize:[],formVersion:0},initialize:function(){this.checkElements(),this.listenTo(this,"change",this.checkElements)},checkElements:function(){var e=this.get("elements");Array.isArray(e)||(e=[e]),this.set("elements",e,{silent:!0})},destroy:function(){this.off()}}),NavSliderModel=Backbone.Model.extend({defaults:{pages:[],tooltipText:""}}),PageCommon=Backbone.Model.extend({defaults:{src:"",selected:!1},initialize:function(){this.set("src",this.get("thumb"),{silent:!0})},getPdfUrl:function(e){return"pdf"!==this.get("extension")?"":(e=e||"page_1",URLPaths.ITEMS_BASE_PATH+this.get("itemHash")+"/pdf_pages/"+e)},unselect:function(e){this.set("selected",!1,{silent:void 0!==e&&e})}}),PageData=Backbone.Model.extend({defaults:{pageIndex:0,pageIndexInBook:0,width:827,height:1170,type:PageType.UPLOADED_PAGE,source:"",thumbHash:"",pID:"",pdfidx:0,hasForm:!1,formCanBlockItem:!1,customElements:null,itemHash:"",originalHash:"",isBlockedForSellingPreview:!1,bgColor:""}}),Pages=Backbone.Collection.extend({model:PageData}),PdfLinks=Backbone.Model.extend({initialize:function(){this.pdfItems=[],this.pdfLinksLoaded=[],this.mergePdfs=FSWidgetModel.gi().widgetSettings.get("mergePdfs"),this.loadLinkJS(),this.listenTo(FSWidgetModel.gi().widgetState,"change:currentItem",this.onCurrentItemChanged)},onCurrentItemChanged:function(){this.removeRequest()},loadLinkJS:function(){this.mergePdfs?(this.setPdfItems(),this.pdfItems.length&&!FSWidgetModel.gi().widgetSettings.get("exportVideo")&&this.loadAllLinks()):"failed"===FSWidgetModel.gi().widgetState.get("currentItem").get("linkLoadStatus")||FSWidgetModel.gi().widgetSettings.get("exportVideo")||this.loadSingleItemJS()},setPdfItems:function(){var e=FSWidgetModel.gi().get("collectionData").collection,t=this;this.pdfItems=[],$.each(e,(function(e,i){"pdf"===i.extension&&t.pdfItems.push(i)}))},loadSingleItemJS:function(){var e=this,t=FSWidgetModel.gi().widgetState.get("currentItem"),i=FlipSnackEmbed.urls.items+t.get("hash")+FlipSnackEmbed.urls.linkJS;window.linksJs=null,delete window.linksJs,this.windowFunctionName="link_"+t.get("hash"),void 0===window[this.windowFunctionName]&&(window[this.windowFunctionName]=function(e){window.linksJs=e}),this.request=FSUtils.loadScript(i,(function(){e.linkJsLoaded()}),(function(){e.linkJSFail()}))},linkJsLoaded:function(){FSWidgetModel.gi().widgetState.get("currentItem").set("linkLoadStatus","success"),Backbone.Mediator.pub(WidgetEvent.PDF_LINKS_LOADED)},linkJSFail:function(){delete window["link_"+FSWidgetModel.gi().widgetState.get("currentItem").get("hash")],FSWidgetModel.gi().widgetState.get("currentItem").set("linkLoadStatus","failed")},setLinksJsMulti:function(){for(var e=FSWidgetModel.gi().widgetState.get("currentItem").get("pages"),t=[],i=0,n=this.pdfLinksLoaded.length;i<n;i++)t[this.pdfLinksLoaded[i].hash]=this.pdfLinksLoaded[i].linksData;window.linksJs={},$.each(e.models,(function(e,i){var n=t[i.get("itemHash")]||null,s=i.get("pdfidx");n&&n[s]&&i.get("type")===PageType.UPLOADED_PAGE&&(window.linksJs[e]=n[s])}))},loadAllLinks:function(){var e,t,i;this.pdfItems.length?(e=this.pdfItems.shift(),t=FlipSnackEmbed.urls.items+e.source+FlipSnackEmbed.urls.linkJS,i=this,this.windowAllFunctionName="link_"+e.source,window[this.windowAllFunctionName]=function(t){!1!==FSWidgetModel.gi().getItemIndex(e.source)&&i.pdfLinksLoaded.push({hash:e.source,linksData:t})},this.request=FSUtils.loadScript(t,(function(){i.loadAllLinks()}),(function(){i.loadAllLinks()}))):this.pdfLinksLoaded.length&&(this.setLinksJsMulti(),Backbone.Mediator.pub(WidgetEvent.PDF_LINKS_LOADED))},removeRequest:function(){this.request&&(this.request.parentNode.removeChild(this.request),this.request=null)},destroy:function(){this.stopListening(),this.pdfItems=null,this.removeRequest(),window[this.windowFunctionName]=null,window[this.windowAllFunctionName]=null,window.linksJs=null}}),ShelfData=Backbone.Model.extend({defaults:{resourceVersion:"1",enableHardCover:!1,maxFlipPages:-1,previewPages:[],items:void 0,shelfOpened:!1},initialize:function(e){this.data=this.data||e,this.setupItems(this.data),this.set("shelfOpened",e.shelfOpened)},setupItems:function(e){e&&e.items&&this.set("items",e.items),this.set("noOfItems",e.items.length)},destroy:function(){this.off(),this.stopListening()}}),SimpleLoaderModel=Backbone.Model.extend({defaults:{source:"",width:100,height:100,originalWidth:void 0,originalHeight:void 0,scaleMode:"scaleCrop",showPreloader:!0,status:ContentLoaderStatus.IDLE,isMapped:!1}}),WidgetSettings=Backbone.Model.extend({defaults:{widgetType:WidgetType.CLASSIC,collectionWidth:640,collectionHeight:385,mobileNavigationEffect:"slide",showNavigationFlipButtons:!0,showThumbView:!0,enableSounds:!0,sharePost:!0,shareLink:!0,shareFaceBook:!0,shareTwitter:!0,shareGooglePlus:!0,sharePinterest:!0,shareEmail:!0,shareLinkText:"",language:"English",mergePdfs:!1,transparentBackground:!1,autoFlip:!1,autoFlipDelay:6,useHighlights:!0,arabicStyle:!1,enableShelfToolTips:!0,singlePageView:!1,enableSearch:!0,remoteControlled:!0,startSizeMultiplier:100,backgroundScaleType:"scaleCrop",useBackgroundVignette:!1,logoImage:"",logoUrl:"",color:"DEDEDE",backgroundImage:"",enableHardCover:!1,showControls:!1,skinType:"classic",productDetails:null,contentLayout:void 0}}),WidgetState=Backbone.Model.extend({defaults:{currentItemIndex:0,currentItem:void 0,currentPageIndex:0,leftPageIndex:-1,rightPageIndex:0,displayState:DisplayState.NORMAL,widgetType:WidgetType.CLASSIC,displayType:DisplayType.SMALL,isBuyCurtainDisplayed:!1}}),AccessibilityButton=Backbone.View.extend({events:{click:"toggle"},template:_.template(Templates.accessibilityButton),className:"accessibility-button-container",initialize:function(){Backbone.Mediator.sub(WidgetEvent.CLOSE_ACCESSIBILITY,this.close,this)},render:function(){return this.$el.html(this.template()),FSUtils.isIpad()&&this.$el.addClass("accessibility-button-tablet"),this},close:function(){this.model.set("open",!1)},toggle:function(){this.model.get("open")?(Backbone.Mediator.pub(WidgetEvent.CLOSE_ACCESSIBILITY),this.model.set("open",!1)):(Backbone.Mediator.pub(WidgetEvent.OPEN_ACCESSIBILITY),this.model.set("open",!0))}}),AccessibilityPanel=Backbone.View.extend({template:_.template(Templates.accessibilityPanel),className:"accessibility-panel-container",events:{"click .accessibility-close-button":"closePanel","click .accessibility-page-previous":"prevPage","click .accessibility-page-next":"nextPage","click .accessibility-zoom-out":"zoomOut","click .accessibility-zoom-in":"zoomIn"},initialize:function(){this.pageNumber=null,this.fontSize=16,this.open=!1,Backbone.Mediator.sub(WidgetEvent.RESIZE,this.resize,this),Backbone.Mediator.sub(WidgetEvent.OPEN_ACCESSIBILITY,this.showPanel,this),Backbone.Mediator.sub(WidgetEvent.CLOSE_ACCESSIBILITY,this.hidePanel,this),Backbone.Mediator.sub(WidgetEvent.LEAD_FORM_SENT,this.render,this),this.listenTo(FSWidgetModel.gi().widgetState,"change:currentPageIndex",this.render),this.listenTo(FSWidgetModel.gi().widgetState,"change:isBuyCurtainDisplayed",this.render),this.listenTo(FSWidgetModel.gi().widgetState,"change:currentItem",this.render),this.isMobile&&this.listenTo(FSWidgetModel.gi().widgetState,"change:rightPageIndex",this.render),this.listenTo(this.model,"change:width",this.render)},render:function(){return this.titleFontDifference=2,this.lineHeightMultiplier=1.5,this.letterSpacingMultiplier=.12,this.wordSpacingMultiplier=.16,this.isMobile=FSUtils.isMobileDevice(),this.$el.html(this.template()),this.pageIndex=FSWidgetModel.gi().widgetState.get("leftPageIndex")<0?0:FSWidgetModel.gi().widgetState.get("leftPageIndex"),this.previousButton=this.$el.find(".accessibility-page-previous"),this.nextButton=this.$el.find(".accessibility-page-next"),this.totalPages=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").length,this.accessibilityPageNumber=this.$el.find(".accessibility-page-number"),this.title=this.$el.find(".accessibility-content-title"),this.description=this.$el.find(".accessibility-content-description"),this.zoomOutButton=this.$el.find(".accessibility-zoom-out svg"),this.zoomInButton=this.$el.find(".accessibility-zoom-in svg"),this.contentContainer=this.$el.find(".accessibility-content"),this.open&&(this.addPageNumber(),this.addPageAccessibilityText(),0===this.pageIndex?(this.hidePrevious(),this.showNext()):this.pageIndex===this.totalPages-1?(this.showPrevious(),this.hideNext()):(this.showPrevious(),this.showNext())),this.$el.css({height:FSWidgetModel.gi().get("height")+"px"}),this.contentContainer.css({height:FSWidgetModel.gi().get("height")-160+"px"}),this},resize:function(){this.$el.css({height:FSWidgetModel.gi().get("height")+"px"}),this.contentContainer.css({height:FSWidgetModel.gi().get("height")-160+"px"})},showPanel:function(){this.isMobile&&FSWidgetModel.gi().get("width")<450?this.$el.css({width:FSWidgetModel.gi().get("width")+"px",overflow:"auto"}):this.$el.css({width:"450px",overflow:"auto"}),this.open=!0,this.render()},hidePanel:function(){this.$el.css({width:0,overflow:"hidden"}),this.open=!1,this.render()},closePanel:function(){Backbone.Mediator.pub(WidgetEvent.CLOSE_ACCESSIBILITY),this.model.set("open",!1)},haveFormsOnPage:function(){var e=FSWidgetModel.gi().widgetState.get("currentItem")&&FSWidgetModel.gi().widgetState.get("currentItem").get("forms"),t=!1;if(e.length){var i=FSWidgetModel.gi().widgetState.get("currentPageIndex");_.each(e,(function(e){e.index===i&&(t=!0)}))}return t},addPageNumber:function(){var e=FSWidgetModel.gi().widgetSettings.get("singlePageView"),t=FSWidgetModel.gi().widgetSettings.get("arabicStyle"),i=FSWidgetModel.gi().widgetState.get("leftPageIndex")<0?0:FSWidgetModel.gi().widgetState.get("leftPageIndex"),n=t?this.totalPages-i:i+1,s=t?n-1:n+1,o=[n];FSUtils.isMobileDevice()&&FSUtils.isPortrait()||e||n<this.totalPages&&n>1&&o.push(s),this.pageNumber=new AccessibilityPageNumber({model:new Backbone.Model({totalPages:this.totalPages,currentPage:o.join("-")})}),this.accessibilityPageNumber.append(this.pageNumber.render().el)},changeElementZoom:function(e,t,i){var n=parseInt(e.css("font-size"),10);"in"===t?(e.css("font-size",n+i),e.css("line-height",(n+i)*this.lineHeightMultiplier+"px"),e.css("letter-spacing",(n+i)*this.letterSpacingMultiplier),e.css("word-spacing",(n+i)*this.wordSpacingMultiplier)):"out"===t&&(e.css("font-size",n-i),e.css("line-height",(n-i)*this.lineHeightMultiplier+"px"),e.css("letter-spacing",(n-i)*this.letterSpacingMultiplier),e.css("word-spacing",(n-i)*this.wordSpacingMultiplier))},initializeTextSize:function(){this.$el.find(".accessibility-content-description").css("font-size",this.fontSize),this.$el.find(".accessibility-content-description").css("line-height",this.fontSize*this.lineHeightMultiplier+"px"),this.$el.find(".accessibility-content-description").css("letter-spacing",this.fontSize*this.letterSpacingMultiplier),this.$el.find(".accessibility-content-description").css("word-spacing",this.fontSize*this.wordSpacingMultiplier),this.$el.find(".accessibility-content-title").css("font-size",this.fontSize+this.titleFontDifference),this.$el.find(".accessibility-content-title").css("line-height",this.fontSize*this.lineHeightMultiplier+this.titleFontDifference+"px"),this.$el.find(".accessibility-content-title").css("letter-spacing",this.fontSize*this.letterSpacingMultiplier+this.titleFontDifference),this.$el.find(".accessibility-content-title").css("word-spacing",this.fontSize*this.wordSpacingMultiplier+this.titleFontDifference),this.fontSize<14?this.zoomOutButton.css("opacity",.4):this.fontSize>68&&this.zoomInButton.css("opacity",.4)},addPageAccessibilityText:function(){var e=FSWidgetModel.gi().widgetSettings.get("singlePageView"),t=FSWidgetModel.gi().widgetState.get("currentPageIndex"),i=t+1,n=FSWidgetModel.gi().widgetSettings.get("arabicStyle"),s=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").at(t).get("pID");if(this.model.get("data")[s]&&(this.model.get("data")[s].title&&this.title.append(this.model.get("data")[s].title.encodeHTML()),this.model.get("data")[s].description&&this.description.append(this.model.get("data")[s].description.encodeHTML())),FSWidgetModel.gi().widgetState.get("isBuyCurtainDisplayed")||this.haveFormsOnPage())this.haveFormsOnPage()?(this.title.empty().append(FSWidgetModel.gi().get("labels").l_acsb_title),this.description.empty().append(FSWidgetModel.gi().get("labels").l_acsb_form)):(this.title.empty().append(FSWidgetModel.gi().get("labels").l_acsb_title),this.description.empty().append(FSWidgetModel.gi().get("labels").l_acsb_description));else if(!(FSUtils.isMobileDevice()&&FSUtils.isPortrait()||e||0===t||t===this.totalPages-1)){var o=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").at(i).get("pID");this.model.get("data")[o]&&(this.model.get("data")[o].title&&(n?this.model.get("data")[o].description&&this.description.clone().empty().append(this.model.get("data")[o].description.encodeHTML()).prependTo(this.contentContainer):this.title.clone().empty().append(this.model.get("data")[o].title.encodeHTML()).appendTo(this.contentContainer)),this.model.get("data")[o].description&&(n?this.model.get("data")[o].title&&this.title.clone().empty().append(this.model.get("data")[o].title.encodeHTML()).prependTo(this.contentContainer):this.description.clone().empty().append(this.model.get("data")[o].description.encodeHTML()).appendTo(this.contentContainer)))}this.initializeTextSize()},prevPage:function(){Backbone.Mediator.pub(WidgetEvent.PREV_PAGE)},nextPage:function(){Backbone.Mediator.pub(WidgetEvent.NEXT_PAGE)},showPrevious:function(){this.previousButton.css("opacity",1)},hidePrevious:function(){this.previousButton.css("opacity",0)},showNext:function(){this.nextButton.css("opacity",1)},hideNext:function(){this.nextButton.css("opacity",0)},zoomOut:function(){this.fontSize-2>=12&&(this.fontSize<40?(this.changeElementZoom(this.$el.find(".accessibility-content-description"),"out",2),this.changeElementZoom(this.$el.find(".accessibility-content-title"),"out",2),this.fontSize-=2,this.zoomInButton.css("opacity",1)):(this.changeElementZoom(this.$el.find(".accessibility-content-description"),"out",4),this.changeElementZoom(this.$el.find(".accessibility-content-title"),"out",4),this.fontSize-=4,this.zoomInButton.css("opacity",1))),12===this.fontSize&&this.zoomOutButton.css("opacity",.4)},zoomIn:function(){this.fontSize+4<=70&&(this.fontSize>40?(this.changeElementZoom(this.$el.find(".accessibility-content-description"),"in",4),this.changeElementZoom(this.$el.find(".accessibility-content-title"),"in",4),this.fontSize+=4):(this.changeElementZoom(this.$el.find(".accessibility-content-description"),"in",2),this.changeElementZoom(this.$el.find(".accessibility-content-title"),"in",2),this.fontSize+=2),this.zoomOutButton.css("opacity",1)),70===this.fontSize&&this.zoomInButton.css("opacity",.4)}}),AutomatorView=Backbone.View.extend({template:_.template(Templates.automatorView),productTemplate:_.template(Templates.automatorProduct),id:ComponentContainers.AUTOMATOR_VIEW,events:function(){return FSUtils.isMobileDevice()?{"touchend #toggleProductsButton":"onClickButton","touchend .view-more":"onViewMore","touchend .view-less":"onViewLess"}:{"click #toggleProductsButton":"onClickButton","click .view-more":"onViewMore","click .view-less":"onViewLess"}},initialize:function(){this.openContainer=!1,this.isPlayerSkin=FSUtils.isPlayerSkin(),this.visibleData=FSWidgetModel.gi().get("collectionData").params.productDetails,this.listenTo(FSWidgetModel.gi().widgetState,"change:currentPageIndex",this.render),this.listenTo(FSWidgetModel.gi().widgetSettings,"change:singlePageView",this.render),this.listenTo(FSWidgetModel.gi(),"change:height",this.setCss),this.listenTo(FSWidgetModel.gi(),"change:width",this.setCss),Backbone.Mediator.sub(WidgetEvent.OPEN_SEARCH_OPTIONS,this.hideContainer,this),Backbone.Mediator.sub(WidgetEvent.CLOSE_SEARCH_OPTIONS,this.showContainer,this),Backbone.Mediator.sub(WidgetEvent.FULLSCREEN_CHANGED,this.setCss,this)},render:function(){var e=this.getProductsInView();return this.model.set("products",e),this.model.set("productsCount",e.length),this.model.set("buttonLabel",this.openContainer?"Hide":"Show"),this.model.set("arrowSrc",URLPaths.ASSETS_PATH+"automator-arrow.gz.svg"),this.$el.html(this.template(this.model.attributes)),this.productsContainer=this.$el.find(".products-container"),this.renderProducts(),this.setCss(),this},renderProducts:function(){var e=this;$.each(this.model.get("products"),(function(t,i){var n=$.extend(!0,{},i);if(n.image_link=n.image_hash,e.visibleData&&e.visibleData.length&&Object.keys(n).forEach((function(t){-1===e.visibleData.indexOf(t)&&(n[t]="")})),n.showReadMore=!1,n.full_price=n.full_price?n.full_price:"",n.sell_price=n.sell_price?n.sell_price:"",n.link=n.link?n.link:"",n.description=n.description?n.description.replace(/^\s*[\r\n]/gm,""):"",n.title=n.title?n.title:"",n.index=t,n.description.length>AutomatorView.PRODUCT_DESCRIPTION_LIMIT){var s=n.description;n.showReadMore=!0,n.visibleDescription=s.substring(0,n.image_link?AutomatorView.PRODUCT_DESCRIPTION_LIMIT:AutomatorView.PRODUCT_ONLY_DESCRIPTION_LIMIT),n.hiddenDescription=s.substring(AutomatorView.PRODUCT_DESCRIPTION_LIMIT,s.length)}if(n.image_link){var o=FSWidgetModel.gi().get("accountId"),a=FSUtils.getUserExternalLibraryURL(o);n.image_link=a+n.image_link}e.productsContainer.append(e.productTemplate(n))}))},setCss:function(){var e=FSWidgetModel.gi(),t=this.isPlayerSkin||FSUtils.isInFullScreen()||FSWidgetModel.gi().widgetSettings.get("showControls")&&e.get("width")>FSWidgetModel.SHOW_CONTROLS_MIN_WIDTH&&e.get("height")>FSWidgetModel.SHOW_CONTROLS_MIN_HEIGHT,i=this.isPlayerSkin?"75px":"46px";if(this.$el.css({"margin-bottom":t&&!this.openContainer?i:"0px",display:this.model.get("productsCount")?"block":"none",bottom:this.isPlayerSkin?"-60px":0}),this.productsContainer.animate({opacity:this.openContainer?1:0,height:this.openContainer?"100%":"0px"},100),this.openContainer){this.$el.addClass("open");var n=e.get("height")-AutomatorView.PADDING_OFFSET;n<40&&(n=40),this.$el.css({"padding-top":this.model.get("productsCount")>AutomatorView.PRODUCTS_PER_ROW?"40px":n+"px"}),this.$el.animate({height:"100vh"},100)}else this.$el.removeClass("open"),this.$el.animate({height:"0","padding-top":0},200);var s=this.getProductsPerRow(e.get("width")),o=(e.get("width")-301*s)/2-10;this.productsContainer.css({"padding-left":o+"px","padding-right":o+"px"}),this.model.set("buttonLabel",this.openContainer?"Hide":"Show")},onClickButton:function(){this.openContainer=!this.openContainer,this.model.set("buttonLabel",this.openContainer?"Hide":"Show"),this.$el.find("#buttonLabel").text(this.model.get("buttonLabel")),this.openContainer?Backbone.Mediator.pub(WidgetEvent.OPEN_AUTOMATOR,this):Backbone.Mediator.pub(WidgetEvent.CLOSE_AUTOMATOR,this),this.setCss()},getProductsPerRow:function(e){return e>1250?4:e>950?3:e>650?2:1},onViewMore:function(e){var t=e.target.getAttribute("data-index");this.productsContainer.find(".dots-"+t).css({display:"none"}),this.productsContainer.find(".more-"+t).css({display:"none"}),this.productsContainer.find(".visible-"+t).css({display:"none"}),this.productsContainer.find(".hidden-"+t).css({display:"inline"}),this.productsContainer.find(".product-"+t).css({height:"100%"}),this.productsContainer.find(".less-"+t).css({display:"block"})},onViewLess:function(e){var t=e.target.getAttribute("data-index");this.productsContainer.find(".dots-"+t).css({display:"inline"}),this.productsContainer.find(".more-"+t).css({display:"block"}),this.productsContainer.find(".visible-"+t).removeAttr("style"),this.productsContainer.find(".hidden-"+t).removeAttr("style"),this.productsContainer.find(".product-"+t).removeAttr("style"),this.productsContainer.find(".less-"+t).css({display:"none"})},showContainer:function(){this.$el.css({"z-index":31005})},hideContainer:function(){this.$el.css({"z-index":3e3})},getProductsInView:function(){var e=[];if(FSWidgetModel.gi().widgetState.get("currentItem")){var t=FSWidgetModel.gi().widgetState.get("currentItem").get("pages"),i=FSWidgetModel.gi().widgetState.get("currentPageIndex");t.models[i]&&t.models[i].attributes&&t.models[i].attributes.products&&(e=e.concat(t.models[i].attributes.products)),!FSWidgetModel.gi().widgetSettings.get("singlePageView")&&0!==i&&t.models[i+1]&&t.models[i+1].attributes&&t.models[i+1].attributes.products&&(e=e.concat(t.models[i+1].attributes.products))}return e},remove:function(){Backbone.Mediator.unsubscribe(WidgetEvent.OPEN_SEARCH_OPTIONS,this.hideContainer,this),Backbone.Mediator.unsubscribe(WidgetEvent.CLOSE_SEARCH_OPTIONS,this.showContainer,this),Backbone.Mediator.unsubscribe(WidgetEvent.FULLSCREEN_CHANGED,this.setCss,this)}});AutomatorView.PADDING_OFFSET=495,AutomatorView.PRODUCT_DESCRIPTION_LIMIT=70,AutomatorView.PRODUCT_ONLY_DESCRIPTION_LIMIT=380,AutomatorView.PRODUCTS_PER_ROW=4,AutomatorView.BUTTON_HEGHT=40;var BuyButton=Backbone.View.extend({events:{click:"sendTrackingData"},template:_.template(Templates.buyButton),id:ComponentContainers.BUY_BUTTON,className:"buy-button-container",initialize:function(){this.listenTo(this.model,"change:price",this.render),this.listenTo(this.model,"change:subscriptionPrice",this.render),this.listenTo(this.model,"change:subscriptionFlipbooks",this.render),this.listenTo(this.model,"change:isInSubscription",this.render),this.listenTo(FSWidgetModel.gi(),"change:hasAccessToCart",this.render),this.listenTo(FSWidgetModel.gi(),"change:labels",this.changeLabel)},changeLabel:function(){this.model.set("singleFlipbook",FSWidgetModel.gi().get("labels").l_single_flipbook),this.model.set("issues",FSWidgetModel.gi().get("labels").l_issues),this.model.set("buySubscription",FSWidgetModel.gi().get("labels").l_subscription),this.model.set("buyLabel",FSWidgetModel.gi().get("labels").l_buy),this.model.set("rollingSubscriptionLabel",FSWidgetModel.gi().get("labels").l_buy_subscription),this.render()},render:function(){return this.model.get("accessibilityEnabled")&&this.$el.addClass("accessibility-enabled"),this.$el.html(this.template(this.model.attributes)),this},sendTrackingData:function(e){FSWidgetModel.gi().get("hasAccessToCart")&&e.target.className.indexOf("issue-btn")>-1&&(e.preventDefault(),FSWidgetModel.gi().widgetState.get("displayState")!==DisplayState.NORMAL&&Backbone.Mediator.pub(WidgetEvent.EXIT_FULLSCREEN),window.top.postMessage("addToCart-"+FSWidgetModel.gi().get("accountId")+"-"+FSWidgetModel.gi().get("collectionHash"),"*")),"string"==typeof FSWidgetModel.gi().get("collectionData").trackingId&&FSWidgetModel.gi().get("collectionData").trackingId.length&&!FlipSnackEmbed.isEditor&&Tracker.gtag(FSWidgetModel.gi().get("collectionData").title,"Click to buy")}}),BuyCurtain=Backbone.View.extend({events:{"click .prev-btn":"handlePreviousPage","click .next-btn":"handleNextPage","click .buy-btn":"sendTrackingData","click .full-screen-exit-btn":"exitFullScreen"},template:_.template(Templates.buyCurtain),className:"curtain-content",initialize:function(){this.listenTo(this.model,"change:price",this.render),this.listenTo(this.model,"change:subscriptionPrice",this.render),this.listenTo(this.model,"change:subscriptionFlipbooks",this.render),this.listenTo(this.model,"change:isInSubscription",this.render),this.listenTo(FSWidgetModel.gi(),"change:labels",this.changeLabel)},changeLabel:function(){this.model.set("singleFlipbook",FSWidgetModel.gi().get("labels").l_single_flipbook),this.model.set("issues",FSWidgetModel.gi().get("labels").l_issues),this.model.set("buySubscription",FSWidgetModel.gi().get("labels").l_subscription),this.model.set("message",FSWidgetModel.gi().get("labels").l_cortina_message),this.model.set("buyLabel",FSWidgetModel.gi().get("labels").l_buy),this.model.set("rollingSubscriptionLabel",FSWidgetModel.gi().get("labels").l_buy_subscription),this.render()},render:function(){return this.$el.html(this.template(this.model.attributes)),this},sendTrackingData:function(e){FSWidgetModel.gi().get("hasAccessToCart")&&e.target.className.indexOf("issue-btn")>-1&&(e.preventDefault(),FSWidgetModel.gi().widgetState.get("displayState")!==DisplayState.NORMAL&&Backbone.Mediator.pub(WidgetEvent.EXIT_FULLSCREEN),window.top.postMessage("addToCart-"+FSWidgetModel.gi().get("accountId")+"-"+FSWidgetModel.gi().get("collectionHash"),"*")),"string"==typeof FSWidgetModel.gi().get("collectionData").trackingId&&FSWidgetModel.gi().get("collectionData").trackingId.length&&!FlipSnackEmbed.isEditor&&Tracker.gtag(FSWidgetModel.gi().get("collectionData").title,"Click to buy")},handlePreviousPage:function(){Backbone.Mediator.pub(WidgetEvent.PREV_PAGE)},handleNextPage:function(){Backbone.Mediator.pub(WidgetEvent.NEXT_PAGE)},exitFullScreen:function(){Backbone.Mediator.pub(WidgetEvent.EXIT_FULLSCREEN)}}),ClickToReadButton=Backbone.View.extend({template:_.template(Templates.clickToRead),id:ComponentContainers.CLICK_TO_READ,initialize:function(){var e=FSUtils.isMobileDevice()?"touchend":"click";this.listenTo(FSWidgetModel.gi(),"change:labels",this.changeLabel),this.$el.on(e,this.sendFullScreenEvent),Backbone.Mediator.sub(WidgetEvent.RESIZE,this.resize,this),Backbone.Mediator.sub(WidgetEvent.CHANGE_LANGUAGE,this.setTextDirection,this),this.stateTimeout=null},render:function(){return this.$el.html(this.template(this.model.attributes)),this.setTextDirection(),this.resize(),this},resize:function(){this.$el.css({left:Math.round((FSWidgetModel.gi().get("width")-ClickToReadButton.BUTTON_SIZE)/2)+"px",top:Math.round((FSWidgetModel.gi().get("height")-ClickToReadButton.BUTTON_SIZE)/2)+"px"})},changeLabel:function(){this.model.set("label",FSWidgetModel.gi().get("labels").l_click_to_read),this.render()},sendFullScreenEvent:function(){"string"==typeof FSWidgetModel.gi().get("collectionData").trackingId&&FSWidgetModel.gi().get("collectionData").trackingId.length&&!FlipSnackEmbed.isEditor&&Tracker.gtag(FSWidgetModel.gi().get("collectionData").title,"Click to read"),Backbone.Mediator.pub(WidgetEvent.ENTER_FULLSCREEN)},show:function(){clearTimeout(this.stateTimeout),this.$el.show(),this.resize(),this.$el.css("opacity",1)},hide:function(){var e=this;this.$el.css("opacity","0"),clearTimeout(this.stateTimeout),this.stateTimeout=setTimeout((function(){e.$el.hide()}),300)},setTextDirection:function(){FSWidgetModel.gi().get("textDirection")===TextDirection.RIGHT_TO_LEFT?this.$el.find(".click-to-read").addClass("reverse-text"):this.$el.find(".click-to-read").removeClass("reverse-text")},remove:function(){clearTimeout(this.stateTimeout),this.stateTimeout=null,this.$el.off(),Backbone.Mediator.unsubscribe(WidgetEvent.RESIZE,this.resize,this),Backbone.Mediator.unsubscribe(WidgetEvent.CHANGE_LANGUAGE,this.setTextDirection,this),Backbone.View.prototype.remove.apply(this,arguments)}});ClickToReadButton.BUTTON_SIZE=58;var FSWidgetView=Backbone.View.extend({events:{mouseenter:"onMouseOver",mouseover:"onMouseOver",mouseleave:"onMouseLeave"},initialize:function(){this.hoverTimer=null,SQSManager.gi(),FlipSnackEmbed.isEditor||FSWidgetModel.gi().get("blockEvents")||Stats.gi(),!FSWidgetModel.gi().get("collectionData").security||FlipSnackEmbed.isEditor&&!FlipSnackEmbed.isPublish?FlipSnackEmbed.isRestrictedDomain||this.initWidgetView(!0):(this.po=new PasswordOverlay,this.pp=new PasswordPopinView({model:new Backbone.Model}),this.$el.append(this.po.render().$el).append(this.pp.render().$el)),Backbone.Mediator.sub(WidgetEvent.WIDGET_VIEW_INIT,this.initWidgetView,this),this.listenTo(FSWidgetModel.gi(),"change:labels",this.labelChange),parent.postMessage(IFRAME_LOAD_MESSAGE,"*")},genericPopin:!1,productTagPopin:!1,spotlightPopin:!1,popupFrame:!1,onMouseLeave:function(e){var t=!0===e&&!FSWidgetModel.gi().get("collectionData").security;this.clearHoverEvents(t),t&&Backbone.Mediator.pub(StatsEvents.REGISTER_COLLECTION_VIEW)},onMouseOver:function(){var e=this;this.hoverTimer&&this.clearHoverEvents(),this.hoverTimer=setTimeout((function(){e.onMouseLeave(!0)}),Stats.HOVER_TIMER)},clearHoverEvents:function(e){this.hoverTimer&&clearTimeout(this.hoverTimer),e&&this.removeHoverEvents()},removeHoverEvents:function(){this.undelegateEvents()},labelChange:function(){this.pp&&(this.pp.labelChange(),this.pp.render())},initWidgetView:function(e){var t=FSWidgetModel.gi().get("collectionData").security;(e||t&&"object"==typeof e&&FSUtils.isCorrectPassword(e.password))&&(e||this.clearHoverEvents(!0),this.removePasswordPopin(),Backbone.Mediator.pub(WidgetEvent.STARTUP),this.layoutManager=new LayoutManager({model:new Backbone.Model({width:this.model.get("width"),height:this.model.get("height")})}),this.$el.append(this.layoutManager.render().$el),this.listenTo(this.model,"change",this.render),Backbone.Mediator.sub(WidgetEvent.POPIN_OPEN,this.showPopin,this),Backbone.Mediator.sub(WidgetEvent.OPEN_PRODUCT_TAG_POPIN,this.showProductTagPopin,this),Backbone.Mediator.sub(WidgetEvent.OPEN_SPOTLIGHT_POPIN,this.showSpotlightPopin,this),Backbone.Mediator.sub(WidgetEvent.OPEN_POPUP_FRAME,this.showPopupFrame,this),Backbone.Mediator.sub(WidgetEvent.POPIN_CLOSE,this.hidePopin,this),Backbone.Mediator.sub(WidgetEvent.CLOSE_PRODUCT_TAG_POPIN,this.hideProductTagPopin,this),Backbone.Mediator.sub(WidgetEvent.CLOSE_SPOTLIGHT_POPIN,this.hideSpotlightPopin,this),Backbone.Mediator.sub(WidgetEvent.CLOSE_POPUP_FRAME,this.hidePopupFrame,this),Backbone.Mediator.sub(WidgetEvent.POPIN_RESIZE,this.resizePopin,this),Backbone.Mediator.sub(ShelfEvents.SHELF_OPENED,this.closePopin,this),Backbone.Mediator.pub(WidgetEvent.CONFIG_DONE),FontManager.gi())},render:function(){var e={},t=!1;return("width"in this.model.changed||"height"in this.model.changed)&&(t=!0,e.width=this.model.get("width"),e.height=this.model.get("height")),"logo"in this.model.changed&&(t=!0,e.logo=this.model.get("logo")),t&&this.layoutManager.model.set(e),this},fullScreenChange:function(e){var t;t=e?this.model.get("allowBrowserFullScreen")?DisplayState.FULLSCREEN:DisplayState.CLASSIC_FULLSCREEN:DisplayState.NORMAL,this.model.widgetState.set("displayState",t),Backbone.Mediator.pub(WidgetEvent.FULLSCREEN_CHANGED,{displayState:t}),this.spotlightPopin&&this.spotlightPopin.hidePopin(),this.popupFrame&&this.spotlightPopin.hidePopin()},showPopin:function(e,t){this.genericPopin||(this.genericPopin=new GenericPopin,this.$el.append(this.genericPopin.render().el)),this.genericPopin.setContent(e),this.genericPopin.showModal(t.genericVideoButton)},showProductTagPopin:function(e){this.productTagPopin||(this.productTagPopin=new ProductTagPopin,this.$el.append(this.productTagPopin.render().el)),this.productTagPopin.showModal(e)},getImageSrc:function(e){if(e.provider&&"external"===e.provider){var t=FSWidgetModel.gi().get("accountId"),i=window.URLPaths.CONTENT_PATH.length?"/":"";return window.URLPaths.CONTENT_PATH+i+t+"/library/external/"+e.hash}return FlipSnackEmbed.urls.uploadPath+e.hash},showSpotlightPopin:function(e){switch(this.spotlightPopin||(this.spotlightPopin=new SpotlightPopin,this.$el.append(this.spotlightPopin.render().el)),e.action){case LinkAction.SPOTLIGHT:this.spotlightPopin.showModal({spotlightImageUrl:e.spotlightImageUrl?FlipSnackEmbed.urls.uploadPath+e.spotlightImageUrl:"",scale:e.scale,width:this.model.get("width"),height:this.model.get("height"),imageWidth:e.spotlightImageWidth,imageHeight:e.spotlightImageHeight});break;case LinkAction.PHOTO_SLIDESHOW:this.spotlightPopin.showModal({spotlightImageUrl:e.media&&e.media.length&&e.media[0].hash?this.getImageSrc(e.media[0]):"",scale:e.scale,width:this.model.get("width"),height:this.model.get("height")})}},showPopupFrame:function(e){this.popupFrame||(this.popupFrame=new PopupFrame,this.$el.append(this.popupFrame.render().el)),this.popupFrame.showModal({popupFrameCode:e.popupFrameCode||"",scale:e.scale,width:this.model.get("width"),height:this.model.get("height")})},hidePopin:function(){this.genericPopin&&this.genericPopin.hidePopin()},hideProductTagPopin:function(){this.productTagPopin&&this.productTagPopin.hidePopin()},hideSpotlightPopin:function(){this.spotlightPopin&&this.spotlightPopin.hidePopin()},hidePopupFrame:function(){this.popupFrame&&this.popupFrame.hidePopin()},closePopin:function(){this.genericPopin&&this.genericPopin.closePopin()},resizePopin:function(){this.genericPopin&&this.genericPopin.centerPopin()},removePasswordPopin:function(){this.pp&&(this.pp.remove(),this.pp=null,FSWidgetModel.gi().unset("passwordPopinVisible"),Backbone.Mediator.pub(StatsEvents.REGISTER_COLLECTION_VIEW)),this.po&&(this.po.remove(),this.po=null)},remove:function(){this.removePasswordPopin(),this.genericPopin&&(this.genericPopin.remove(),this.genericPopin=null),this.layoutManager&&(this.layoutManager.remove(),this.layoutManager=null),Backbone.Mediator.unsubscribe(WidgetEvent.WIDGET_VIEW_INIT,this.initWidgetView,this),Backbone.Mediator.unsubscribe(WidgetEvent.POPIN_OPEN,this.showPopin,this),Backbone.Mediator.unsubscribe(WidgetEvent.OPEN_PRODUCT_TAG_POPIN,this.showProductTagPopin,this),Backbone.Mediator.unsubscribe(WidgetEvent.OPEN_SPOTLIGHT_POPIN,this.showSpotlightPopin,this),Backbone.Mediator.unsubscribe(WidgetEvent.OPEN_POPUP_FRAME,this.showPopupFrame,this),Backbone.Mediator.unsubscribe(WidgetEvent.POPIN_CLOSE,this.hidePopin,this),Backbone.Mediator.unsubscribe(WidgetEvent.CLOSE_PRODUCT_TAG_POPIN,this.hideProductTagPopin,this),Backbone.Mediator.unsubscribe(WidgetEvent.CLOSE_SPOTLIGHT_POPIN,this.hideSpotlightPopin,this),Backbone.Mediator.unsubscribe(WidgetEvent.CLOSE_POPUP_FRAME,this.hidePopupFrame,this),Backbone.Mediator.unsubscribe(WidgetEvent.POPIN_RESIZE,this.resizePopin,this),Backbone.Mediator.unsubscribe(ShelfEvents.SHELF_OPENED,this.closePopin,this),FSWidgetModel.gi().destroy(),FSWidgetModel._instance=null,Backbone.View.prototype.remove.apply(this,arguments)}}),LayoutManager=Backbone.View.extend({events:function(){var e={};return FSUtils.isIOS()?{touchend:"onMouseMoveClick",mousemove:"onMouseMoveClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"}:(FSUtils.isMobileDevice()&&(e={touchstart:"handleStopAutoHide",touchend:"handleStartAutoHide"}),$.extend({click:"onMouseMoveClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousemove:"onMouseMoveClick"},e))},template:_.template(Templates.mainLayout),templatePlayer:_.template(Templates.playerLayout),initialize:function(){var e=FSUtils.isMobileDevice()?"touchend":"click",t=this;this.isFormOpen=!1,this.isPopinOpen=!1,this.stopAutoHide=!1,this.initialClick=!1,this.buyCurtainTimeout=null,this.logoSize={width:0,height:0,bottom:0,right:0},FSUtils.isPlayerSkin()&&!FSWidgetModel.gi().get("isApp")?this.setElement(this.templatePlayer()):this.setElement(this.template()),this.$mainView=this.$el.find(ComponentContainers.MAIN_VIEW),this.collectionViewContainer=this.$el.find(ComponentContainers.COLLECTION_VIEW),this.menuContainer=this.$el.find(ComponentContainers.MENU),this.playerMenuContainer=this.$el.find(ComponentContainers.BOTTOM_BAR),this.navSlider=this.$el.find(ComponentContainers.NAV_SLIDER),this.flipViewContainer=this.$el.find(ComponentContainers.FLIP_VIEW),this.genericElement=this.$el.find(ComponentContainers.CUSTOM_TOOLTIP),this.shelfView=this.$el.find(ComponentContainers.SHELF_VIEW),this.customTooltip=null,this.clickToRead=null,FSWidgetModel.gi().widgetSettings.get("showFullScreenButton")&&FSWidgetModel.gi().widgetSettings.get("skinType")!==WidgetSkinType.PLAYER&&(this.clickToRead=new ClickToReadButton({model:new Backbone.Model({label:FSWidgetModel.gi().get("labels").l_click_to_read})})),this.buyButton=null,this.$buyCurtainContainer=this.$el.find(ComponentContainers.BUY_CURTAIN),this.buyCurtain=null,this.accessibilityContainer=this.$el.find(ComponentContainers.ACCESSIBILITY_VIEW),this.accessibilityButton=null,this.accessibilityData=FSWidgetModel.gi().getAccessibilityData(),this.showBuyButtons=FSWidgetModel.gi().get("type")===CollectionType.PUBLISHED,this.listenTo(FSWidgetModel.gi().widgetSettings,"change:mergePdfs",this.render),this.listenTo(FSWidgetModel.gi().widgetSettings,"change:showControls",this.onChangeShowControls),this.listenTo(FSWidgetModel.gi().widgetSettings,"change:showFullScreenButton",this.handleFullScreenOptionChange),this.listenTo(FSWidgetModel.gi().widgetState,"change:displayType",this.handleFullScreen),this.listenTo(FSWidgetModel.gi().widgetState,"change:displayState",this.render),this.listenTo(this.model,"change",this.onchange),this.listenTo(FSWidgetModel.gi(),"change:sell",this.handleSellChange),Backbone.Mediator.sub(WidgetEvent.RENDER_LAYOUT,this.render,this),Backbone.Mediator.sub(WidgetEvent.LEAD_FORM_OPENED,this.handleFormOpened,this),Backbone.Mediator.sub(WidgetEvent.LEAD_FORM_CLOSED,this.handleFormClosed,this),Backbone.Mediator.sub(WidgetEvent.ITEM_CHANGED,this.hideClickToReadButton,this),Backbone.Mediator.sub(WidgetEvent.PAGE_TURN_START,this.handlePageTurnStart,this),Backbone.Mediator.sub(WidgetEvent.LEAD_FORM_INPUT_FOCUS,this.hideClickToReadButton,this),Backbone.Mediator.sub(WidgetEvent.LEAD_FORM_INPUT_KEYPRESS,this.hideClickToReadButton,this),Backbone.Mediator.sub(WidgetEvent.POPIN_OPEN,this.handlePopinOpen,this),Backbone.Mediator.sub(WidgetEvent.POPIN_CLOSE,this.handlePopinClose,this),Backbone.Mediator.sub(WidgetEvent.ZOOM_CHANGED,this.handleZoomChanged,this),Backbone.Mediator.sub(WidgetEvent.ZOOM_END,this.handleZoomChanged,this),Backbone.Mediator.sub(ShelfEvents.SHELF_OPENED,this.hideMainView,this),Backbone.Mediator.sub(ShelfEvents.SHELF_CLOSED,this.showMainView,this),Backbone.Mediator.sub(WidgetEvent.START_AUTOHIDE,this.handleStartAutoHide,this),Backbone.Mediator.sub(WidgetEvent.STOP_AUTOHIDE,this.handleStopAutoHide,this),Backbone.Mediator.sub(WidgetEvent.CUSTOM_VIEW_LOADED,this.initCustomTooltip,this),window.CustomTooltipView&&this.initCustomTooltip(),FSUtils.isMobileDevice()||this.$el.on("mouseup",(function(e){Backbone.Mediator.pub(e.type,e)})),this.$el.on(e,(function(e){$(e.target).hasClass("form-input")||t.handleWidgetClickOrTap(e)})),FSWidgetModel.gi().get("isForSelling")&&(Backbone.Mediator.sub(WidgetEvent.PREV_PAGE,this.handlePageChange,this),Backbone.Mediator.sub(WidgetEvent.NEXT_PAGE,this.handlePageChange,this),Backbone.Mediator.sub(WidgetEvent.PAGE_TURN_END,this.handlePageChange,this),FSUtils.isPlayerSkin()&&Backbone.Mediator.sub(WidgetEvent.CHANGE_PAGE,this.handlePageChange,this),this.handlePageChange())},onMouseEnter:function(){var e=FSWidgetModel.gi().widgetState.get("displayType");this.initialClick&&!FSWidgetModel.gi().widgetState.get("isBuyCurtainDisplayed")&&(e===DisplayType.LARGE?(this.showControllers(),this.autoHideControllers()):this.showControllers())},onMouseLeave:function(){this.initialClick&&this.hideControllers(),FSWidgetModel.gi().widgetSettings.get("skinType")!==WidgetSkinType.PLAYER&&MenuController.gi().closeAll()},onMouseMoveClick:function(e){Backbone.Mediator.pub(e.type,e),(FSUtils.isInFullScreen()&&!FSWidgetModel.gi().widgetState.get("isBuyCurtainDisplayed")||FSUtils.isPlayerSkin())&&(this.showControllers(),this.autoHideControllers()),FSUtils.isInFullScreen()||"mousemove"!==e.type&&!FSUtils.isIOS()||this.showClickToReadButton()},onchange:function(){this.render(),this.model.changed&&(this.model.changed.width||this.model.changed.height||this.model.changed.logo)&&Backbone.Mediator.pub(WidgetEvent.RESIZE)},render:function(){var e,t,i=this.model.get("width"),n=FSWidgetModel.gi().get("collectionData").watermark?WidgetWatermarkBar.WATERMARK_BAR_HEIGHT:0,s=FSUtils.isPlayerSkin()?LayoutManager.FLIPVIEW_BOTTOM_MARGIN+n:n,o=this.model.get("height")-s,a=0,r=0,l=2*LayoutManager.COLLECTION_VIEW_VERTICAL_MARGIN,c=0,d=0;return this.logoSize=this.model.get("logo")||this.logoSize,this.$el.css({position:"relative",width:i+"px",height:o+"px"}),FSWidgetModel.gi().widgetState.get("displayState")===DisplayState.NORMAL||FSWidgetModel.gi().get("forceWidget")&&FSWidgetModel.gi().widgetState.get("displayState")!==DisplayState.FULLSCREEN?(this.collectionViewContainer.hide(),this.flipViewContainer.css({left:"15px",top:this.getFlipTopBottom(),right:"15px",bottom:this.getFlipTopBottom()}),FSWidgetModel.gi().widgetState.set({displayType:DisplayType.SMALL})):(e=FSWidgetModel.gi().checkCollectionViewVisibility(),t=o-l-this.logoSize.height-this.logoSize.bottom,e?(a=LayoutManager.COLLECTION_VIEW_WIDTH+LayoutManager.MARGIN,r=this.logoSize.height>0?t:o-l,this.collectionViewContainer.css({display:"block",height:r+"px"})):this.collectionViewContainer.hide(),FSWidgetModel.gi().set("mainContentWidth",this.logoSize.width>0?i-2*LayoutManager.MARGIN-this.logoSize.width-this.logoSize.right:i-a-2*LayoutManager.MARGIN),FSWidgetModel.gi().widgetSettings.get("showThumbViewer")&&this.navSlider.css({display:"block"}),c=50,d=2*NavSliderView.MARGIN+NavSliderView.HEIGHT-LayoutManager.MARGIN,this.flipViewContainer.css({left:LayoutManager.MARGIN+"px",top:FSUtils.isMobileDevice()?0:LayoutManager.MARGIN+c+"px",right:LayoutManager.MARGIN+a+"px",bottom:FSUtils.isMobileDevice()?0:LayoutManager.MARGIN+d+"px",display:"block"}),FSWidgetModel.gi().widgetState.set({displayType:DisplayType.LARGE})),!this.automatorView&&this.hasAccessToShowProducts()&&(this.automatorView=new AutomatorView({model:new Backbone.Model({})}),this.$mainView.append(this.automatorView.render().$el)),this.clickToRead&&(this.$el.append(this.clickToRead.render().$el),this.clickToRead.render().$el.after(this.$buyCurtainContainer)),FSWidgetModel.gi().get("isForSelling")&&(!this.buyButton&&this.showBuyButtons&&(this.buyButton=new BuyButton({model:new Backbone.Model({price:FSWidgetModel.gi().get("sell").price,buyLink:FSWidgetModel.gi().get("sell").buyLink,isInSubscription:FSWidgetModel.gi().get("isInSubscription"),subscriptionFlipbooks:FSWidgetModel.gi().get("sell").subscriptionFlipbooks,subscriptionPrice:FSWidgetModel.gi().get("sell").subscriptionPrice,singleFlipbook:FSWidgetModel.gi().get("labels").l_single_flipbook,issues:FSWidgetModel.gi().get("labels").l_issues,buySubscription:FSWidgetModel.gi().get("labels").l_subscription,buyLabel:FSWidgetModel.gi().get("labels").l_buy,accessibilityEnabled:!!FSWidgetModel.gi().get("collectionData").accessibility,hasAccessToCart:FSWidgetModel.gi().get("hasAccessToCart"),activeSubscription:!!FSWidgetModel.gi().get("sell").activeSubscription,rollingSubscriptionLink:FSWidgetModel.gi().get("sell").rollingSubscriptionLink,rollingSubscriptionLabel:FSWidgetModel.gi().get("labels").l_buy_subscription})}),this.$el.append(this.buyButton.render().$el)),this.buyCurtain||(this.buyCurtain=new BuyCurtain({model:new Backbone.Model({message:FSWidgetModel.gi().get("labels").l_cortina_message,title:FSWidgetModel.gi().flipCollection.get("title"),author:FSWidgetModel.gi().get("author"),userUrl:URLPaths.BASE+"/"+FSWidgetModel.gi().get("userProfile")+"/",price:FSWidgetModel.gi().get("sell").price,buyLink:FSWidgetModel.gi().get("sell").buyLink,isInSubscription:FSWidgetModel.gi().get("isInSubscription"),subscriptionFlipbooks:FSWidgetModel.gi().get("sell").subscriptionFlipbooks,subscriptionPrice:FSWidgetModel.gi().get("sell").subscriptionPrice,singleFlipbook:FSWidgetModel.gi().get("labels").l_single_flipbook,issues:FSWidgetModel.gi().get("labels").l_issues,buySubscription:FSWidgetModel.gi().get("labels").l_subscription,buyLabel:FSWidgetModel.gi().get("labels").l_buy,isPlayerSkin:FSUtils.isPlayerSkin(),showBuyButtons:this.showBuyButtons,rollingSubscriptionLink:FSWidgetModel.gi().get("sell").rollingSubscriptionLink,rollingSubscriptionLabel:FSWidgetModel.gi().get("labels").l_buy_subscription,activeSubscription:!!FSWidgetModel.gi().get("sell").activeSubscription})}),this.$buyCurtainContainer.append(this.buyCurtain.render().$el).show())),FSUtils.isMobileDevice()&&this.navSlider.find(".nav-slider-back").addClass("visible"),(!0===FSWidgetModel.gi().get("isApp")||FSUtils.isMobileDevice())&&this.navSlider.addClass("mobile-slider"),this.isFullScreenView()||this.showClickToReadButton(),!this.toc&&FSWidgetModel.gi().widgetSettings.get("enableToc")&&this.addToc(),FSWidgetModel.gi().get("isForSelling")&&FSUtils.isPlayerSkin()&&this.$buyCurtainContainer.css({height:this.isFullScreenView?$(window).height():this.model.get("height")}),!this.accessibilityButton&&this.accessibilityData&&(this.accessibilityButton=new AccessibilityButton({model:new Backbone.Model({open:!1})}),this.accessibilityPanel=new AccessibilityPanel({model:new Backbone.Model({data:this.accessibilityData})}),this.accessibilityContainer.append(this.accessibilityButton.render().$el),this.accessibilityContainer.append(this.accessibilityPanel.render().$el)),this},addToc:function(){var e=FSWidgetModel.gi().getTOCData();this.toc=new TableOfContent({model:new Backbone.Model(e)}),FSUtils.isPlayerSkin()?this.$el.find("#player-toc-container").append(this.toc.render().el):this.$el.find("#toc-container").append(this.toc.render().el)},getFlipTopBottom:function(){return FSWidgetModel.gi().canShowControls()?"46px":FSUtils.isMobileDevice()?"5px":"15px"},handleFullScreen:function(e){FSWidgetModel.gi().widgetState.get("displayType")===DisplayType.LARGE?this.autoHideControllers():(clearTimeout(this.controllersTimeout),this.controllersTimeout=null)},handleStopAutoHide:function(){FSWidgetModel.gi().widgetState.get("isBuyCurtainDisplayed")||(this.stopAutoHide=!0,this.showControllers())},handleStartAutoHide:function(){this.stopAutoHide=!1,(FSUtils.isInFullScreen()&&!FSWidgetModel.gi().widgetState.get("isBuyCurtainDisplayed")||FSUtils.isPlayerSkin())&&(this.showControllers(),this.autoHideControllers())},showClickToReadButton:function(){var e=FSWidgetModel.gi().widgetSettings.get("widgetType"),t=FSWidgetModel.gi().get("forceWidget");this.clickToRead&&(FSWidgetModel.gi().widgetState.get("isBuyCurtainDisplayed")||!FSWidgetModel.gi().widgetSettings.get("showFullScreenButton")||FSWidgetModel.gi().widgetState.get("displayType")!==DisplayType.SMALL||this.isFormOpen||this.isPopinOpen||e===WidgetType.SHELF&&!t?this.clickToRead.hide():this.clickToRead.show())},hideClickToReadButton:function(){this.clickToRead&&this.clickToRead.hide()},showMenuContainer:function(){FSUtils.isPlayerSkin()?this.playerMenuContainer.css({visibility:"",opacity:1}):this.menuContainer.css({visibility:"",opacity:1})},showNavSlider:function(){FSWidgetModel.gi().widgetSettings.get("showThumbView")&&this.navSlider.css({visibility:"",opacity:1})},hideControllers:function(){var e=this;FSUtils.isPlayerSkin()?this.playerMenuContainer.css({opacity:0}):(this.navSlider.css({opacity:0}),this.menuContainer.css({opacity:0}),this.hideClickToReadButton()),this.visibilityTimeOut=setTimeout((function(){FSUtils.isPlayerSkin()?e.playerMenuContainer.css({visibility:"hidden"}):(e.navSlider.css({visibility:"hidden"}),e.menuContainer.css({visibility:"hidden"}))}),300)},autoHideControllers:function(){var e=this;if(this.stopAutoHide)return!0;clearTimeout(this.controllersTimeout),this.controllersTimeout=null,this.controllersTimeout=setTimeout((function(){e.hideControllers(),Backbone.Mediator.pub(WidgetEvent.AUTOHIDE_CONTROLS)}),CLICKTOREAD_SHOW_INTERVAL)},showControllers:function(){clearTimeout(this.controllersTimeout),clearTimeout(this.visibilityTimeOut),this.controllersTimeout=null,this.visibilityTimeOut=null,this.showNavSlider(),this.showMenuContainer(),this.showClickToReadButton()},handlePageTurnStart:function(){this.hideClickToReadButton()},handleFormOpened:function(){this.isFormOpen=!0,this.hideClickToReadButton()},handleFormClosed:function(){this.isFormOpen=!1,this.showClickToReadButton()},handlePopinOpen:function(){this.isPopinOpen=!0,this.hideClickToReadButton()},handlePopinClose:function(){this.isPopinOpen=!1,this.showClickToReadButton()},handleWidgetClickOrTap:function(e){this.initialClick=!0,Backbone.Mediator.pub(WidgetEvent.WIDGET_CLICK_OR_TAP,e)},handleZoomChanged:function(){FSWidgetModel.gi().get("currentZoom")>0?this.$mainView.addClass("zoomed"):this.$mainView.removeClass("zoomed")},initCustomTooltip:function(){this.customTooltip||(this.customTooltip=new CustomTooltipView,this.genericElement.append(this.customTooltip.render().$el))},onChangeShowControls:function(){this.render(),this.showControllers()},remove:function(){this.$el.off(),clearTimeout(this.controllersTimeout),this.controllersTimeout=null,clearTimeout(this.buyCurtainTimeout),this.buyCurtainTimeout=null,this.clickToRead&&(this.clickToRead.remove(),this.clickToRead=null),this.customTooltip&&(this.customTooltip.remove(),this.customTooltip=null),Backbone.Mediator.unsubscribe(WidgetEvent.RENDER_LAYOUT,this.render,this),Backbone.Mediator.unsubscribe(WidgetEvent.LEAD_FORM_OPENED,this.handleFormOpened,this),Backbone.Mediator.unsubscribe(WidgetEvent.LEAD_FORM_CLOSED,this.handleFormClosed,this),Backbone.Mediator.unsubscribe(WidgetEvent.ITEM_CHANGED,this.hideClickToReadButton,this),Backbone.Mediator.unsubscribe(WidgetEvent.PAGE_TURN_START,this.hideClickToReadButton,this),Backbone.Mediator.unsubscribe(WidgetEvent.LEAD_FORM_INPUT_FOCUS,this.hideClickToReadButton,this),Backbone.Mediator.unsubscribe(WidgetEvent.LEAD_FORM_INPUT_KEYPRESS,this.hideClickToReadButton,this),Backbone.Mediator.unsubscribe(WidgetEvent.POPIN_OPEN,this.handlePopinOpen,this),Backbone.Mediator.unsubscribe(WidgetEvent.POPIN_CLOSE,this.handlePopinClose,this),Backbone.Mediator.unsubscribe(WidgetEvent.ZOOM_CHANGED,this.handleZoomChanged,this),Backbone.Mediator.unsubscribe(WidgetEvent.ZOOM_END,this.handleZoomChanged,this),Backbone.Mediator.unsubscribe(WidgetEvent.CUSTOM_VIEW_LOADED,this.initCustomTooltip,this),Backbone.Mediator.unsubscribe(ShelfEvents.SHELF_OPENED,this.hideMainView,this),Backbone.Mediator.unsubscribe(ShelfEvents.SHELF_CLOSED,this.showMainView,this),Backbone.View.prototype.remove.apply(this,arguments)},hideMainView:function(){this.$mainView.hide()},showMainView:function(){this.$mainView.show()},isFullScreenView:function(){return FSWidgetModel.gi().widgetState.get("displayType")===DisplayType.LARGE},handleSellChange:function(){var e,t,i,n;FSWidgetModel.gi().get("isForSelling")&&(this.buyButton&&(this.buyButton.model.set("price",FSWidgetModel.gi().get("sell").price),this.buyButton.model.set("isInSubscription",FSWidgetModel.gi().get("isInSubscription")),this.buyButton.model.set("subscriptionPrice",FSWidgetModel.gi().get("sell").subscriptionPrice),this.buyButton.model.set("subscriptionFlipbooks",FSWidgetModel.gi().get("sell").subscriptionFlipbooks)),this.buyCurtain&&(this.buyCurtain.model.set("price",FSWidgetModel.gi().get("sell").price),this.buyCurtain.model.set("isInSubscription",FSWidgetModel.gi().get("isInSubscription")),this.buyCurtain.model.set("subscriptionPrice",FSWidgetModel.gi().get("sell").subscriptionPrice),this.buyCurtain.model.set("subscriptionFlipbooks",FSWidgetModel.gi().get("sell").subscriptionFlipbooks),e=FSWidgetModel.gi().get("sell").previewPages,FSWidgetModel.gi().widgetSettings.get("arabicStyle")&&(n=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").length,e=e.map((function(e){return n-e+1}))),i=(t=FSWidgetModel.gi().widgetState.get("currentPageIndex")+1)+1,e.includes(t)||e.includes(i)?(this.hideBuyCurtain(),this.showBuyButtons&&this.buyButton.$el.show(),this.showControllers()):(this.showBuyCurtain(),this.showBuyButtons&&this.buyButton.$el.hide(),this.hideControllers())))},showBuyCurtain:function(){FSWidgetModel.gi().get("isForSelling")&&(this.$buyCurtainContainer.addClass("visible"),FSWidgetModel.gi().widgetState.set("isBuyCurtainDisplayed",!0),this.hideClickToReadButton())},hideBuyCurtain:function(){FSWidgetModel.gi().get("isForSelling")&&(this.$buyCurtainContainer.removeClass("visible"),FSWidgetModel.gi().widgetState.set("isBuyCurtainDisplayed",!1),this.showClickToReadButton())},handlePageChange:function(){var e=this;FSWidgetModel.gi().get("isForSelling")&&(clearTimeout(this.buyCurtainTimeout),this.buyCurtainTimeout=setTimeout((function(){e.delayBuyCurtainChange()}),PAGE_TURN_DURATION/5))},delayBuyCurtainChange:function(){this.shouldDisplayBuyCurtain()?(this.showBuyCurtain(),this.showBuyButtons&&this.buyButton.$el.hide(),this.hideControllers()):(this.hideBuyCurtain(),this.showBuyButtons&&this.buyButton.$el.show(),this.showControllers())},shouldDisplayBuyCurtain:function(){var e=FSWidgetModel.gi().widgetSettings.get("singlePageView"),t=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").length,i=FSWidgetModel.gi().widgetState.get("currentPageIndex"),n=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").at(i),s=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").at(i+1);return(0===i||i===t-1||e)&&n.get("isBlockedForSellingPreview")||!e&&i>0&&i<t-1&&(n.get("isBlockedForSellingPreview")||s&&s.get("isBlockedForSellingPreview"))},handleFullScreenOptionChange:function(){FSWidgetModel.gi().widgetSettings.get("showFullScreenButton")?this.showClickToReadButton():this.hideClickToReadButton()},hasAccessToShowProducts:function(){return!(!FSWidgetModel.gi().get("collectionData").features.WIDGET_SHOW_PRODUCTS||!0!==FSWidgetModel.gi().get("collectionData").features.WIDGET_SHOW_PRODUCTS)}});LayoutManager.MARGIN=15,LayoutManager.COLLECTION_VIEW_VERTICAL_MARGIN=40,LayoutManager.COLLECTION_VIEW_WIDTH=110,LayoutManager.FLIPVIEW_BOTTOM_MARGIN=78;var LeadFormView=Backbone.View.extend({template:_.template(Templates.leadForm),id:ComponentContainers.LEAD_FORM,events:{"click .submit-button":"submitForm"},initialize:function(){this.formIsOutside=null,this.formHasMandatoryFields=this.getFormHasMandatoryElements(),this.resizeTimeout=null,this.firstPageThumb="",this.newForm=this.isNewVersion(),this.setupDays(),this.setupMonths(),this.setupYears(),this.listenTo(this.model,"change:pageSize",this.resize),Backbone.Mediator.sub(WidgetEvent.COUNTRIES_LOADED,this.countriesLoaded,this),this.render()},render:function(){return this.$el.html(this.template(this.model.attributes)),this.mainContainer=this.$el.find(".form-main"),this.formContainer=this.$el.find(".form-container"),this.titleContainer=this.$el.find(".form-header"),this.contentContainer=this.$el.find(".form-content"),this.footerContainer=this.$el.find(".form-footer"),this.formHasMandatoryFields||this.footerContainer.find(".form-required").css("visibility","hidden"),this.newForm&&this.createNewFormTemplate(),this.createElements(),this.formPadding=parseInt(this.$el.css("padding-top"),10),this.$el.css("visibility","hidden"),this.model.get("pageContainer").append(this.$el),this.resize(),Backbone.Mediator.pub(WidgetEvent.LEAD_FORM_OPENED,this.model.attributes),this},createNewFormTemplate:function(){this.footerContainer.find(".form-required").css("display","none"),this.mainContainer.parent().addClass("new-form"),this.firstPageThumb="https:"+FSWidgetModel.gi().getFirstPageThumb(),this.coverImage=new Image,this.coverImage.src=this.firstPageThumb,$(this.coverImage).attr("width",200),$(this.coverImage).attr("height","auto"),$(this.coverImage).addClass("cover-img"),this.mainContainer.prepend(this.coverImage),this.scaleNewForm()},countriesLoaded:function(){var e=this.contentContainer.find("select[data-type=country]"),t=this;e.length>0&&_.each(e,(function(e){t.setDropdownOptions($(e),FSWidgetModel.gi().getCountryOptions())}))},resize:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout((function(){e.setFormSize()}),10),this.scaleNewForm()},setFormSize:function(){var e,t,i,n=this.model.get("pageSize"),s=n[0],o=n[1],a=FSWidgetModel.gi().get("height"),r=this.titleContainer.height()+parseInt(this.titleContainer.css("padding-bottom"),10)+this.contentContainer.height()+this.footerContainer.height(),l=this.contentContainer.width()+2*parseInt(this.$el.css("padding-left"),10);this.newForm?(this.$el.height("auto"),this.mainContainer.height("auto")):(this.formPadding||(this.formPadding=parseInt(this.$el.css("padding-top"),10)),t=s-2*LeadFormView.FORM_SHADOW-2*this.formPadding,i=o-2*LeadFormView.FORM_SHADOW-2*this.formPadding,t<l+20?(i=a-2*LeadFormView.FORM_SHADOW-2*this.formPadding,this.formIsOutside||(this.placeFormOverBook(),this.formIsOutside=!0)):(this.formIsOutside||"boolean"!=typeof this.formIsOutside)&&(this.placeFormInsidePage(),this.formIsOutside=!1),e=Math.min(i,r),this.$el.height(e),this.mainContainer.height(e)),this.$el.css("visibility","visible")},placeFormOverBook:function(){var e=this.model.get("widgetContainer").find("#docView")[0];this.newForm&&0===$(e).find(".form-bg-layer").length&&$(e).append('<div class="form-bg-layer"></div>'),this.model.get("widgetContainer").append(this.$el)},placeFormInsidePage:function(){this.model.get("pageContainer").append(this.$el)},createElements:function(){var e=this;_.each(this.model.get("elements"),(function(t,i){var n="string"==typeof t.type?parseInt(t.type,10):t.type,s=e.getElementCreator(n,i);s&&"function"==typeof s.getCreator&&s.getCreator.call(e,t)}))},getElementCreator:function(e,t){var i="f_"+t,n=[{type:LeadFormField.FIELD_TYPE_INPUT,getCreator:function(e){this.createLabel(i,e.name,e.mandatory),this.createTextInput(i,"text",e.mandatory),e.mandatory&&this.createErrorLabel(i,this.model.get("labels").fieldRequiredLabel)}},{type:LeadFormField.FIELD_TYPE_COUNTRY,getCreator:function(e){this.createLabel(i,e.name,e.mandatory),this.createDropdown(i,FSWidgetModel.gi().getCountryOptions(),"country",e.mandatory,{type:"country"}),e.mandatory&&this.createErrorLabel(i,this.model.get("labels").fieldRequiredLabel)}},{type:LeadFormField.FIELD_TYPE_CUSTOM_DROPDOWN,getCreator:function(e){this.createLabel(i,e.name,e.mandatory),this.createDropdown(i,e.ddvalues.split(","),"custom",e.mandatory,{type:"mandatory"}),e.mandatory&&this.createErrorLabel(i,this.model.get("labels").fieldRequiredLabel)}},{type:LeadFormField.FIELD_TYPE_MDY_DATE,getCreator:function(e){this.createLabel(i,e.name,e.mandatory),this.createDateField(i,e.type,e.mandatory),e.mandatory&&this.createErrorLabel(i,this.model.get("labels").fieldRequiredLabel)}},{type:LeadFormField.FIELD_TYPE_DMY_DATE,getCreator:function(e){this.createLabel(i,e.name,e.mandatory),this.createDateField(i,e.type,e.mandatory),e.mandatory&&this.createErrorLabel(i,this.model.get("labels").fieldRequiredLabel)}},{type:LeadFormField.FIELD_TYPE_CHECKBOX,getCreator:function(e){this.createCheckbox(i,e.name,e.mandatory),e.mandatory&&this.createErrorLabel(i,this.model.get("labels").fieldRequiredLabel,"cb")}},{type:LeadFormField.FIELD_TYPE_TEXTAREA,getCreator:function(e){this.createLabel(i,e.name,e.mandatory),this.createTextArea(i,e.lines,e.mandatory)}},{type:LeadFormField.FIELD_TYPE_EMAIL,getCreator:function(e){this.createLabel(i,e.name,e.mandatory),this.createTextInput(i,"email",e.mandatory),this.createErrorLabel(i,this.model.get("labels").validEmailLabel)}},{type:LeadFormField.FIELD_TYPE_BIRTHDATE_MDY,getCreator:function(e){this.createLabel(i,e.name,e.mandatory),this.createDateField(i,e.type,e.mandatory),e.mandatory&&this.createErrorLabel(i,this.model.get("labels").fieldRequiredLabel)}},{type:LeadFormField.FIELD_TYPE_BIRTHDATE_DMY,getCreator:function(e){this.createLabel(i,e.name,e.mandatory),this.createDateField(i,e.type,e.mandatory),e.mandatory&&this.createErrorLabel(i,this.model.get("labels").fieldRequiredLabel)}}];return _.find(n,(function(t){return t.type===e}))},createLabel:function(e,t,i,n){var s=_.template(Templates.leadFormLabel)({label:t,mandatory:i}),o=$(s).attr("data-index",e);this.newForm||("string"==typeof n&&n.length>0&&o.attr("for",n),this.contentContainer.append(o))},createErrorLabel:function(e,t,i){var n=_.template(Templates.leadFormError)({error:t}),s=$(n).attr("data-index",e).hide();"string"==typeof i&&i.length>0&&s.addClass(i),this.contentContainer.append(s)},disableFieldError:function(e){var t,i,n,s=$(e.currentTarget);s.hasClass("error")&&(t=s.attr("data-index"),i=s.siblings("[data-index="+t+"]"),n=s.siblings(".error-label[data-index="+t+"]"),s.removeClass("error"),i.removeClass(".error"),0===n.length&&(n=s.parent().find(".error-label[data-index="+t+"]")),n.hide())},handleInputFocus:function(e){Backbone.Mediator.pub(WidgetEvent.LEAD_FORM_INPUT_FOCUS),this.disableFieldError(e)},handleInputKeypress:function(){Backbone.Mediator.pub(WidgetEvent.LEAD_FORM_INPUT_KEYPRESS)},createTextInput:function(e,t,i){var n=_.template(Templates.leadFormInput)({type:t}),s=$(n).attr("data-index",e).attr("placeholder",this.model.get("placeholder"));this.newForm&&s.addClass("new-form-input"),i&&s.addClass("mandatory"),s.on("focus",$.proxy(this.handleInputFocus,this)),s.on("keypress",$.proxy(this.handleInputKeypress,this)),this.contentContainer.append(s)},createTextArea:function(e,t,i){var n=_.template(Templates.leadFormTextArea)(),s=$(n);t="number"==typeof t&&t>0?t:2,s.attr("rows",t),i&&s.addClass("mandatory"),s.on("focus",$.proxy(this.handleInputFocus,this)),s.on("keypress",$.proxy(this.handleInputKeypress,this)),this.contentContainer.append(s)},createDropdown:function(e,t,i,n,s,o){var a=_.template(Templates.leadFormDropDown)(),r=$(a),l=this;r.attr("data-index",e),"string"==typeof i&&i.length>0&&r.addClass(i),n&&r.addClass("mandatory"),s&&_.each(s,(function(e,t){r.attr("data-"+t,e)})),r.on("focus",$.proxy(this.handleInputFocus,this)),this.setDropdownOptions(r,t),this.contentContainer.append(r),"function"==typeof o&&r.on("change",(function(e){o.call(l,e)}))},setDropdownOptions:function(e,t){var i="";e.empty(),"string"==typeof t?t.length>0&&(i=t):i=t.map((function(e){return'<option value="'+e+'">'+e+"</option>"})).join(""),e.html(i)},createCheckbox:function(e,t,i){var n=_.template(Templates.leadFormCheckbox)({label:t,id:e}),s=$(n),o=s.find("input");s.attr("data-index",e),o.attr("data-index",e),i&&o.addClass("mandatory"),s.on("click",$.proxy(this.handleInputFocus,this)),this.contentContainer.append(s)},createDateField:function(e,t,i){t===LeadFormField.FIELD_TYPE_DMY_DATE||t===LeadFormField.FIELD_TYPE_BIRTHDATE_DMY?(this.createDropdown(e,this.days31Str,"day",i,{type:"day-"+e},null),this.createDropdown(e,this.monthsStr,"month",i,{type:"month-"+e},this.handleDateChanged)):(this.createDropdown(e,this.monthsStr,"month",i,{type:"month-"+e},this.handleDateChanged),this.createDropdown(e,this.days31Str,"day",i,{type:"day-"+e},null)),t===LeadFormField.FIELD_TYPE_BIRTHDATE_DMY||t===LeadFormField.FIELD_TYPE_BIRTHDATE_MDY?this.createDropdown(e,this.bdYearsStr,"year",i,{type:"year-"+e},this.handleDateChanged):this.createDropdown(e,this.yearsStr,"year",i,{type:"year-"+e},this.handleDateChanged)},setupYears:function(){var e=(new Date).getFullYear(),t=e+15,i=99,n=t-i,s=t;for(this.years=["----"];s>=n;s--)this.years.push(s);for(n=(t=e)-(i=149),this.bdYears=["----"],s=t;s>=n;s--)this.bdYears.push(s);this.yearsStr=this.getOptionList(this.years),this.bdYearsStr=this.getOptionList(this.bdYears)},setupMonths:function(){this.months=["--",1,2,3,4,5,6,7,8,9,10,11,12],this.month31=[0,1,3,5,7,8,10,12],this.monthsStr=this.getOptionList(this.months)},setupDays:function(){var e;for(this.days28=["--"],this.days29=["--"],this.days30=["--"],this.days31=["--"],e=1;e<=31;e++)e<=28&&this.days28.push(e),e<=29&&this.days29.push(e),e<=30&&this.days30.push(e),e<=31&&this.days31.push(e);this.days28Str=this.getOptionList(this.days28),this.days29Str=this.getOptionList(this.days29),this.days30Str=this.getOptionList(this.days30),this.days31Str=this.getOptionList(this.days31)},getOptionList:function(e){return e.map((function(e){return'<option value="'+e+'">'+e+"</option>"})).join("")},handleDateChanged:function(e){var t=$(e.currentTarget).attr("data-type").split("-")[1],i=this.$el.find("select[data-type=day-"+t+"]"),n=this.$el.find("select[data-type=month-"+t+"]"),s=this.$el.find("select[data-type=year-"+t+"]");this.setDate(i,n,s)},setDate:function(e,t,i){var n=t[0].selectedIndex,s="----"===i[0].value?0:parseInt(i[0].value,10),o=e[0].selectedIndex;2===n?s%4==0?(this.setDropdownOptions(e,this.days29Str),e[0].selectedIndex=o>29?29:o):(this.setDropdownOptions(e,this.days28Str),e[0].selectedIndex=o>28?28:o):this.month31.indexOf(n)>-1?(this.setDropdownOptions(e,this.days31Str),e[0].selectedIndex=o):(this.setDropdownOptions(e,this.days30Str),e[0].selectedIndex=o>30?30:o)},getFormHasMandatoryElements:function(){var e=this.model.get("elements");return!(!e||"function"!=typeof e.some)&&this.model.get("elements").some((function(e){return e.mandatory}))},checkMandatoryElements:function(){var e,t,i,n=this.contentContainer.find(".mandatory"),s=this,o=!0,a=[];return n.length>0&&(o=!0,a=[],n.each((function(){var e,t=!1;"checkbox"===this.type?t=this.checked:"string"==typeof this.value&&this.value.length>0&&("textarea"===this.type?t=!0:"email"===this.type?FSUtils.isEmailValid(this.value)&&(t=!0):this.value!==LeadFormView.TWO_DASH&&this.value!==LeadFormView.FOUR_DASH&&(t=!0)),t||(e=$(this).attr("data-index"),$(this).addClass("error"),"checkbox"===this.type&&$(this).parent().addClass("error"),this.newForm||s.contentContainer.find(".error-label[data-index="+e+"]").show(),o=!1,a.push($(this)))})),o||(e=this.formContainer.offset().top,t=a[0].offset().top,"checkbox"===n.first().attr("type")||this.newForm||(t=a[0].prev().offset().top),i=t-e+this.formContainer.scrollTop(),this.mainContainer.scrollTop(i)),!o)},haveInvalidEmails:function(){var e=this.contentContainer.find("input[type=email]"),t=!1,i=this;return e.length>0&&e.each((function(){var e;"string"==typeof this.value&&this.value.length>0&&!FSUtils.isEmailValid(this.value)&&(t=!0,e=$(this).attr("data-index"),$(this).addClass("error"),i.contentContainer.find(".error-label[data-index="+e+"]").show())})),t},getFormData:function(){var e=this,t={collectionHash:FSWidgetModel.gi().get("shelfData")&&FSWidgetModel.gi().get("shelfData").get("itemOpened")?FSWidgetModel.gi().get("shelfData").get("itemHash"):FSWidgetModel.gi().get("collectionHash"),Timestamp:(new Date).toISOString(),fields:[]};return t["Book title"]=this.model.get("bookTitle"),t["Page index"]=this.model.get("realPageNumber"),_.each(this.model.get("elements"),(function(i,n){var s=e.contentContainer.find(".form-input[data-index=f_"+n+"]");if(s.length>0)switch(i.type){case LeadFormField.FIELD_TYPE_CHECKBOX:t.fields.push({name:i.name,value:s.first()[0].checked});break;case LeadFormField.FIELD_TYPE_MDY_DATE:case LeadFormField.FIELD_TYPE_DMY_DATE:case LeadFormField.FIELD_TYPE_BIRTHDATE_MDY:case LeadFormField.FIELD_TYPE_BIRTHDATE_DMY:t.fields.push({name:i.name,value:s.eq(0)[0].value+"/"+s.eq(1)[0].value+"/"+s.eq(2)[0].value});break;default:t.fields.push({name:i.name,value:s[0].value})}})),t},submitForm:function(){this.checkMandatoryElements()||this.haveInvalidEmails()||(FlipSnackEmbed.isEditor||Backbone.Mediator.pub(WidgetEvent.SEND_LEAD_FORM,this.getFormData()),this.saveSubmitedInfo(),Backbone.Mediator.pub(WidgetEvent.LEAD_FORM_SENT,this.model.attributes))},saveSubmitedInfo:function(){var e;if(this.newForm){e=FSWidgetModel.gi().get("collectionHash");try{localStorage.setItem(e,1)}catch(e){}}},remove:function(){this.model.get("widgetContainer").find(".form-bg-layer").length>0&&this.model.get("widgetContainer").find(".form-bg-layer")[0].remove(),this.$el.remove(),Backbone.Mediator.unsubscribe(WidgetEvent.COUNTRIES_LOADED,this.countriesLoaded,this),Backbone.View.prototype.remove.apply(this)},close:function(){Backbone.Mediator.pub(WidgetEvent.LEAD_FORM_CLOSED,this.model.attributes),this.registerClickEvent(),this.remove()},registerClickEvent:function(){Backbone.Mediator.pub(StatsEvents.REGISTER,{eid:Stats.TYPE.CLICK_ELEMENT,pid:this.model.get("pid"),elid:this.model.get("eID")})},isNewVersion:function(){return this.model.get("formVersion")&&1===parseInt(this.model.get("formVersion"),10)},scaleNewForm:function(){var e=this.model.get("pageSize"),t=this.model.get("realPageNumber"),i=e[0],n=1,s=0,o=FSWidgetModel.gi().widgetState.get("currentItem").get("noOfPages"),a=FSWidgetModel.gi().widgetSettings.get("singlePageView"),r=this.model.get("pageIndex")+1;i<LeadFormView.NEW_FORM_WIDTH&&(s=LeadFormView.NEW_FORM_WIDTH-i,n=(100-parseInt(100*s/LeadFormView.NEW_FORM_WIDTH,10))/100),t%2!=0||r===o||1===r||a||this.placeFormOverBook(),this.$el.css("transform","translate(-50%, -50%) scale("+n+")")}});LeadFormView._instance=null,LeadFormView.gi=function(e){return!LeadFormView._instance&&e&&(LeadFormView._instance=new LeadFormView(e)),LeadFormView._instance},LeadFormView.hasInstance=function(){return void 0!==LeadFormView._instance&&null!==LeadFormView._instance},LeadFormView.close=function(){LeadFormView._instance&&(clearTimeout(LeadFormView._instance.resizeTimeout),LeadFormView._instance.close(),LeadFormView._instance=null,$("#leadForm").remove())},LeadFormView.FORM_SHADOW=8,LeadFormView.TWO_DASH="--",LeadFormView.FOUR_DASH="----",LeadFormView.NEW_FORM_WIDTH="509",function(e){window.NavSliderView=Backbone.View.extend({events:{mouseover:"handleMouseOver",mouseout:"handleMouseOut"},el:ComponentContainers.NAV_SLIDER,template:_.template(Templates.navSlider),initialize:function(){this.render(),this.hasTouch=FSUtils.hasTouch(),this.isMobile=FSUtils.isMobileDevice(),this.downEvent=this.hasTouch?"touchstart":"mousedown",this.moveEvent=this.hasTouch?"touchmove":"mousemove",this.endEvent=this.hasTouch?"touchend":"mouseup",this.direction="left",this.currentPoint=FSWidgetModel.gi().widgetState.get("currentPageIndex"),this.isSinglePageView=FSWidgetModel.gi().widgetSettings.get("singlePageView"),this.isArabicStyle=FSWidgetModel.gi().widgetSettings.get("arabicStyle"),this.$slider=this.$el.find(".nav-slider"),this.$components=this.$el.find(".nav-slider-components"),this.$knob=this.$el.find(".nav-slider-knob"),this.$tooltipContainer=this.$el.find(".nav-slider-tooltip-container"),this.$tooltip=this.$el.find(".nav-slider-tooltip"),this.$thumb=this.$el.find(".nav-slider-thumb"),this.computeVars(),this.previousX=this.positionX,this.leftThumb=new SimpleLoader({model:new SimpleLoaderModel({width:this.thumbWidth,height:NavSliderView.THUMB_HEIGHT,scaleMode:"scale"})}),this.rightThumb=new SimpleLoader({model:new SimpleLoaderModel({width:this.thumbWidth,height:NavSliderView.THUMB_HEIGHT,scaleMode:"scale"})}),this.$thumb.append(this.leftThumb.render().$el),this.$thumb.append(this.rightThumb.render().$el),this.$knob.on(this.downEvent,{self:this},this.onEventDown),this.$knob.on(this.endEvent,{self:this},this.onEventEnd),this.$knob.on("mouseenter",{self:this},this.onKnobMouseEnter),this.$knob.on("mouseleave",{self:this},this.onKnobMouseLeave),this.$slider.on(this.endEvent,{self:this},this.onSliderEvent),this.$slider.on(this.downEvent,{self:this},this.onSliderTap),Backbone.Mediator.sub(WidgetEvent.RESIZE,this.resize,this),Backbone.Mediator.sub(WidgetEvent.NEXT_PAGE,this.pageChanged,this),Backbone.Mediator.sub(WidgetEvent.PREV_PAGE,this.pageChanged,this),this.listenTo(FSWidgetModel.gi().widgetState,"change:currentItem",this.itemChanged),this.listenTo(FSWidgetModel.gi().widgetState,"change:currentPageIndex",this.pageChanged),this.listenTo(FSWidgetModel.gi().widgetSettings,"change:showControls",this.handleShowControls),this.pageChanged()},render:function(){return this.$el.html(this.template()),this.handleShowControls(),this},resize:function(){this.computeVars(),this.pageChanged(),this.handleShowControls()},computeVars:function(){var e;this.totalPages=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").length,e=this.$slider[0].getBoundingClientRect(),this.positionX=e.left,this.totalPoints=this.isSinglePageView?Math.max(this.totalPages-1,1):this.totalPages/2,this.distanceBetweenPoints=e.width/this.totalPoints,this.firstPage=FSWidgetModel.gi().getFirstPage(),this.firstPageWidth=this.firstPage.get("width"),this.firstPageHeight=this.firstPage.get("height"),this.thumbWidth=Math.ceil(this.firstPageWidth*(NavSliderView.THUMB_HEIGHT/this.firstPageHeight))},handleShowControls:function(){FSWidgetModel.gi().canShowControls()?this.$el.addClass("show-controls"):this.$el.removeClass("show-controls"),this.isMobile||this.hasTouch?this.$el.addClass("touch-enabled"):this.$el.removeClass("touch-enabled")},onEventDown:function(e){var t=e.data.self,i=t.isMobile||t.hasTouch?e.originalEvent.changedTouches[0].pageX:e.pageX;$(window).on(t.moveEvent,{self:t},t.onMoveEvent),$(window).on(t.endEvent,{self:t},t.onEventEnd),t.previousX=i-t.positionX,t.isMobile&&(t.showThumbnail(),t.$knob.css({transition:"transform .3s",transform:"scale(1.3)"}))},onEventEnd:function(e){var t=e.data.self;$(window).off(t.moveEvent,t.onMoveEvent),$(window).off(t.endEvent,t.onEventEnd),t.moveKnob(t.currentPoint*t.distanceBetweenPoints),t.dispatchPageChange(),t.isMobile&&(t.hideThumbnail(),t.$knob.css({transition:"transform .3s",transform:"scale(1)"}))},onMoveEvent:function(e){var t=e.data.self,i=(t.isMobile||t.hasTouch?e.originalEvent.changedTouches[0].pageX:e.pageX)-t.positionX,n=i-t.currentPoint*t.distanceBetweenPoints;t.direction=i-t.previousX>0?"right":"left",t.previousX=i,"right"===t.direction?n>t.distanceBetweenPoints*NavSliderView.DRAG_DELTA?t.gotoNextPoint():n>0&&t.moveKnob(i):"left"===t.direction&&(n<t.distanceBetweenPoints*-NavSliderView.DRAG_DELTA?t.gotoPreviousPoint():n<0&&t.moveKnob(i))},onSliderEvent:function(e){var t=e.data.self,i=(t.isMobile||t.hasTouch?e.originalEvent.changedTouches[0].pageX:e.pageX)-t.positionX,n=Math.round(i/t.distanceBetweenPoints),s=n*t.distanceBetweenPoints;t.currentPoint=n,t.moveKnob(s),t.dispatchPageChange()},onSliderTap:function(e){var t=e.data.self;t.isMobile&&t.hideThumbnail()},onKnobMouseEnter:function(e){e.data.self.showTooltip()},onKnobMouseLeave:function(e){e.data.self.hideTooltip()},showTooltip:function(){this.$tooltipContainer.addClass("visible")},hideTooltip:function(){this.$tooltipContainer.removeClass("visible")},showThumbViewChanged:function(e){e.changed.showThumbView?this.$el.show():this.$el.hide()},pageChanged:function(){var e=FSWidgetModel.gi().widgetState.get("currentPageIndex"),t=this.isSinglePageView?e:Math.floor((e+1)/2),i=t*this.distanceBetweenPoints;this.moveKnob(i),this.setTooltipText(),this.currentPoint=t,this.loadThumbnail()},itemChanged:function(){var e;FSWidgetModel.gi().widgetState.get("currentPageIndex");this.currentPoint=FSWidgetModel.gi().widgetState.get("currentPageIndex"),this.computeVars(),e=this.currentPoint*this.distanceBetweenPoints,this.leftThumb.model.set({width:this.thumbWidth}),this.rightThumb.model.set({width:this.thumbWidth}),this.moveKnob(e),this.setTooltipText(),this.loadThumbnail()},setTooltipText:function(e){var t,i,n,s=this.isSinglePageView?this.currentPoint:2*this.currentPoint-1,o=e?s:FSWidgetModel.gi().widgetState.get("leftPageIndex"),a=this.isArabicStyle?this.totalPages-o-1:o+1;this.isArabicStyle&&this.isSinglePageView&&a++,t=a+1,a=0===a?"":a+"",t=this.isSinglePageView||t>this.totalPages?"":t+"",this.isArabicStyle&&(n=t,t=a,a=n),i=a.length&&t.length?a+"-"+t:a+t,this.$tooltip.text(i)},gotoNextPoint:function(){this.currentPoint++,this.currentPoint<=this.totalPoints&&(this.moveKnob(this.currentPoint*this.distanceBetweenPoints),this.setTooltipText(!0),this.loadThumbnail(!0))},gotoPreviousPoint:function(){this.currentPoint--,this.currentPoint>=0&&(this.moveKnob(this.currentPoint*this.distanceBetweenPoints),this.setTooltipText(!0),this.loadThumbnail(!0))},moveKnob:function(e){var t=Math.min(Math.max(0,e),this.$slider.width());this.$components.css({left:this.positionX+(t-NavSliderView.HEIGHT/2)+"px"})},dispatchPageChange:function(){var e=this.isSinglePageView?this.currentPoint:2*this.currentPoint-1,t=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").length-1,i=e;e<0?i=Math.max(e,0):e>t&&(i=Math.min(e,t)),Backbone.Mediator.pub(WidgetEvent.CHANGE_PAGE,i)},loadThumbnail:function(e){var t=this.isSinglePageView?this.currentPoint:Math.max(2*this.currentPoint-1,0),i=e?t:FSWidgetModel.gi().widgetState.get("currentPageIndex"),n=0===i,s=i===this.totalPages-1,o=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").models;this.isSinglePageView||n||s?(this.$thumb.width(this.thumbWidth),this.rightThumb.$el.hide(),this.leftThumb.model.set("source",o[i].get("thumb"))):(this.$thumb.width(2*this.thumbWidth),this.leftThumb.model.set("source",o[i].get("thumb")),this.rightThumb.$el.show(),this.rightThumb.model.set("source",o[i+1].get("thumb")))},hideThumbnail:function(){this.hideTooltip(),this.$thumb.hide(),this.$tooltip.hide()},showThumbnail:function(){this.showTooltip(),this.$thumb.show(),this.$tooltip.show()},handleMouseOver:function(){Backbone.Mediator.pub(WidgetEvent.STOP_AUTOHIDE)},handleMouseOut:function(){Backbone.Mediator.pub(WidgetEvent.START_AUTOHIDE)},remove:function(){Backbone.Mediator.unsubscribe(WidgetEvent.RESIZE,this.resize,this),Backbone.Mediator.unsubscribe(WidgetEvent.NEXT_PAGE,this.pageChanged,this),Backbone.Mediator.unsubscribe(WidgetEvent.PREV_PAGE,this.pageChanged,this),this.$knob.off(),this.$slider.off(),this.$slider=null,this.$knob=null,this.$components=null,this.$tooltipContainer=null,this.$tooltip=null,this.$thumb=null,Backbone.View.prototype.remove.apply(this,arguments)}}),NavSliderView.HEIGHT=22,NavSliderView.MARGIN=25,NavSliderView.DRAG_DELTA=.9,NavSliderView.THUMB_HEIGHT=96,NavSliderView._instance=null,NavSliderView.gi=function(){return NavSliderView._instance||(NavSliderView._instance=new NavSliderView),NavSliderView._instance},Backbone.Mediator.sub(WidgetEvent.CONFIG_DONE,(function(){FSWidgetModel.gi().widgetSettings.get("skinType")===WidgetSkinType.CLASSIC&&(FSWidgetModel.gi().get("shelfData")&&FSWidgetModel.gi().get("shelfData").get("shelfOpened")||FSWidgetModel.gi().widgetState.get("currentItem").get("pages").length<=2||(FSWidgetModel.gi().widgetSettings.get("showThumbView")&&NavSliderView.gi(),FlipSnackEmbed.isEditor&&NavSliderView.gi().listenTo(FSWidgetModel.gi().widgetSettings,"change:showThumbView",NavSliderView.gi().showThumbViewChanged)))}),this),Backbone.Mediator.sub(WidgetEvent.DESTROY,(function(){NavSliderView._instance&&(NavSliderView.gi().remove(),NavSliderView._instance=null)}),this)}();var PasswordOverlay=Backbone.View.extend({className:"password-overlay",initialize:function(){this.render()},render:function(){return this}}),PasswordPopinView=Backbone.View.extend({template:_.template(Templates.passwordPopinTemplate),className:"password-popin",events:{"click #submit":"onSubmit","keydown #password":"onKeyPress"},initialize:function(){FSWidgetModel.gi().set("passwordPopinVisible",!0),this.labelChange(),Backbone.Mediator.sub(WidgetEvent.CHANGE_LANGUAGE,this.setTextDirection,this)},labelChange:function(){var e={title:FSWidgetModel.gi().get("isWhiteLabel")?FSWidgetModel.gi().get("labels").l_password_text_whitelabel:FSWidgetModel.gi().get("labels").l_password_text,passwordLabel:FSWidgetModel.gi().get("labels").l_password,wrongPasswordLabel:FSWidgetModel.gi().get("labels").l_incorrect_password,submitButtonLabel:FSWidgetModel.gi().get("labels").l_enter};this.model.set(e)},render:function(){return this.$el.html(this.template(this.model.attributes)),this.setTextDirection(),this},onKeyPress:function(e){13===e.which&&this.onSubmit(),e.stopImmediatePropagation()},onSubmit:function(){var e=this.$el.find("#password").val();FSUtils.isCorrectPassword(e)?(Backbone.Mediator.pub(WidgetEvent.PASSWORD_POPIN_CLOSE),Backbone.Mediator.pub(WidgetEvent.WIDGET_VIEW_INIT,{password:e}),FSWidgetModel.gi().get("collectionData").security=""):this.$el.find("#error").removeClass("hidden")},setTextDirection:function(){FSWidgetModel.gi().get("textDirection")===TextDirection.RIGHT_TO_LEFT?(this.$el.find("#submit").addClass("reverse-text"),this.$el.find(".title").addClass("reverse-text"),this.$el.find("label").addClass("reverse-text"),this.$el.find("#error").addClass("reverse-text")):(this.$el.find("#submit").removeClass("reverse-text"),this.$el.find(".title").removeClass("reverse-text"),this.$el.find("label").removeClass("reverse-text"),this.$el.find("#error").removeClass("reverse-text"))},remove:function(){Backbone.Mediator.unsubscribe(WidgetEvent.CHANGE_LANGUAGE,this.setTextDirection,this),Backbone.View.prototype.remove.apply(this,arguments)}}),PdfLinkView=Backbone.View.extend({template:_.template(Templates.pdfLinkTemplate),className:"pdf-link",events:{click:"onLinkClick"},initialize:function(){this.isInternalLink=!this.model.has("url"),this.listenTo(FSWidgetModel.gi().widgetSettings,"change:useHighlights",this.updateHighlights),this.isInternalLink&&this.model.set("url","#"),this.delegateEvents()},resize:function(e){var t=this.model.get("bb"),i={left:t[0]*e+"px",top:t[1]*e+"px",width:t[2]*e+"px",height:t[3]*e+"px"};this.$el.css(i)},updateHighlights:function(){this.highLight=FSWidgetModel.gi().widgetSettings.get("useHighlights"),this.highLight?this.$el.hasClass("highlight")||this.$el.addClass("highlight"):this.$el.removeClass("highlight")},render:function(){return this.$el.html(this.template(this.model.attributes)),this.updateHighlights(),this.resize(this.model.get("scale")),this},onLinkClick:function(){var e;return this.registerClickEvent(),!this.isInternalLink||(e=FSWidgetModel.gi().widgetSettings.get("arabicStyle")?FSWidgetModel.gi().widgetState.get("currentItem").get("pages").length-this.getLinkPage()-1:this.getLinkPage(),Backbone.Mediator.pub(WidgetEvent.CHANGE_PAGE,e),!1)},getLinkPage:function(){var e;return e=void 0!==this.model.get("page")?parseInt(this.model.get("page"),10)-1:this.model.get("pageIndex")-1,Math.max(e,0)},registerClickEvent:function(){var e=this.model.get("pageIndex");FSWidgetModel.gi().widgetSettings.get("singlePageView")&&(e=FSWidgetModel.gi().widgetSettings.get("arabicStyle")?(e-1)/2:e/2+1),Backbone.Mediator.pub(StatsEvents.REGISTER,{eid:Stats.TYPE.CLICK_LINK,pid:FSWidgetModel.gi().widgetState.get("currentItem").get("pages").at(e).get("pID"),elid:this.model.get("linkIndex")})}}),PlayerNavSliderView=Backbone.View.extend({events:{mouseover:"handleMouseOver",mouseout:"handleMouseOut"},el:ComponentContainers.PLAYER_NAV_SLIDER,template:_.template(Templates.playerNavSlider),initialize:function(){this.render(),this.computeVars(),Backbone.Mediator.sub(WidgetEvent.RESIZE,this.resize,this),Backbone.Mediator.sub(WidgetEvent.NEXT_PAGE,this.pageChanged,this),Backbone.Mediator.sub(WidgetEvent.PREV_PAGE,this.pageChanged,this),this.listenTo(FSWidgetModel.gi().widgetState,"change:currentItem",this.itemChanged),this.listenTo(FSWidgetModel.gi().widgetState,"change:currentPageIndex",this.pageChanged),this.pageChanged()},render:function(){return this.$el.html(this.template()),this.setup(),this},setup:function(){this.hasTouch=FSUtils.hasTouch(),this.isMobile=FSUtils.isMobileDevice(),this.downEvent=this.hasTouch?"touchstart":"mousedown",this.moveEvent=this.hasTouch?"touchmove":"mousemove",this.endEvent=this.hasTouch?"touchend":"mouseup",this.direction="left",this.isDragging=!1,this.currentPoint=FSWidgetModel.gi().widgetState.get("currentPageIndex"),this.isSinglePageView=FSWidgetModel.gi().widgetSettings.get("singlePageView"),this.isArabicStyle=FSWidgetModel.gi().widgetSettings.get("arabicStyle"),this.$slider=this.$el.find(".nav-slider"),this.$components=this.$el.find(".nav-slider-components"),this.$knob=this.$el.find(".nav-slider-knob"),this.$tooltipContainer=this.$el.find(".nav-slider-tooltip-container"),this.$tooltip=this.$el.find(".nav-slider-tooltip"),this.$thumb=this.$el.find(".nav-slider-thumb"),this.$sliderProgress=this.$el.find(".nav-slider-progress"),this.computeVars(),this.previousX=this.positionX,this.leftThumb=new SimpleLoader({model:new SimpleLoaderModel({width:this.thumbWidth,height:PlayerNavSliderView.THUMB_HEIGHT,scaleMode:"stretch"})}),this.rightThumb=new SimpleLoader({model:new SimpleLoaderModel({width:this.thumbWidth,height:PlayerNavSliderView.THUMB_HEIGHT,scaleMode:"stretch"})}),this.$thumb.append(this.leftThumb.render().$el),this.$thumb.append(this.rightThumb.render().$el),this.$knob.on(this.downEvent,{self:this},this.onEventDown),this.$knob.on(this.endEvent,{self:this},this.onEventEnd),this.$knob.on("mouseenter",{self:this},this.onKnobMouseEnter),this.$knob.on("mouseleave",{self:this},this.onKnobMouseLeave),this.$slider.on(this.endEvent,{self:this},this.onSliderEvent),this.$slider.on(this.downEvent,{self:this},this.onSliderTap),$(ComponentContainers.MAIN_LAYOUT).on("mouseup",{self:this},this.hideThumbOnMouseUp),this.pageChanged()},resize:function(){this.computeVars(),this.pageChanged()},computeVars:function(){var e=$(ComponentContainers.MAIN_LAYOUT);this.sliderWidth=e.width()-2*PlayerNavSliderView.MARGIN,this.positionX=PlayerNavSliderView.MARGIN,this.totalPages=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").length,this.totalPoints=this.isSinglePageView?Math.max(this.totalPages-1,1):this.totalPages/2,this.distanceBetweenPoints=this.sliderWidth/this.totalPoints,this.firstPage=FSWidgetModel.gi().getFirstPage(),this.firstPageWidth=this.firstPage.get("width"),this.firstPageHeight=this.firstPage.get("height"),this.thumbWidth=Math.ceil(this.firstPageWidth*(PlayerNavSliderView.THUMB_HEIGHT/this.firstPageHeight))},onEventDown:function(e){var t=e.data.self;t.isDragging=!0;var i=t.isMobile?e.originalEvent.changedTouches[0].pageX:e.pageX;$(window).on(t.moveEvent,{self:t},t.onMoveEvent),$(window).on(t.endEvent,{self:t},t.onEventEnd),t.previousX=i-t.positionX,t.showThumbnail(),t.isMobile&&t.$knob.addClass("scaled")},onEventEnd:function(e){var t=e.data.self;t.isDragging=!1,$(window).off(t.moveEvent,t.onMoveEvent),$(window).off(t.endEvent,t.onEventEnd),t.moveKnob(t.currentPoint*t.distanceBetweenPoints),t.dispatchPageChange(),t.isMobile&&(t.hideThumbnail(),t.$knob.removeClass("scaled"))},onMoveEvent:function(e){var t=e.data.self,i=(t.isMobile?e.originalEvent.changedTouches[0].pageX:e.pageX)-t.positionX,n=Math.round(i/t.distanceBetweenPoints);n<=t.totalPoints&&n>=0&&(t.direction=i-t.previousX>0?"right":"left",t.previousX=i,t.currentPoint=Math.round(i/t.distanceBetweenPoints),t.loadThumbnail(!0),t.setTooltipText(!0),t.moveKnob(i))},onSliderEvent:function(e){var t=e.data.self;t.computeVars();var i=(t.isMobile?e.originalEvent.changedTouches[0].pageX:e.pageX)-t.positionX,n=Math.round(i/t.distanceBetweenPoints),s=n*t.distanceBetweenPoints;t.currentPoint=n,t.moveKnob(s),t.dispatchPageChange()},onSliderTap:function(e){var t=e.data.self;t.isMobile&&t.hideThumbnail()},onKnobMouseEnter:function(e){var t=e.data.self;t.arrangeThumb(),t.loadThumbnail(!0),t.setTooltipText(!0),t.showTooltip()},onKnobMouseLeave:function(e){var t=e.data.self;t.isDragging||t.hideTooltip()},showTooltip:function(){this.$tooltipContainer.addClass("visible")},hideTooltip:function(){this.$tooltipContainer.removeClass("visible")},showThumbViewChanged:function(e){e.changed.showThumbView?this.$el.show():this.$el.hide()},pageChanged:function(){var e=FSWidgetModel.gi().widgetState.get("currentPageIndex"),t=this.isSinglePageView?e:Math.floor((e+1)/2),i=t*this.distanceBetweenPoints;this.moveKnob(i),this.setTooltipText(),this.currentPoint=t},itemChanged:function(){var e;this.currentPoint=FSWidgetModel.gi().widgetState.get("currentPageIndex"),this.computeVars(),e=this.currentPoint*this.distanceBetweenPoints,this.leftThumb.model.set({width:this.thumbWidth}),this.rightThumb.model.set({width:this.thumbWidth}),this.moveKnob(e),this.setTooltipText(),this.loadThumbnail()},setTooltipText:function(e){var t,i,n,s=this.isSinglePageView?this.currentPoint:2*this.currentPoint-1,o=e?s:FSWidgetModel.gi().widgetState.get("leftPageIndex"),a=this.isArabicStyle?this.totalPages-o-1:o+1;this.isArabicStyle&&this.isSinglePageView&&a++,t=a+1,a=0===a?"":a+"",t=this.isSinglePageView||t>this.totalPages?"":t+"",this.isArabicStyle&&(n=t,t=a,a=n),i=a.length&&t.length?a+"-"+t:a+t,this.$tooltip.text(i)},moveKnob:function(e){var t=Math.min(Math.max(0,e),this.sliderWidth);this.arrangeThumb(),this.$components.css({left:this.positionX+(t-PlayerNavSliderView.HEIGHT/2)+"px"}),this.isArabicStyle?this.$sliderProgress.css({left:this.positionX+(t-PlayerNavSliderView.HEIGHT/2)+"px",width:this.sliderWidth-(this.positionX+(t-PlayerNavSliderView.HEIGHT/2))+"px"}):this.$sliderProgress.css("width",this.positionX+(t-PlayerNavSliderView.HEIGHT/2)+"px")},arrangeThumb:function(){var e=this.$components.position(),t=this.isSinglePageView||this.currentPoint<1||this.currentPoint===this.totalPoints?this.thumbWidth:2*this.thumbWidth,i=-t/2;e.left<t/2?i=-e.left:e.left>this.$slider.width()-t/2&&(i=-(t-(this.$slider.width()-e.left))),this.$thumb.css("transform","translateX("+i+"px)")},dispatchPageChange:function(){var e=this.isSinglePageView?this.currentPoint:2*this.currentPoint-1,t=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").length-1,i=e;e<0?i=Math.max(e,0):e>t&&(i=Math.min(e,t)),Backbone.Mediator.pub(WidgetEvent.CHANGE_PAGE,i)},loadThumbnail:function(e){var t=this.isSinglePageView?this.currentPoint:Math.max(2*this.currentPoint-1,0),i=e?t:FSWidgetModel.gi().widgetState.get("currentPageIndex"),n=0===i,s=i===this.totalPages-1,o=FSWidgetModel.gi().widgetState.get("currentItem").get("pages").models;this.isSinglePageView||n||s?(this.$thumb.width(this.thumbWidth),this.rightThumb.$el.hide(),this.leftThumb.model.set("source",o[i].get("thumb"))):(this.$thumb.width(2*this.thumbWidth),this.leftThumb.model.set("source",o[i].get("thumb")),this.rightThumb.$el.show(),this.rightThumb.model.set("source",o[i+1].get("thumb")))},hideThumbnail:function(){this.hideTooltip(),this.$thumb.hide(),this.$tooltip.hide()},showThumbnail:function(){this.showTooltip(),this.$thumb.show(),this.$tooltip.show()},hideThumbOnMouseUp:function(e){e.data.self.hideTooltip()},remove:function(){Backbone.Mediator.unsubscribe(WidgetEvent.RESIZE,this.resize,this),Backbone.Mediator.unsubscribe(WidgetEvent.NEXT_PAGE,this.pageChanged,this),Backbone.Mediator.unsubscribe(WidgetEvent.PREV_PAGE,this.pageChanged,this),this.$knob&&this.$knob.off(),this.$slider&&this.$slider.off(),this.$slider=null,this.$knob=null,this.$components=null,this.$tooltipContainer=null,this.$tooltip=null,this.$thumb=null,Backbone.View.prototype.remove.apply(this,arguments)}});function createNavSliderView(){FSWidgetModel.gi().widgetSettings.get("skinType")===WidgetSkinType.PLAYER&&(FSWidgetModel.gi().get("shelfData")&&FSWidgetModel.gi().get("shelfData").get("shelfOpened")||FSWidgetModel.gi().widgetState.get("currentItem").get("pages").length<=2||(FSWidgetModel.gi().widgetSettings.get("showThumbView")&&PlayerNavSliderView.gi(),FlipSnackEmbed.isEditor&&PlayerNavSliderView.gi().listenTo(FSWidgetModel.gi().widgetSettings,"change:showThumbView",PlayerNavSliderView.gi().showThumbViewChanged)))}function destroyNavSliderView(){PlayerNavSliderView._instance&&(PlayerNavSliderView.gi().remove(),PlayerNavSliderView._instance=null)}PlayerNavSliderView.HEIGHT=42,PlayerNavSliderView.MARGIN=20,PlayerNavSliderView.THUMB_HEIGHT=91,PlayerNavSliderView._instance=null,PlayerNavSliderView.gi=function(){return PlayerNavSliderView._instance||(PlayerNavSliderView._instance=new PlayerNavSliderView),PlayerNavSliderView._instance},Backbone.Mediator.sub(WidgetEvent.CONFIG_DONE,createNavSliderView,this),Backbone.Mediator.sub(WidgetEvent.DESTROY,destroyNavSliderView,this);var AccessibilityPageNumber=Backbone.View.extend({events:{},template:_.template(Templates.accessibilityPageNumber),className:"pageNumber",render:function(){return this.$el.html(this.template(this.model.attributes)),this},initialize:function(){this.isMobile=FSUtils.isMobileDevice(),this.isArabicStyle=FSWidgetModel.gi().widgetSettings.get("arabicStyle"),this.isSinglePageView=FSWidgetModel.gi().widgetSettings.get("singlePageView"),this.listenTo(FSWidgetModel.gi().widgetState,"change:currentPageIndex",this.handlePageChange),this.isMobile&&this.listenTo(FSWidgetModel.gi().widgetState,"change:rightPageIndex",this.handlePageChange)},handlePageChange:function(e){var t=e.get("currentItem").attributes.pages.length,i=e.attributes.leftPageIndex<0?0:e.attributes.leftPageIndex,n=this.isArabicStyle?t-i:i+1,s=this.isArabicStyle?n-1:n+1,o=[n];this.isMobile&&FSUtils.isPortrait()||this.isSinglePageView||n<t&&n>1&&o.push(s),this.$el.html(this.template({totalPages:t,currentPage:o.join("-")}))}}),GenericPopin=Backbone.View.extend({template:_.template(Templates.genericPopin),className:"generic-popin",events:{"click .btn-x":"onClosePopin","click .popin-overlay":"onClosePopin","mousemove .popin-overlay":"onMouseHandle","mouseenter .popin-overlay":"onMouseHandle","mouseleave .popin-overlay":"onMouseHandle","mousemove .popin-panel":"onMouseHandle","mouseenter .popin-panel":"onMouseHandle","mouseleave .popin-panel":"onMouseHandle"},initialize:function(){Backbone.Mediator.sub(CustomContentEvent.VIDEO_EMBED_SIZE,this.showVideo,this)},render:function(){return this.$el.html(this.template()),this},setContent:function(e){this.$el.find(".popin-content").html(e)},showModal:function(e){var t=this.$el.find(".popin-panel");this.$el.css({opacity:0}).show(),e||this.showVideo({videoWidth:t.width(),videoHeight:t.height()})},showVideo:function(e){var t=this.$el.find(".popin-panel");e&&e.videoWidth&&e.videoHeight&&(t.css({marginTop:-1*t.height()/2,marginLeft:-1*t.width()/2}),this.$el.animate({opacity:1},200))},hidePopin:function(){var e=this;Backbone.Mediator.pub(WidgetEvent.BEFORE_POPIN_CLOSE,this.$el),this.$el.animate({opacity:0},200,(function(){e.$el.hide()}))},closePopin:function(){this.onClosePopin()},onClosePopin:function(){Backbone.Mediator.pub(WidgetEvent.POPIN_CLOSE),this.$el.find(".popin-content").empty()},onMouseHandle:function(e){return"INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName||(e.stopImmediatePropagation(),e.preventDefault(),!1)},centerPopin:function(){var e=this.$el.find(".popin-panel");e.css({marginTop:-1*e.height()/2,marginLeft:-1*e.width()/2})}}),PopupFrame=Backbone.View.extend({template:_.template(Templates.popupFrame),placeholder:_.template(Templates.popupFramePlaceholder),closeButton:_.template(Templates.closeSpotlightPopin),code:_.template(Templates.popupFrameCode),className:"custom-spotlight-popin",events:{"click .popin-overlay":"closePopin","click .close-popin":"closePopin","mousemove .popin-overlay":"onMouseHandle","mouseenter .popin-overlay":"onMouseHandle","mouseleave .popin-overlay":"onMouseHandle","mousemove .popin-panel":"onMouseHandle","mouseenter .popin-panel":"onMouseHandle","mouseleave .popin-panel":"onMouseHandle"},popinPercentage:.8,initialize:function(){Backbone.Mediator.sub(WidgetEvent.SCALE_POPUP_FRAME,this.setCss,this)},render:function(){return this.$el.html(this.template()),this},onMouseHandle:function(e){e.stopImmediatePropagation()},handleIframeLoad:function(e,t){var i=Math.min(t.width*this.popinPercentage,t.height*this.popinPercentage);e.contentWindow.document.body.scrollHeight&&(e.style.height=Math.min(e.contentWindow.document.body.scrollHeight,i)+"px"),e.contentWindow.document.body.scrollWidth&&(e.style.width=Math.min(e.contentWindow.document.body.scrollWidth,i)+"px"),e.contentDocument.body.style.padding=0,e.contentDocument.body.style.margin=0},getContent:function(e){var t=document.createElement("iframe"),i="<body>"+decodeURI(e.popupFrameCode)+"</body>",n=this;$(t).attr("sandbox","allow-modals allow-forms allow-scripts allow-same-origin allow-popups allow-downloads"),t.srcdoc="<div>"+decodeURI(e.popupFrameCode).encodeHTML()+"</div>",t.src="data:text/html;charset=utf-8,"+encodeURI(i),t.onload=function(){n.handleIframeLoad(t,e)},this.$el.find(".popin-content").html(t).append(this.closeButton())},getPlaceholder:function(e){var t=this.placeholder(),i=Math.min(e.width*this.popinPercentage,e.height*this.popinPercentage);this.$el.find(".popin-content").html(t).css({width:i,height:i}).append(this.closeButton())},showModal:function(e){if(e.popupFrameCode)try{this.getContent(e)}catch(t){this.getPlaceholder(e)}else this.getPlaceholder(e);this.setCss(e.scale),this.$el.css({opacity:1}).show()},hidePopin:function(){var e=this;this.$el.find(".popin-content").html(""),this.$el.animate({opacity:0},300,(function(){e.$el.hide()}))},setCss:function(e){var t=Math.min(parseFloat(e),1);FSUtils.isMobileDevice()&&(t*=.8);var i="translate(-50%, -50%) scale("+t+")";this.$el.find(".popin-panel").css({transform:i})},closePopin:function(){Backbone.Mediator.pub(WidgetEvent.CLOSE_POPUP_FRAME),this.$el.find(".popin-content").empty()},remove:function(){Backbone.Mediator.unsubscribe(WidgetEvent.SCALE_POPUP_FRAME,this.setCss,this)}}),ProductTagPopin=Backbone.View.extend({template:_.template(Templates.productTagPopin),contentTemplate:_.template(Templates.productTagPopinContent),className:"product-tag-popin",events:{"click .popin-overlay":"closePopin","click .close-popin":"closePopin","click .image-preview":"selectImage"},initialize:function(){Backbone.Mediator.sub(WidgetEvent.SCALE_PRODUCT_TAG_POPIN,this.setCss,this),this.media=[]},render:function(){return this.$el.html(this.template()),this},showModal:function(e){this.$el.find(".popin-content").html(this.contentTemplate(e)),this.setCss(e.scale),this.insertMediaInPopin(e),this.$el.css({opacity:1}).show()},hidePopin:function(){var e=this;this.$el.animate({opacity:0},300,(function(){e.$el.hide()}))},getImageSrc:function(e){if(e.provider&&"external"===e.provider){var t=FSWidgetModel.gi().get("accountId"),i=window.URLPaths.CONTENT_PATH.length?"/":"";return window.URLPaths.CONTENT_PATH+i+t+"/library/external/"+e.hash}return FlipSnackEmbed.urls.uploadPath+e.hash},insertMediaInPopin:function(e){if(this.media=e.media,this.media&&this.media.length){var t=this.$el.find(".image-container img"),i=this.$el.find(".product-images"),n=this.media[0];t.attr("src",this.getImageSrc(n));var s=this;this.media.length>1&&this.media.forEach((function(e,t){var n='<div class="image-preview" index="'+t+'" style="background-image: url('+s.getImageSrc(e)+')"></div>';i.append(n)}))}},selectImage:function(e){var t=e.target;this.$el.find(".image-container img").attr("src",this.getImageSrc(this.media[t.getAttribute("index")]))},setCss:function(e){var t=Math.min(parseFloat(e),1);FSUtils.isMobileDevice()&&(t*=.8);var i="translate(-50%, -50%) scale("+t+")";this.$el.find(".popin-panel").css({transform:i})},closePopin:function(){Backbone.Mediator.pub(WidgetEvent.CLOSE_PRODUCT_TAG_POPIN),this.$el.find(".popin-content").empty()},remove:function(){Backbone.Mediator.unsubscribe(WidgetEvent.SCALE_PRODUCT_TAG_POPIN,this.setCss,this)}}),SimpleLoader=Backbone.View.extend({template:_.template(Templates.simpleLoader),initialize:function(){var e=this.model.get("source"),t=this;this.setElement(this.template()),this.preloader=new WheelPreloader(20),this.$preloader=this.$el.find(".fsw-wheelpreloader"),this.$image=this.$el.find("img"),this.$image.on("load",(function(){t.resizeImage(),$(this).css("opacity",1)})),this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"change:source",this.load),this.resizeImage(),e&&e.length&&this.load()},render:function(){return("width"in this.model.changed||"height"in this.model.changed)&&this.resizeImage(),this},resizeImage:function(){var e,t,i,n,s=this.model.get("originalWidth"),o=this.model.get("originalHeight"),a=this.model.has("width")?this.model.get("width"):s,r=this.model.has("height")?this.model.get("height"):o,l=s/a,c=o/r;if("number"==typeof s&&"number"==typeof o)switch(this.model.get("scaleMode")){case"scale":l>c?(e=a,t=o/l):(t=r,e=s/c);break;case"scaleCrop":l<c?(e=a,t=o/l):(t=r,e=s/c);break;case"crop":e=s,t=o;break;default:e=a,t=r}else e=a,t=r;e=e.toFixed(2),t=t.toFixed(2),this.model.set({imageWidth:e,imageHeight:t}),this.$el.css({width:a+"px",height:r+"px"}),n={width:e+"px",height:t+"px",position:"absolute",top:0,left:0},this.model.get("cropData")&&(i={left:-e/this.model.get("cropData").width*this.model.get("cropData").left,top:-t/this.model.get("cropData").height*this.model.get("cropData").top,width:e/this.model.get("cropData").width,height:t/this.model.get("cropData").height,position:"absolute"},n=$.extend(!0,{},n,i)),this.model.get("isMapped")&&(n={width:"100%",height:"100%",left:0,top:0,objectFit:"contain"}),this.$image.css(n)},load:function(){this.model.set("status",ContentLoaderStatus.LOADING),this.$preloader.append(this.preloader.render().$el),this.$el.css("background",""),this.$image.attr("src","").css({opacity:0,visibility:"hidden"}),this.tempImage&&this.removeTempImage(),this.model.get("source")&&this.model.get("source").length&&this.createTempImage()},loadComplete:function(){this.tempImage&&("tile"!==this.model.get("scaleMode")?this.$image.css("visibility","visible").attr("src",this.model.get("source")):this.$el.css({background:"url("+this.model.get("source")+") repeat"}),this.model.set({originalWidth:this.tempImage.width,originalHeight:this.tempImage.height,status:ContentLoaderStatus.COMPLETE}),this.$preloader.empty())},loadError:function(){this.model.set({originalWidth:void 0,originalHeight:void 0,status:ContentLoaderStatus.ERROR}),this.$preloader.empty()},createTempImage:function(){var e=this;this.tempImage=new Image,this.tempImage.addEventListener("load",(function(){e.loadComplete()})),this.tempImage.addEventListener("abort",(function(){e.loadError()})),this.tempImage.addEventListener("error",(function(){e.loadError()})),this.tempImage.src=this.model.get("source")},removeTempImage:function(){var e=this;this.tempImage&&(this.tempImage.removeEventListener("load",(function(){e.loadComplete()})),this.tempImage.removeEventListener("abort",(function(){e.loadError()})),this.tempImage.removeEventListener("error",(function(){e.loadError()})),this.tempImage.src="",this.tempImage=null)},show:function(){this.$el.css("visibility","visible")},hide:function(){this.$el.css("visibility","hidden")},isVisible:function(){return"visible"===this.$el.css("visibility")},remove:function(){this.preloader&&(this.preloader.remove(),this.preloader=null),this.removeTempImage(),this.$image.off(),this.stopListening(this.model),Backbone.View.prototype.remove.apply(this,arguments)}}),SpotlightPopin=Backbone.View.extend({template:_.template(Templates.spotlightPopin),image:_.template(Templates.spotlightImage),placeholder:_.template(Templates.spotlightPlaceholder),closeButton:_.template(Templates.closeSpotlightPopin),className:"spotlight-popin",events:{"click .popin-overlay":"closePopin","click .close-popin":"closePopin","mousemove .popin-overlay":"onMouseHandle","mouseenter .popin-overlay":"onMouseHandle","mouseleave .popin-overlay":"onMouseHandle","mousemove .popin-panel":"onMouseHandle","mouseenter .popin-panel":"onMouseHandle","mouseleave .popin-panel":"onMouseHandle"},popinPercentage:.8,initialize:function(){Backbone.Mediator.sub(WidgetEvent.SCALE_SPOTLIGHT_POPIN,this.setCss,this)},render:function(){return this.$el.html(this.template()),this},onMouseHandle:function(e){e.stopImmediatePropagation()},getImage:function(e){var t=FSUtils.calculateScaledSize(e.imageWidth,e.imageHeight,e.width*this.popinPercentage,e.height*this.popinPercentage,!1),i=this.image({spotlightImageUrl:e.spotlightImageUrl,width:t.width,height:t.height});this.$el.find(".popin-content").html(i).append(this.closeButton()).css({width:"unset",height:"unset"}),this.$el.find("img").attr({width:t.width,height:t.height})},getPlaceholder:function(e){var t=this.placeholder(),i=Math.min(e.width*this.popinPercentage,e.height*this.popinPercentage);this.$el.find(".popin-content").html(t).css({width:i,height:i}).append(this.closeButton())},showModal:function(e){e.spotlightImageUrl?this.getImage(e):this.getPlaceholder(e),this.setCss(e.scale),this.$el.css({opacity:1}).show()},hidePopin:function(){var e=this;this.$el.animate({opacity:0},300,(function(){e.$el.hide()}))},setCss:function(e){var t=Math.min(parseFloat(e),1);FSUtils.isMobileDevice()&&(t*=.8);var i="translate(-50%, -50%) scale("+t+")";this.$el.find(".popin-panel").css({transform:i})},closePopin:function(){Backbone.Mediator.pub(WidgetEvent.CLOSE_SPOTLIGHT_POPIN),this.$el.find(".popin-content").empty()},remove:function(){Backbone.Mediator.unsubscribe(WidgetEvent.SCALE_SPOTLIGHT_POPIN,this.setCss,this)}}),WheelPreloader=Backbone.View.extend({el:_.template(Templates.wheelPreloader),initialize:function(e){var t=e/200;this.$el.css({"-webkit-transform":"scale("+t+")","-moz-transform":"scale("+t+")","-ms-transform":"scale("+t+")",transform:"scale("+t+")"})},render:function(){return this}}),WidgetWatermark=Backbone.View.extend({template:_.template(Templates.embedWatermark),initialize:function(){this.setElement(this.template()),this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.find("img").attr("src",this.model.get("logoSrc")),this.model.get("embedWidth")<this.model.get("lowerLimitWidth")||this.model.get("embedHeight")<this.model.get("lowerLimitHeight")?this.$el.removeClass("medium large").addClass("small"):this.model.get("embedWidth")>=this.model.get("limitWidth")&&this.model.get("embedHeight")>=this.model.get("limitHeight")?this.$el.removeClass("medium small").addClass("large"):this.$el.removeClass("small large").addClass("medium"),this},show:function(){this.$el.show()},hide:function(){this.$el.hide()}}),WidgetWatermarkBar=Backbone.View.extend({template:_.template(Templates.embedWatermarkBar),initialize:function(){this.setElement(this.template()),this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.find("a").attr("href",this.getUrl()),this.$el.find("img").attr("src",this.model.get("logoSrc")),this},getUrl:function(){return this.model.get("flipsnackUrl")+"/?utm_source=watermark&utm_medium=embed&utm_campaign=UGC"}});WidgetWatermarkBar.WATERMARK_BAR_HEIGHT=37,function(e){window.FlipSnackEmbed||(window.FlipSnackEmbed={}),window.FlipSnackEmbed=function(t){var i,n,s,o,a,r,l,c,d,h,u,p,g,f,m,v,b,y,S,w,E,T,P,I=50,F=50,C=100,M=100,k=250,x="OKACCESS",L=["www.flipsnack.com","prelive.flipsnack.com","site.flipsnack.net","app.flipsnack.net","widget.flipsnack.io","flipsnack.io","app.flipsnack.io","app.flipsnack.com","app-prelive.flipsnack.com"],A={siteURL:"//www.flipsnack.com",baseUrl:"//cdn.flipsnack.com",mainEmbedDomain:"cdn.flipsnack.com",cloudFront:"d1dhn91mufybwl.cloudfront.net",s3:"//cdn.flipsnack.com",s3secure:"//cdn.flipsnack.com",content:"https://content.flipsnack.com",appUrl:"//app.flipsnack.com",cloudfrontStatic:"https://d1fpu6k62r548q.cloudfront.net"},O={siteURL:"//www.flipsnack.com",baseUrl:"https://s3.amazonaws.com/files.flipsnack.net",mainEmbedDomain:"cdn.flipsnack.com",cloudFront:"d1dhn91mufybwl.cloudfront.net",s3:"https://s3.amazonaws.com/files.flipsnack.net",s3secure:"https://s3.amazonaws.com/files.flipsnack.net"},D={siteURL:"https://stage.site.flipsnack.net",baseUrl:"//cdn.flipsnack.net",mainEmbedDomain:"cdn.flipsnack.net",cloudFront:"d1dc988o4ywp3l.cloudfront.net",s3:"//cdn.flipsnack.net",s3secure:"//cdn.flipsnack.net",content:"https://content.flipsnack.net",appUrl:"//stage.app.flipsnack.net",cloudfrontStatic:"https://ddstjwonkdwuz.cloudfront.net"},W={siteURL:"https://stage.site.flipsnack.net",baseUrl:"https://s3-eu-central-1.amazonaws.com/flipsnack-dev",mainEmbedDomain:"https://s3-eu-central-1.amazonaws.com/flipsnack-dev",cloudFront:"d1dc988o4ywp3l.cloudfront.net",s3:"https://s3-eu-central-1.amazonaws.com/flipsnack-dev",s3secure:"https://s3-eu-central-1.amazonaws.com/flipsnack-dev"},N={siteURL:"https://www.flipsnack.com",baseUrl:"",mainEmbedDomain:"",s3:"",s3secure:""},R={DEV:{siteURL:"//enterprise.dev.flipsnack.net",baseUrl:"//d3hnuexrnaisrd.cloudfront.net",mainEmbedDomain:"d3hnuexrnaisrd.cloudfront.net",s3:"//d3hnuexrnaisrd.cloudfront.net",s3secure:"//d3hnuexrnaisrd.cloudfront.net",content:"https://content.flipsnack.net"},DEV_NOCDN:{siteURL:"//enterprise.dev.flipsnack.net",baseUrl:"//devfiles.enterprise.flipsnack.net.s3.amazonaws.com",mainEmbedDomain:"devfiles.enterprise.flipsnack.net.s3.amazonaws.com",s3:"https://devfiles.enterprise.flipsnack.net.s3.amazonaws.com",s3secure:"https://s3.amazonaws.com/devfiles.enterprise.flipsnack.net"},LIVE:{siteURL:"//www.flipsnackenterprise.com",baseUrl:"//dgbgkkl7v688n.cloudfront.net",mainEmbedDomain:"dgbgkkl7v688n.cloudfront.net",s3:"//dgbgkkl7v688n.cloudfront.net",s3secure:"//dgbgkkl7v688n.cloudfront.net",content:"https://content.flipsnack.com"},LIVE_NOCDN:{siteURL:"//www.flipsnackenterprise.com",baseUrl:"//files.enterprise.flipsnack.net",mainEmbedDomain:"cdn.enterprise.flipsnack.net",s3:"https://files.enterprise.flipsnack.net",s3secure:"https://s3.amazonaws.com/files.enterprise.flipsnack.net"}},B="5.1.0",H=parseInt(1e6*Math.random()),U=!1,V={},$=null,j="#4e5565",z="color",G="",q="",Y=!1,X=!1,K=!1,Z=!1,J="",Q=!1,ee=!1,te=!1,ie=!1,ne=!1,se=!1,oe=null,ae=null,re=!1,le=!1,ce=!1,de=!1,he=!1,ue=!1,pe=!1,ge="",fe=!1,me=void 0,ve=!1,be=null,ye=!0,Se=!0,we=!1,Ee=!1,Te="",_e="",Pe="",Ie=!1,Fe=[],Ce=!0,Me=!1,ke=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),xe=!1,Le=!1;function Ae(){var e=s.shelfData&&s.shelfData.shelfOpened,t=FSWidgetModel.gi().widgetState.get("displayState")!==DisplayState.NORMAL,i=FSWidgetModel.gi().widgetState.get("currentPageIndex")+1,n=FSWidgetModel.gi().widgetState.get("currentItemIndex")+1;s.params.singlePageView=!(!y&&!e)||bt(),mt({fullScreen:t,startPage:i,si:n})}function Oe(){g&&(g.remove(),g=null)}function De(){r=e("<div>").attr("id","fsw_widget_"+H).css({width:"100%",height:"100%"})}function We(){var e=!1;return b||FlipSnackEmbed.urls.customDomain?e=!0:_.each(L,(function(t){(q.indexOf(t)>-1&&"cdn.flipsnack.net"!==q||""===q||q.endsWith("app.flipsnack.net"))&&(e=!0)})),e}function Ne(){K?at():function(){"string"==typeof s.title&&s.title.length>0&&(document.title=s.title);if(s.isBlocked)return void a.append(e('<div class="fsw-embedmsg-container"></div>').append(e('<p class="fsw-embed-message">Currently blocked due to a copyright infringement complaint. Sorry about that.</p>')));if("editable"===s.albumType&&!Z)return Oe(),!1;ft(),tt()}()}function Re(e){var t,i;if("English"!==e){if(t=FlipSnackEmbed.urls.labelsJSON,!(i={Basque:"basque",Bosanski:"bosanski","Catal":"catalan",Czech:"czech",Dansk:"dansk",Deutsch:"deutsch","Espaol":"spanish","":"hebrew","":"hebrew","":"hebrew","":"hebrew","Franaise":"french","":"greek",Hrvatski:"hrvatski",Indonesian:"indonesian",Italiano:"italiano",Magyar:"magyar",Nederlands:"nederlands",Norsk:"norsk",Polski:"polski","Portugus":"portugues","Portugus do Brasil":"portuguesdobrasil","Romn":"romana","P":"russian","C":"bosnian",Slovene:"slovene",Suomi:"suomi",Turkish:"turkish",Slovak:"slovak",Swedish:"swedish"})[e])for(var n in i)0===n.localeCompare(e)&&(e=n);window.labelsLoaded=function(e){var t,i,n,s;t=e,i=$.model.defaults.labels,n=t.language.tooltipLabels,s={},Object.keys(i).forEach((function(e){n[e]?s[e]=n[e]:s[e]=i[e]})),$?$.model.set("labels",s):(Ie=!0,m=s)},FSUtils.loadScript(t+i[e]+".js")}else $&&$.model.set("labels",$.model.defaults.labels)}function Be(e){e&&e.length&&(Fe=e.map((function(e){return"layout_"+e}))),ze()}function He(e,t){i=V.width=e,n=V.height=t,c&&(Se&&ye?(c.show(),c.model.set({embedWidth:i,embedHeight:n})):c.hide()),$&&$.model&&$.model.set({width:i,height:n}),p&&lt(),h&&(ut(),ht())}function Ue(){return!!(void 0!==document.fullScreenElement&&null!==document.fullScreenElement||void 0!==document.mozFullScreen&&document.mozFullScreen||!FSUtils.isIpad()&&void 0!==document.webkitIsFullScreen&&document.webkitIsFullScreen&&document.webkitFullscreenElement||void 0!==document.msFullscreenElement&&document.msFullscreenElement)}function Ve(){var e;FSWidgetModel.gi().get("shelfData")&&FSWidgetModel.gi().get("shelfData").get("itemOpened")&&(Stats._instance=null,$&&$.fullScreenChange&&$.fullScreenChange(!1),Backbone.Mediator.pub(NewShelfEvents.CLOSE_ITEM),e=FSUtils.parseJSONData(FSWidgetModel.gi().get("shelfData").get("shelfJson"),FlipSnackEmbed.urls.siteURL,J),s=e,re=!1,Y=!1,X=!0,se=!0,mt(),ft())}function $e(e){if(!ke||Ue()||window.innerHeight!==screen.height)if(v){var t=a[0];Ue()?(a.removeClass("full-screen"),document.cancelFullScreen?document.cancelFullScreen():document.exitFullScreen?document.exitFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&!FSUtils.isIpad()?(document.webkitCancelFullScreen(),$&&$.fullScreenChange&&$.fullScreenChange(!1)):document.msCancelFullScreen?document.msCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()):t.requestFullScreen?t.requestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&!FSUtils.isIpad()?t.webkitRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen(),Y&&Ve()}else e&&e.hash?je(e.hash):je()}function je(e){var t,i,n=e||J;if(re)return pe&&window.close(),void window.history.back();t=FlipSnackEmbed.urls.baseUrl+window.location.pathname+"?hash="+n+"&t="+G+"&fullscreen=1",pe&&(t="iframe.html?hash="+n+"&t="+G+"&fullscreen=1&download=1"),i=location.host,ce||i!==FlipSnackEmbed.urls.mainEmbedDomain&&i!==W.mainEmbedDomain?window.open(t):window.parent.location.href=t}function ze(t){var i=FlipSnackEmbed.urls.collectionJSON+J+(""!==G?"?t="+G:"")+(pe?".json":"");if(pe){var n=[{name:"json",src:FlipSnackEmbed.urls.baseUrl+"collections/json/"+J+".js"},{name:"icons",src:FlipSnackEmbed.urls.baseUrl+"resources/icons.js"},{name:"shapes",src:FlipSnackEmbed.urls.baseUrl+"resources/shapes.js"}];n.map((function(e){var t=document.createElement("script");t.type="text/javascript",t.onload=function(){FSUtils.removeFromArrayWhereKey(n,"name",e.name),n.length||qe(window["json_"+J]())},t.onerror=function(){FSUtils.removeFromArrayWhereKey(n,"name",e.name)},document.head.appendChild(t),t.src=e.src}))}else if(FSUtils.isIE9()){var s=new XDomainRequest;s.open("GET",i),s.onerror=et,s.onload=function(){qe(JSON.parse(s.responseText))},s.send()}else t?e.getJSON(i,"",Ge).fail(et):e.getJSON(i,"",qe).fail(et)}function Ge(e){qe(e),mt()}function qe(e){!0,K=!1,s=FSUtils.parseJSONData(e,FlipSnackEmbed.urls.siteURL,J),e.config.params.widgetType===WidgetType.SHELF&&e.config.params.newShelf&&(se=!0),s.collection&&s.collection.length||s.shelfData&&s.shelfData.shelfOpened?(FlipSnackEmbed.isEditor="published"!==s.albumType,FlipSnackEmbed.isPublish="published"!==s.albumType&&"publish"===S,FlipSnackEmbed.isRestrictedDomain=!function(e,t){if(e&&t&&t.useRestrictedDomains){if(!function(){try{return window.self!==window.top}catch(e){return!0}}())return!1;var i=!1,n=null;if(window.location.ancestorOrigins?n=window.location.ancestorOrigins[0]:document.referrer&&(n=document.referrer),n){var s=new URL(n).hostname;_.each(t.restrictedDomains,(function(e){s===e&&(i=!0)}))}return We()||i}return!0}(s.features.WIDGET_DOMAIN_RESTRICTIONS,s.params.restrictedDomainsSettings),y=void 0===s.params.contentLayout?s.params.singlePageView:s.params.contentLayout===ContentLayout.SINGLE_PAGE,s.params.contentLayout===ContentLayout.SINGLE_PAGE&&(s.params.showPageShadows=!1),s.params.singlePageView=!!y||bt(),s.params.mergePdfs=!1,FlipSnackEmbed.isRestrictedDomain&&(T=Xe(x,Qe,(function(){Je(!0)})),window.addEventListener("message",T),window.top.postMessage("getAccessConfirmation-"+J,"*"),E=setTimeout((function(){Je(!0)}),k)),ot()||"PRIVATE_EMAIL"!==s.visibility||"published"!==s.albumType||pe||fe?s.visibility!==FlipbookVisibilityType.PRIVATE_SSO||We()?(T=Xe(x,st,(function(){})),window.top.postMessage("getCartAccess-"+J,"*"),window.addEventListener("message",T,!0),xe||Ee&&window.isMobileApp?(P=Xe("OKTOREAD",Ze,Ke),window.addEventListener("message",P,!0),window.top.postMessage("getSellAccess-"+J,"*"),w=setTimeout(Ke,k)):Ne(),vt(s),function(e){if(!pe&&"string"==typeof e.gtmId&&e.gtmId.length&&e.features.WIDGET_GTM&&!FlipSnackEmbed.isEditor){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="//www.googletagmanager.com/gtm.js?id="+e.gtmId,document.getElementsByTagName("head")[0].appendChild(t)}}(s)):Je(!1):nt()):at()}function Ye(e){return!(!U&&!FlipSnackEmbed.urls.customDomain&&L.indexOf(e.origin.replace(/^https?\:\/\//i,""))<0&&""!==e.origin.replace(/^https?\:\/\//i,""))}function Xe(e,t,i){return function(n){var s=function(e){if(e&&e.data&&"function"==typeof e.data.split){var t=e.data.split("-");return{name:t[0],value:t[1]}}return{name:"UNKNOWN",value:null}}(n);s.name===e&&(!function(e,t){return Ye(e)&&J===t}(n,s.value)?i&&"function"==typeof i&&i():t&&"function"==typeof t&&t())}}function Ke(){clearTimeout(w),window.removeEventListener("message",P),Ne()}function Ze(){clearTimeout(w),window.removeEventListener("message",P),s.sell={},s.watermark=!1,s.features.FLIP_PAGES=-1,Ne()}function Je(t){var i="The publication youre trying to access is private.";t&&(i="Cannot display the publication due to domain restrictions made by the creator."),clearTimeout(E),window.removeEventListener("message",T),Oe(),a.append(e('<div class="fsw-embedmsg-container"></div>').append(e('<p class="fsw-embed-message">'+i+"</p>"))),Backbone.Mediator.sub(NewShelfEvents.CLOSE_ITEM,(function(){e(".fsw-embedmsg-container").remove()}),this)}function Qe(){clearTimeout(E),window.removeEventListener("message",T),vt(s),Ne()}function et(e){!1,K=!0,Ne()}function tt(t){var o,l;Oe(),Ie||Re(s.params.language),f=void 0===s.features||void 0===s.features.WIDGET_NO_WATERMARK?s.watermark:!s.features.WIDGET_NO_WATERMARK,ye=f&&ye&&!Z&&!ne,s.watermark=ye,we=s.publisher||ee||Z||ne,s.publisher=!0===we,Se=ye&&Se&&!te,(!s.features||s.features&&!Object.keys(s.features).length)&&(s.features=f?{SELL:!1,FLIP_PAGES:30,FLIP_FILES:3,WIDGET_NO_WATERMARK:!1,WIDGET_RTL_ORIENTATION:!1,WIDGET_SINGLE_PAGE_VIEW:!1,WIDGET_SEARCH:!1,CUSTOM_FONTS:!1,WIDGET_SHELF:!1,WIDGET_LOGO:!1,WIDGET_PASSWORD:!1,WIDGET_ANALYTICS:!1,WIDGET_GTM:!1,WIDGET_PRINT:!1,WIDGET_MEDIA:!1,WIDGET_TAGS:!1,WIDGET_FORMS:!1,WIDGET_SHOPPING:!1,DOWNLOAD_PDF:!1,LAYOUTS:!1,TABLE_OF_CONTENT:!1,LINKS_FROM_TEXT:!1,EMBED:!1,UPLOAD_VIDEO:!1,PRODUCT_TAG:!1,CHARTS:!1,SLIDESHOW:!1,POPUP_FRAME:!1,SPOTLIGHT:!1}:{SELL:!1,FLIP_PAGES:100,FLIP_FILES:100,WIDGET_NO_WATERMARK:!0,WIDGET_RTL_ORIENTATION:!0,WIDGET_SINGLE_PAGE_VIEW:!0,WIDGET_SEARCH:!0,CUSTOM_FONTS:!0,WIDGET_SHELF:!1,WIDGET_LOGO:!1,WIDGET_PASSWORD:!1,WIDGET_ANALYTICS:!1,WIDGET_GTM:!1,WIDGET_PRINT:!0,WIDGET_MEDIA:!1,WIDGET_TAGS:!1,WIDGET_FORMS:!0,WIDGET_SHOPPING:!0,DOWNLOAD_PDF:!0,LAYOUTS:!0,TABLE_OF_CONTENT:!1,LINKS_FROM_TEXT:!1,EMBED:!1,UPLOAD_VIDEO:!1,PRODUCT_TAG:!1,CHARTS:!1,SLIDESHOW:!1,POPUP_FRAME:!1}),i!==s.params.collectionWidth&&(s.params.collectionWidth=i),n!==s.params.collectionHeight&&(s.params.collectionHeight=n),he&&(s.params.showFullScreenButton=!1),fe&&(s.params.exportVideo=!0,s.params.autoFlipDelay=1,s.params.showFullScreenButton=!1),_e=s.params.logoImage||"",Pe=gt(s.params.logoUrl||""),Se&&ye?c||(c=new WidgetWatermark({model:new Backbone.Model({embedWidth:i,embedHeight:n,lowerLimitWidth:500,lowerLimitHeight:200,limitWidth:759,limitHeight:759,logoSrc:FlipSnackEmbed.urls.baseUrl+"/site/images/flipsnack-logo-gray.gz.svg"})}),a.append(c.render().$el)):!ye&&_e.length>0&&(!s.security||FlipSnackEmbed.isEditor||FlipSnackEmbed.isPublish)&&(FlipSnackEmbed.isRestrictedDomain||pt()),o={viewIDPrefix:"fsw_widget_",collectionHash:J,accountId:s.accountId,sirAccountId:s.sirAccountId,widgetSuffix:H,fullScreen:re||X||t&&t.fullScreen,isDownload:pe,exportName:ge,isMobileDevice:Ee,openPayPalIndex:Te,showLimit:f&&ne,isDetailsPage:ne,blockEvents:se,noWatermark:!Se,isPublisher:!0===we,location:q,randomVal:G,width:i,height:n,collectionData:s,forceWidget:(!t||!t.fullScreen)&&ie,forceSmall:le,sandBoxType:U?"dev":"live",allowBrowserFullScreen:v,premiumLayouts:Fe,useCDN:!de,retryFirstItem:ue,isWhiteLabel:b,features:s.features,sellSettingsPage:Me,shelfData:s.shelfData,resourcePath:me,isApp:ve,skinType:s.params.skinType||WidgetSkinType.CLASSIC,hasAccessToCart:Le,readerHash:be,leadForm:s.features.WIDGET_FORMS?s.leadForm:null,type:s.albumType,accessibility:s.accessibility},s.params.singlePageView=void 0===s.params.contentLayout?s.params.singlePageView:s.params.contentLayout===ContentLayout.SINGLE_PAGE||bt(),oe&&"number"==typeof oe&&(o.startPage=oe),t&&t.startPage&&"number"==typeof t.startPage&&(o.startPage=t.startPage),ae&&"number"==typeof ae&&(o.startBook=ae),t&&t.startBook&&"number"==typeof t.startBook&&(o.startBook=t.startBook),Ie&&m&&(o.labels=m),l=FSWidgetModel.gi(o),$=new FSWidgetView({model:l,el:r[0]}),e(document).off("keydown").on("keydown",(function(t){var i=t.keyCode||t.which;if(-1!==e.inArray(i,[33,34,37,39,116]))switch(i){case 34:case 39:if(FSWidgetModel.gi().get("passwordPopinVisible"))return;Backbone.Mediator.pub(WidgetEvent.NEXT_PAGE),t.preventDefault();break;case 33:case 37:if(FSWidgetModel.gi().get("passwordPopinVisible"))return;Backbone.Mediator.pub(WidgetEvent.PREV_PAGE),t.preventDefault();break;case 116:s.params.remoteControlled&&(Backbone.Mediator.pub(WidgetEvent.ENTER_FULLSCREEN),t.preventDefault())}})),FSWidgetModel.gi().listenTo(FSWidgetModel.gi().widgetState,"change:currentPageIndex",(function(){var t=new e.Event("pageChanged");t.book=FSWidgetModel.gi().widgetState.get("currentItemIndex")+1,t.page=FSWidgetModel.gi().widgetState.get("currentPageIndex")+1,a.trigger(t)})),FSWidgetModel.gi().listenTo(FSWidgetModel.gi().widgetState,"change:currentItem",(function(){var t=new e.Event("bookChanged");t.book=FSWidgetModel.gi().widgetState.get("currentItemIndex")+1,t.page=1,a.trigger(t)})),Y||Backbone.Mediator.sub(NewShelfEvents.RELOAD_WITH_ITEM,it,this),Backbone.Mediator.sub(WidgetEvent.ENTER_FULLSCREEN,$e,this),Backbone.Mediator.sub(WidgetEvent.EXIT_FULLSCREEN,$e,this),s.security&&Backbone.Mediator.sub(WidgetEvent.PASSWORD_POPIN_CLOSE,(function(){!ye&&_e.length>0&&pt()}))}function it(e){s=e,re=!0,Y=!0,X=!1,se=!1,Backbone.Mediator.unsubscribe(NewShelfEvents.RELOAD_WITH_ITEM,it,this),ot()||"PRIVATE_EMAIL"!==s.visibility||"published"!==s.albumType?(mt(),ft()):nt((function(){clearTimeout(E),window.removeEventListener("message",T),mt(),ft()}))}function nt(e){T=Xe(x,e||Qe,Je),window.addEventListener("message",T),window.top.postMessage("getAccessConfirmation-"+J,"*"),E=setTimeout(Je,k)}function st(){window.removeEventListener("message",T),FSWidgetModel&&FSWidgetModel.gi()&&FSWidgetModel.gi().set("hasAccessToCart",!0),Le=!0}function ot(){return We()&&["/my-flipbooks/","/app/myflipbooks/","/app/sell/","/app/my-purchases/"].some((function(e){return FlipSnackEmbed.referrer.indexOf(e)>0}))}function at(){a.append(e('<div class="fsw-embedmsg-container"></div>').append(e('<p class="fsw-embed-message">There was an error loading the collection. Please try again later.</p>')))}function rt(t){e('<img id="fs_back_'+H+'"/>').load((function(){l.css("background","url("+t+")"+("image"===z?"no-repeat":"repeat")).css("background-color","#DEDEDE"),p=this,lt()})).attr("src",t)}function lt(){var e,t;if("image"===z)switch(s.params.backgroundScaleType){case"scale":case"scaleCrop":var i=l.width(),n=l.height(),o=1;o=p.width/i<=p.height/n?i/p.width:n/p.height,e=Math.round((i-o*p.width)/2),t=Math.round((n-o*p.height)/2),l.css("background-position",e+"px "+t+"px"),l.css("background-size",Math.round(o*p.width)+"px "+Math.round(o*p.height)+"px");break;case"center":e=Math.round((l.width()-p.width)/2),t=Math.round((l.height()-p.height)/2),l.css("background-position",e+"px "+t+"px");break;default:l.css("background-repeat","repeat")}}function ct(){h&&(e("#logoImage").off().remove(),h=null),d&&(d.off().empty().remove(),d=null)}function dt(){h&&(Pe&&Pe.length?h.css("cursor","pointer").off("click").on("click",(function(){window.open(Pe,"_blank")})):h.css("cursor","default").off("click"))}function ht(){var e=parseInt(d.css("bottom"),10),t=[5,35],i=Ue()?t[1]:t[0];$&&e!==i&&(FSWidgetModel.gi().widgetSettings.get("skinType")!==WidgetSkinType.PLAYER&&d.css("bottom",i+"px"),$.model.set("logo",{width:h.width(),height:h.height(),bottom:i,right:17}))}function ut(){var e=h.data(),t=e.oWidth,n=e.oHeight,s=0,o=0,a=C,r=M,l=1;i<1170&&(l=1-2*(1-(l=i/1170)),a=Math.max(I,a*l),r=Math.max(F,r*l)),(t>a||n>r)&&(t/n>1?(s=t/a,h.width(a),h.height(n/s)):(o=n/r,h.height(r),h.width(t/o)))}function pt(){var t=FlipSnackEmbed.urls.backgroundPath+_e+"?v="+s.resourceVersion;d=e('<div class="logo-container"></div>'),(h=e("<img>").attr("id","logoImage").css({opacity:0})).on("load",(function(){h.data({oWidth:h[0].width,oHeight:h[0].height}),ut(),a.append(d),FSWidgetModel.gi().widgetSettings.get("skinType")===WidgetSkinType.PLAYER?d.css({bottom:"60px",right:"30px"}):d.css({bottom:"0px",right:"17px"}),Ce&&h.css("opacity",1),dt(),ht()})),d.append(h),h.attr("src",t)}function gt(e){var t=e.toLowerCase()||"";return t.length>0&&0!==t.indexOf("http://")&&0!==t.indexOf("https://")&&0!==t.indexOf("ftp://")&&0!==t.indexOf("sftp://")&&(e="https://"+e),e.replace(/[^A-Za-z0-9-._~:/?#\[\]@!$&%'\(\)*+,;=]+/g,"")}function ft(){var e;a.removeClass("theme-light").removeClass("theme-dark"),s.params.transparentBackground?l.css("background","none"):(s.params.backgroundImage&&s.params.backgroundImage.length>0?(z="image",rt(FlipSnackEmbed.urls.backgroundPath+s.params.backgroundImage+"?v="+s.resourceVersion)):s.params.bgPattern&&s.params.bgPattern.length>0?(z="pattern",rt(FlipSnackEmbed.urls.patternPath+(pe?"":s.templateHash+"/")+s.params.bgPattern)):(z="color",e=FSUtils.colorToString(s.params.color),l.css("background",e),e.replace("#","")!==j.replace("#","")&&(isLightColor(e)?a.removeClass("theme-light").addClass("theme-dark"):a.removeClass("theme-dark").addClass("theme-light"))),"color"!==z&&l.css("background-color",j))}function mt(e){FlipSnackEmbed.containers.$embed.find("#docView").turn.initialLoading=null,$&&($.remove(),$=null),ct(),De(),FlipSnackEmbed.containers.$embed=r,a.append(l).append(r).append(u),tt(e)}function vt(e){pe||"function"!=typeof window.gtag||"string"!=typeof e.trackingId||!e.trackingId.length||FlipSnackEmbed.isEditor||gtag("config",e.trackingId,{groups:"clientTracker",anonymize_ip:!!e.ipAnonymization,cookie_flags:"max-age=7200;secure;samesite=none"})}function bt(){if(s.shelfData&&s.shelfData.shelfOpened||s.params.contentLayout===ContentLayout.DOUBLE_PAGE)return!1;var e;if(!FSUtils.isMobileDevice())return y;e=FSUtils.isIOS()&&!FSUtils.isChrome()?{w:FSUtils.isPortrait()?FSUtils.getScreenSize().width:FSUtils.getScreenSize().height,h:FSUtils.isPortrait()?FSUtils.getScreenSize().height:FSUtils.getScreenSize().width}:{w:FSUtils.getScreenSize().width,h:FSUtils.getScreenSize().height};var t,i,n,o={w:parseInt(s.collection[0].pageData[0].width),h:parseInt(s.collection[0].pageData[0].height)},a=o.h/10,r=10,l=10;e.w-=r,e.h-=l,t=(i=FSUtils.calculatePageSize(e.w,e.h,o.w,o.h,Math.floor)).height/10*2,i.width=i.width-t>o.w?o.w:i.width-t,i.height=i.height>o.h?o.h:i.height,t=(n=FSUtils.calculatePageSize(e.w,e.h,2*o.w+2*a,o.h,Math.floor)).height/10*2,n.width=n.width-t>o.w?o.w:(n.width-t)/2,n.height=n.height>o.h?o.h:n.height;var c=i.width*i.height;return c-.3*c>n.width*n.height}return function(t){var c=e("body");if(_.extend(V,t),U=location.host.indexOf("site.flipsnack.net")>-1||location.host.indexOf("flipsnack-dev")>-1||location.host.indexOf("cdn.flipsnack.net")>-1||location.host.indexOf("devfiles.enterprise.flipsnack.net")>-1||location.host.indexOf(D.cloudFront)>-1||location.host.indexOf(W.cloudFront)>-1||location.host.indexOf(R.DEV.mainEmbedDomain)>-1||location.host.indexOf("192.168.0")>-1||location.host.indexOf("mobile-widget.flipsnack.io")>-1||location.host.indexOf("widget.flipsnack.io")>-1||location.host.indexOf("s3-eu-central-1.amazonaws.com")>-1&&0===location.pathname.indexOf("/flipsnack-dev"),q=location.host,FlipSnackEmbed.referrer=t.referrer,"widget"!==location.host&&"widgetjs"!==location.host||(q="site.flipsnack.net",U=!0),q.indexOf("files.flipsnack.net")>-1||q.indexOf("flipsnack-dev.s3.amazonaws.com")>-1||q.indexOf("cdn.flipsnack.com")>-1||q.indexOf("cdn.flipsnack.net")>-1){var d=document.referrer.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i);q=d&&d[1]||location.host}if("string"==typeof t.hash&&t.hash.length>0){J=t.hash,"string"==typeof t.readerHash&&t.readerHash.length>0&&(be=t.readerHash),FlipSnackEmbed.impressionHash=FSUtils.generateImpressionHash(J);var p,f,m,w=document.createElement("link");if(w.id="roboto-font",w.rel="stylesheet",w.type="text/css",w.href=D.cloudfrontStatic+"/css/widget.css",w.media="all",document.head.appendChild(w),re=t.fullscreen&&"1"===t.fullscreen,G="string"==typeof t.t&&t.t.length>0?t.t:"",ie=void 0!==t.forceWidget&&null!==t.forceWidget,Se=!(t.rmm&&"1"===t.rmm),te=void 0!==t.bwd&&null!==t.bwd,ee=void 0!==t.pbs&&null!==t.pbs,Q=void 0!==t.forcewm&&null!==t.forcewm,ce=t.openfsnewtab||!1,Te="string"==typeof t.openpaypal&&t.openpaypal.length>0?t.openpaypal:void 0,ne=t.details&&"1"===t.details,se=void 0!==t.be&&null!==t.be,B="string"==typeof t.v&&t.v.length>0?t.v:B,void 0!==t.novignette&&null!==t.novignette,le=t.forceSmall&&"true"===t.forceSmall,de=t.nocdn&&"1"===t.nocdn,he=t.dfs&&"1"===t.dfs,ue=!(!t.step2||"1"!==t.step2),pe=!(!t.download||"1"!==t.download),ge=t.exportName||"",b=t.whitelabel,S=t.st,Me=Object.hasOwnProperty.call(t,"sellsettings"),fe=!(!t.exportVideo||1!==parseInt(t.exportVideo,10)),me="string"==typeof t.resourcepath&&t.resourcepath.length?t.resourcepath:void 0,ve=t.app&&"1"===t.app,t.p)try{oe="number"==typeof t.p?t.p:parseInt(t.p),oe}catch(e){}if(t.b)try{ae="number"==typeof t.b?t.b:parseInt(t.b),ae}catch(e){}_.extend(V,t),p=V.container,f=e(p||"body"),(a=e("<div />").attr("id","fsw").appendTo(f)).css({margin:0,padding:0,border:0,boxSizing:"border-box",fontSize:"100%",font:"inherit",verticalAlign:"baseline",width:"100%",height:"100%"}),o=a.parent(),l=e("<div />").attr("id","fsw_backContainer_"+H).css({backgroundColor:"transparent",width:"100%",height:"100%",position:"absolute",overflow:"hidden"}),De(),u=e("<div>").attr("id","fsw_preloader_"+H).css({position:"absolute",left:"50%",top:"50%",marginLeft:"-50px",marginTop:"-50px"}),a.css("overflow","hidden").append(l).append(r).append(u),FlipSnackEmbed.containers={$background:l,$embed:r,$preLoader:u,$main:a},re?a.addClass("full-screen"):a.removeClass("full-screen"),FlipSnackEmbed.urls=function(){var e,t="/";pe?(t="",(e=N).htmlSources="",me&&me.length&&(e.baseUrl=me+"/",e.s3=me+"/",e.s3secure=me+"/")):(e=U?de?b?R.DEV_NOCDN:W:b?R.DEV:D:de?b?R.LIVE_NOCDN:O:b?R.LIVE:A).htmlSources="/widget/v2/";-1!==[D.cloudFront,W.cloudFront,A.cloudFront,O.cloudFront].indexOf(location.host)&&(e.baseUrl="//"+location.host);return e.templateJS=e.baseUrl+t+"widget/",e.labelsJSON=e.baseUrl+t+"widget/labels/jsonp/",e.premiumLayouts=e.baseUrl+t+"templates/premium-layouts.gz.js",e.backgroundPath=e.baseUrl+t+"collections/customize/",e.uploadPath=e.baseUrl+t+"collections/uploads/",e.patternPath=pe?e.backgroundPath:e.baseUrl+t+"templates/images/",e.collectionXML=e.baseUrl+t+"collections/xml/",e.collectionJSON=e.s3secure+t+"collections/json/",e.items=e.baseUrl+t+"collections/items/",e.icons=e.baseUrl+t+"resources/icons/",e.textJS="/json/text.js",e.linkJS="/json/links.js",e.customDomain=void 0!==V.cd&&""!==V.cd?V.cd:"",e}(),i=V.width=a.width()||c.width(),n=V.height=a.height()||c.height(),Z=!Q&&We(),!(Ee=FSUtils.isMobileDevice())||Ee&&FSUtils.isAndroid()?(e(window).resize((function(){He(r.width(),r.height())})),Ee&&window.addEventListener("orientationchange",(function(){Ae()}))):e(window).on("resize",(function(e){var t=FSUtils.isIOS()?33:250;setTimeout((function(){He(r.width(),r.height()),Ae()}),t)})),xe=Z||Ee&&window.isMobileApp,g=new WheelPreloader(40),u.append(g.render().$el),u.children().addClass("fswp-blue-style"),FlipSnackEmbed.embedContainer=r,FlipSnackEmbed.isEditor=!1,FlipSnackEmbed.isPublish=!1,FlipSnackEmbed.isRestrictedDomain=!1,window.addEventListener("message",(function(e){var t=[];(fe||Ye(e))&&(e.data&&("string"==typeof e.data.param&&void 0!==e.data.value?"true"===e.data.value?e.data.value=!0:"false"===e.data.value&&(e.data.value=!1):"string"!=typeof e.data&&Object.keys(e.data).length&&(t=Object.values(e.data))),t&&t.length?function(e){var t={},i=_.clone(FSWidgetModel.gi().get("sell")),n=!1;e.forEach((function(e){switch(e.param){case"price":""!==e.value&&(i.price=e.value);break;case"previewPages":""!==e.value&&(i.previewPages=_.uniq(e.value).sort((function(e,t){return e-t})));break;case"sellEnabled":n=e.value&&i.enabled!==e.value,i.enabled=e.value,e.value&&(i.buyLink=FSUtils.getFlipbookBuyLink(FlipSnackEmbed.urls.siteURL,s.userProfile,J));break;case"subscriptionPrice":""!==e.value&&(i.subscriptionPrice=e.value);break;case"subscriptionFlipbooks":""!==e.value&&(i.subscriptionFlipbooks=e.value)}})),t.sell=i,n&&(s.sell={enabled:i.enabled,previewPages:i.previewPages,price:i.price,buyLink:i.buyLink},mt()),FSWidgetModel.gi().set(t)}(t):function(e){var t;switch(e.param){case"leadForm":s.leadForm=e.value&&e.value.active?e.value:null,mt(),e.value&&"number"==typeof e.value.pageIndex&&Backbone.Mediator.pub(WidgetEvent.CHANGE_PAGE,e.value.pageIndex);break;case"accessibility":e&&e.value&&e.value.enable?s.accessibility=e.value.pages:s.accessibility=null,mt();break;case"exitFullScreen":Ue()&&$e();break;case"transparentBackground":s.params.transparentBackground=e.value,ft();break;case"shelfColor":s.params.shelfColor=e.value,Backbone.Mediator.pub(WidgetEvent.CHANGE_SHELF_COLOR,e.value);break;case"setItemWidth":s.params.shelfItemWidth=e.value,mt();break;case"color":s.params.transparentBackground=!1,s.params.backgroundImage=void 0,s.params.bgPattern=void 0,s.params.color=e.value,ft();break;case"bgPattern":if(0===e.value.length)return;s.params.transparentBackground=!1,s.params.backgroundImage=void 0,s.params.bgPattern=e.value,s.params.color=void 0,ft();break;case"backgroundImage":if(0===e.value.length)return;s.params.transparentBackground=!1,s.params.backgroundImage=e.value,s.params.bgPattern=void 0,s.params.color=void 0,ft();break;case"backgroundScaleType":s.params.backgroundScaleType=e.value,ft();break;case"logoImage":s.params[e.param]=e.value,_e=e.value,ye||s.security&&!FlipSnackEmbed.isEditor||(ct(),_e.length>0&&pt());break;case"logoUrl":s.params[e.param]=e.value,Pe=gt(e.value||""),dt();break;case"logoDisplayed":Ce=e.value,h&&_e.length&&(Ce?h.css("opacity",1):h.css("opacity",0));break;case"showPageShadows":if(s.params.contentLayout===ContentLayout.SINGLE_PAGE)break;case"showThumbView":case"enableSounds":case"enableDownload":case"enablePrint":case"enableSearch":case"showFullScreenButton":case"sharePost":case"shareLink":case"shareFaceBook":case"shareTwitter":case"shareGooglePlus":case"sharePinterest":case"shareEmail":case"remoteControlled":case"autoFlip":case"autoFlipDelay":case"showControls":s.params[e.param]=e.value,FSWidgetModel.gi().widgetSettings.set(e.param,e.value);break;case"tooltipLanguage":case"language":s.params.language=e.value,FSWidgetModel.gi().widgetSettings.set(e.param,e.value),Re(s.params.language);break;case"mergePdfs":case"arabicStyle":case"widgetType":s.params[e.param]=e.value,mt();break;case"skinType":case"useHighlights":case"autoCreateLinks":case"enableToc":s.params[e.param]=e.value,FSWidgetModel.gi().widgetSettings.set(e.param,e.value),ze(!0);break;case"singlePageView":y=e.value,s.params.singlePageView=e.value,mt();break;case"enableHardCover":s.params[e.param]=e.value,mt();break;case"security":""!==e.value?s.security=e.value:void 0!==s.security&&delete s.security,mt();break;case"price":FSWidgetModel.gi().get("isForSelling")&&""!==e.value&&((t=_.clone(FSWidgetModel.gi().get("sell"))).price=e.value,FSWidgetModel.gi().set("sell",t));break;case"previewPages":FSWidgetModel.gi().get("isForSelling")&&""!==e.value&&((t=_.clone(FSWidgetModel.gi().get("sell"))).previewPages=_.uniq(e.value).sort((function(e,t){return e-t})),FSWidgetModel.gi().set("sell",t),s.sell={enabled:t.enabled,previewPages:t.previewPages,price:t.price,buyLink:t.buyLink,subscriptionPrice:t.subscriptionPrice,subscriptionFlipbooks:t.subscriptionFlipbooks},mt());break;case"sellEnabled":e.value||((t=_.clone(FSWidgetModel.gi().get("sell"))).enabled=e.value,FSWidgetModel.gi().set("sell",t),s.sell={enabled:!1,previewPages:[],price:"",buyLink:FSUtils.getFlipbookBuyLink(FlipSnackEmbed.urls.siteURL,s.userProfile,J),subscriptionPrice:"",subscriptionFlipbooks:0},mt());break;case"subscriptionPrice":(t=_.clone(FSWidgetModel.gi().get("sell"))).subscriptionPrice=e.value,FSWidgetModel.gi().set("sell",t);break;case"subscriptionFlipbooks":(t=_.clone(FSWidgetModel.gi().get("sell"))).subscriptionFlipbooks=e.value,FSWidgetModel.gi().set("sell",t);var i={};i.sell=_.clone(FSWidgetModel.gi().get("sell")),FSWidgetModel.gi().set(i)}}(e.data))})),m=document.documentElement,(v="function"==typeof(m.requestFullScreen||!FSUtils.isIpad()&&m.webkitRequestFullScreen||m.mozRequestFullScreen||m.msRequestFullscreen))&&document.addEventListener&&(document.addEventListener("fullscreeneventchange",(function(){Ue()||(a.removeClass("full-screen"),Ve()),$&&$.fullScreenChange&&$.fullScreenChange(Ue()),Ue()&&a.addClass("full-screen")})),document.addEventListener("fullscreenchange",(function(){Ue()||(a.removeClass("full-screen"),Ve()),$&&$.fullScreenChange&&$.fullScreenChange(Ue()),Ue()&&a.addClass("full-screen")})),document.addEventListener("msfullscreenchange",(function(){Ue()||(a.removeClass("full-screen"),Ve()),$&&$.fullScreenChange&&$.fullScreenChange(Ue()),Ue()&&a.addClass("full-screen")})),document.addEventListener("MSFullscreenChange",(function(){Ue()||(a.removeClass("full-screen"),Ve()),$&&$.fullScreenChange&&$.fullScreenChange(Ue()),Ue()&&a.addClass("full-screen")})),document.addEventListener("mozfullscreenchange",(function(){Ue()||(a.removeClass("full-screen"),Ve()),$&&$.fullScreenChange&&(r.width(),r.height(),$.fullScreenChange(Ue()),He(r.width(),r.height())),Ue()&&a.addClass("full-screen")})),document.addEventListener("webkitfullscreenchange",(function(e){Ue()||(a.removeClass("full-screen"),Ve()),$&&$.fullScreenChange&&($.fullScreenChange(Ue()),He(o.width(),o.height())),Ue()&&a.addClass("full-screen")}))),pe||b?ze():e.get(FlipSnackEmbed.urls.premiumLayouts,Be,"json").fail((function(){ze()}))}}(t),a}}(jQuery);